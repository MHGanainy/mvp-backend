{"timestamp":"2025-09-20T11:35:12.438Z","level":"INFO","service":"BillingService","message":"BillingService initialized","environment":"development","database_url":"configured"}
{"timestamp":"2025-01-15T12:00:00Z","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_conv_test_20250115_min1_1758368137430","correlation_token":"sim_e1f090e566a9b318d0fc6419d125346e_1758367895922","conversation_id":"conv_test_20250115","minute":1,"metrics_total_requests":1}
{"timestamp":"2025-09-20T11:35:37.431Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_conv_test_20250115_min1_1758368137430","correlation_token":"sim_e1f090e566a9b318d0fc6419d125346e_1758367895922"}
{"timestamp":"2025-09-20T11:35:39.433Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_conv_test_20250115_min1_1758368137430","minute_requested":1,"minutes_already_billed":0,"attempt_id":"c426245e-d4cc-40df-85b0-34914453635e"}
{"timestamp":"2025-09-20T11:35:39.433Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_conv_test_20250115_min1_1758368137430","attempt_id":"c426245e-d4cc-40df-85b0-34914453635e","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":9,"minutes_already_billed":0,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-20T11:35:39.434Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_conv_test_20250115_min1_1758368137430","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":9,"expected_balance_after":8,"minute_to_bill":1}
{"timestamp":"2025-09-20T11:35:39.438Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_conv_test_20250115_min1_1758368137430","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-20T11:35:39.443Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_conv_test_20250115_min1_1758368137430","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":9,"new_balance":8,"change":-1}
{"timestamp":"2025-09-20T11:35:39.443Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_conv_test_20250115_min1_1758368137430","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":8,"minute":1}
{"timestamp":"2025-09-20T11:35:39.448Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_conv_test_20250115_min1_1758368137430","transaction_id":"962bd3fe-6dca-4240-bf17-0270d1f207ed","transaction_type":"DEBIT","balance_after":8}
{"timestamp":"2025-09-20T11:35:39.448Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_conv_test_20250115_min1_1758368137430","attempt_id":"c426245e-d4cc-40df-85b0-34914453635e","new_minutes_billed":1,"new_duration_seconds":60}
{"timestamp":"2025-09-20T11:35:39.452Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_conv_test_20250115_min1_1758368137430","attempt_id":"c426245e-d4cc-40df-85b0-34914453635e","minutes_billed":1}
{"timestamp":"2025-09-20T11:35:39.453Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_conv_test_20250115_min1_1758368137430","transaction_duration_ms":19,"new_balance":8,"minute_billed":1,"total_minutes_billed_this_attempt":1,"total_successful":1,"total_minutes_billed_all_time":1,"avg_transaction_time":"19.00"}
{"timestamp":"2025-09-20T11:35:39.454Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_conv_test_20250115_min1_1758368137430","total_duration_ms":2024,"transaction_duration_ms":19,"response":{"status":"continue","creditsRemaining":8,"minuteBilled":1,"totalMinutesBilled":1,"attemptId":"c426245e-d4cc-40df-85b0-34914453635e","shouldTerminate":false}}
{"timestamp":"2025-01-15T12:00:00Z","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_conv_test_20250115_min1_1758368155024","correlation_token":"sim_e1f090e566a9b318d0fc6419d125346e_1758367895922","conversation_id":"conv_test_20250115","minute":1,"metrics_total_requests":2}
{"timestamp":"2025-09-20T11:35:55.024Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_conv_test_20250115_min1_1758368155024","correlation_token":"sim_e1f090e566a9b318d0fc6419d125346e_1758367895922"}
{"timestamp":"2025-09-20T11:35:55.042Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_conv_test_20250115_min1_1758368155024","minute_requested":1,"minutes_already_billed":1,"attempt_id":"c426245e-d4cc-40df-85b0-34914453635e"}
{"timestamp":"2025-09-20T11:35:55.042Z","level":"WARN","service":"BillingService","message":"Minute already billed - returning idempotent response","requestId":"bill_conv_test_20250115_min1_1758368155024","minute_requested":1,"minutes_already_billed":1,"attempt_id":"c426245e-d4cc-40df-85b0-34914453635e","total_duplicates":1}
{"timestamp":"2025-09-20T11:35:55.042Z","level":"INFO","service":"BillingService","message":"Returning idempotent response","requestId":"bill_conv_test_20250115_min1_1758368155024","response":{"status":"continue","creditsRemaining":8,"minuteBilled":1,"totalMinutesBilled":1,"attemptId":"c426245e-d4cc-40df-85b0-34914453635e","shouldTerminate":false,"message":"Already billed (idempotent response)"},"duration_ms":18}
{"timestamp":"2025-01-15T12:01:00Z","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_conv_test_20250115_min2_1758368189675","correlation_token":"sim_e1f090e566a9b318d0fc6419d125346e_1758367895922","conversation_id":"conv_test_20250115","minute":2,"metrics_total_requests":3}
{"timestamp":"2025-09-20T11:36:29.676Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_conv_test_20250115_min2_1758368189675","correlation_token":"sim_e1f090e566a9b318d0fc6419d125346e_1758367895922"}
{"timestamp":"2025-09-20T11:36:29.690Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_conv_test_20250115_min2_1758368189675","minute_requested":2,"minutes_already_billed":1,"attempt_id":"c426245e-d4cc-40df-85b0-34914453635e"}
{"timestamp":"2025-09-20T11:36:29.690Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_conv_test_20250115_min2_1758368189675","attempt_id":"c426245e-d4cc-40df-85b0-34914453635e","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":8,"minutes_already_billed":1,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-20T11:36:29.690Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_conv_test_20250115_min2_1758368189675","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":8,"expected_balance_after":7,"minute_to_bill":2}
{"timestamp":"2025-09-20T11:36:29.695Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_conv_test_20250115_min2_1758368189675","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-20T11:36:29.697Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_conv_test_20250115_min2_1758368189675","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":8,"new_balance":7,"change":-1}
{"timestamp":"2025-09-20T11:36:29.698Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_conv_test_20250115_min2_1758368189675","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":7,"minute":2}
{"timestamp":"2025-09-20T11:36:29.700Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_conv_test_20250115_min2_1758368189675","transaction_id":"b193bf2d-4f20-416c-8eeb-a3b9511bab71","transaction_type":"DEBIT","balance_after":7}
{"timestamp":"2025-09-20T11:36:29.700Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_conv_test_20250115_min2_1758368189675","attempt_id":"c426245e-d4cc-40df-85b0-34914453635e","new_minutes_billed":2,"new_duration_seconds":120}
{"timestamp":"2025-09-20T11:36:29.703Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_conv_test_20250115_min2_1758368189675","attempt_id":"c426245e-d4cc-40df-85b0-34914453635e","minutes_billed":2}
{"timestamp":"2025-09-20T11:36:29.705Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_conv_test_20250115_min2_1758368189675","transaction_duration_ms":15,"new_balance":7,"minute_billed":2,"total_minutes_billed_this_attempt":2,"total_successful":2,"total_minutes_billed_all_time":2,"avg_transaction_time":"17.00"}
{"timestamp":"2025-09-20T11:36:29.705Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_conv_test_20250115_min2_1758368189675","total_duration_ms":30,"transaction_duration_ms":15,"response":{"status":"continue","creditsRemaining":7,"minuteBilled":2,"totalMinutesBilled":2,"attemptId":"c426245e-d4cc-40df-85b0-34914453635e","shouldTerminate":false}}
{"timestamp":"2025-01-15T12:01:00Z","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_conv_test_20250115_min2_1758368194433","correlation_token":"sim_e1f090e566a9b318d0fc6419d125346e_1758367895922","conversation_id":"conv_test_20250115","minute":2,"metrics_total_requests":4}
{"timestamp":"2025-09-20T11:36:34.433Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_conv_test_20250115_min2_1758368194433","correlation_token":"sim_e1f090e566a9b318d0fc6419d125346e_1758367895922"}
{"timestamp":"2025-09-20T11:36:34.442Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_conv_test_20250115_min2_1758368194433","minute_requested":2,"minutes_already_billed":2,"attempt_id":"c426245e-d4cc-40df-85b0-34914453635e"}
{"timestamp":"2025-09-20T11:36:34.442Z","level":"WARN","service":"BillingService","message":"Minute already billed - returning idempotent response","requestId":"bill_conv_test_20250115_min2_1758368194433","minute_requested":2,"minutes_already_billed":2,"attempt_id":"c426245e-d4cc-40df-85b0-34914453635e","total_duplicates":2}
{"timestamp":"2025-09-20T11:36:34.442Z","level":"INFO","service":"BillingService","message":"Returning idempotent response","requestId":"bill_conv_test_20250115_min2_1758368194433","response":{"status":"continue","creditsRemaining":7,"minuteBilled":2,"totalMinutesBilled":2,"attemptId":"c426245e-d4cc-40df-85b0-34914453635e","shouldTerminate":false,"message":"Already billed (idempotent response)"},"duration_ms":9}
{"timestamp":"2025-09-20T11:56:03.935Z","level":"INFO","service":"BillingService","message":"BillingService initialized","environment":"development","database_url":"configured"}
{"timestamp":"2025-09-20T11:56:04.599715","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_895797ed-33a5-407e-baf4-abc36bfd1236_min7_1758369364607","correlation_token":"transcript-1758368943088-kinj7cr70","conversation_id":"895797ed-33a5-407e-baf4-abc36bfd1236","minute":7,"metrics_total_requests":1}
{"timestamp":"2025-09-20T11:56:04.608Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_895797ed-33a5-407e-baf4-abc36bfd1236_min7_1758369364607","correlation_token":"transcript-1758368943088-kinj7cr70"}
{"timestamp":"2025-09-20T11:56:04.639Z","level":"ERROR","service":"BillingService","message":"Invalid correlation token - no attempt found","requestId":"bill_895797ed-33a5-407e-baf4-abc36bfd1236_min7_1758369364607","correlation_token":"transcript-1758368943088-kinj7cr70","conversation_id":"895797ed-33a5-407e-baf4-abc36bfd1236"}
{"timestamp":"2025-09-20T11:56:04.642630","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_895797ed-33a5-407e-baf4-abc36bfd1236_min8_1758369364644","correlation_token":"transcript-1758368943088-kinj7cr70","conversation_id":"895797ed-33a5-407e-baf4-abc36bfd1236","minute":8,"metrics_total_requests":2}
{"timestamp":"2025-09-20T11:56:04.644Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_895797ed-33a5-407e-baf4-abc36bfd1236_min8_1758369364644","correlation_token":"transcript-1758368943088-kinj7cr70"}
{"timestamp":"2025-09-20T11:56:04.651Z","level":"ERROR","service":"BillingService","message":"Invalid correlation token - no attempt found","requestId":"bill_895797ed-33a5-407e-baf4-abc36bfd1236_min8_1758369364644","correlation_token":"transcript-1758368943088-kinj7cr70","conversation_id":"895797ed-33a5-407e-baf4-abc36bfd1236"}
{"timestamp":"2025-09-20T11:57:31.765164","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_53a8d897-a171-4ebc-9821-89086d939d0a_min1_1758369451773","correlation_token":"transcript-1758369389402-ypypj5ahv","conversation_id":"53a8d897-a171-4ebc-9821-89086d939d0a","minute":1,"metrics_total_requests":3}
{"timestamp":"2025-09-20T11:57:31.773Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_53a8d897-a171-4ebc-9821-89086d939d0a_min1_1758369451773","correlation_token":"transcript-1758369389402-ypypj5ahv"}
{"timestamp":"2025-09-20T11:57:31.781Z","level":"ERROR","service":"BillingService","message":"Invalid correlation token - no attempt found","requestId":"bill_53a8d897-a171-4ebc-9821-89086d939d0a_min1_1758369451773","correlation_token":"transcript-1758369389402-ypypj5ahv","conversation_id":"53a8d897-a171-4ebc-9821-89086d939d0a"}
{"timestamp":"2025-09-20T11:57:31.782775","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_53a8d897-a171-4ebc-9821-89086d939d0a_min2_1758369451784","correlation_token":"transcript-1758369389402-ypypj5ahv","conversation_id":"53a8d897-a171-4ebc-9821-89086d939d0a","minute":2,"metrics_total_requests":4}
{"timestamp":"2025-09-20T11:57:31.784Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_53a8d897-a171-4ebc-9821-89086d939d0a_min2_1758369451784","correlation_token":"transcript-1758369389402-ypypj5ahv"}
{"timestamp":"2025-09-20T11:57:31.788Z","level":"ERROR","service":"BillingService","message":"Invalid correlation token - no attempt found","requestId":"bill_53a8d897-a171-4ebc-9821-89086d939d0a_min2_1758369451784","correlation_token":"transcript-1758369389402-ypypj5ahv","conversation_id":"53a8d897-a171-4ebc-9821-89086d939d0a"}
{"timestamp":"2025-09-20T11:58:18.613379","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_8b1e4e06-ee6a-49c3-9fab-f84203a51d0f_min1_1758369498615","correlation_token":"transcript-1758369437392-791iwmalz","conversation_id":"8b1e4e06-ee6a-49c3-9fab-f84203a51d0f","minute":1,"metrics_total_requests":5}
{"timestamp":"2025-09-20T11:58:18.615Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_8b1e4e06-ee6a-49c3-9fab-f84203a51d0f_min1_1758369498615","correlation_token":"transcript-1758369437392-791iwmalz"}
{"timestamp":"2025-09-20T11:58:18.624Z","level":"ERROR","service":"BillingService","message":"Invalid correlation token - no attempt found","requestId":"bill_8b1e4e06-ee6a-49c3-9fab-f84203a51d0f_min1_1758369498615","correlation_token":"transcript-1758369437392-791iwmalz","conversation_id":"8b1e4e06-ee6a-49c3-9fab-f84203a51d0f"}
{"timestamp":"2025-09-20T11:58:18.625739","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_8b1e4e06-ee6a-49c3-9fab-f84203a51d0f_min2_1758369498628","correlation_token":"transcript-1758369437392-791iwmalz","conversation_id":"8b1e4e06-ee6a-49c3-9fab-f84203a51d0f","minute":2,"metrics_total_requests":6}
{"timestamp":"2025-09-20T11:58:18.628Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_8b1e4e06-ee6a-49c3-9fab-f84203a51d0f_min2_1758369498628","correlation_token":"transcript-1758369437392-791iwmalz"}
{"timestamp":"2025-09-20T11:58:18.632Z","level":"ERROR","service":"BillingService","message":"Invalid correlation token - no attempt found","requestId":"bill_8b1e4e06-ee6a-49c3-9fab-f84203a51d0f_min2_1758369498628","correlation_token":"transcript-1758369437392-791iwmalz","conversation_id":"8b1e4e06-ee6a-49c3-9fab-f84203a51d0f"}
{"timestamp":"2025-09-20T12:01:30.625262","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_6c24bc16-f8ff-46b0-b0a8-d4f2a6740d79_min1_1758369690629","correlation_token":"transcript-1758369628826-y132dq1k9","conversation_id":"6c24bc16-f8ff-46b0-b0a8-d4f2a6740d79","minute":1,"metrics_total_requests":7}
{"timestamp":"2025-09-20T12:01:30.629Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_6c24bc16-f8ff-46b0-b0a8-d4f2a6740d79_min1_1758369690629","correlation_token":"transcript-1758369628826-y132dq1k9"}
{"timestamp":"2025-09-20T12:01:30.635Z","level":"ERROR","service":"BillingService","message":"Invalid correlation token - no attempt found","requestId":"bill_6c24bc16-f8ff-46b0-b0a8-d4f2a6740d79_min1_1758369690629","correlation_token":"transcript-1758369628826-y132dq1k9","conversation_id":"6c24bc16-f8ff-46b0-b0a8-d4f2a6740d79"}
{"timestamp":"2025-09-20T12:01:30.637177","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_6c24bc16-f8ff-46b0-b0a8-d4f2a6740d79_min2_1758369690638","correlation_token":"transcript-1758369628826-y132dq1k9","conversation_id":"6c24bc16-f8ff-46b0-b0a8-d4f2a6740d79","minute":2,"metrics_total_requests":8}
{"timestamp":"2025-09-20T12:01:30.638Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_6c24bc16-f8ff-46b0-b0a8-d4f2a6740d79_min2_1758369690638","correlation_token":"transcript-1758369628826-y132dq1k9"}
{"timestamp":"2025-09-20T12:01:30.642Z","level":"ERROR","service":"BillingService","message":"Invalid correlation token - no attempt found","requestId":"bill_6c24bc16-f8ff-46b0-b0a8-d4f2a6740d79_min2_1758369690638","correlation_token":"transcript-1758369628826-y132dq1k9","conversation_id":"6c24bc16-f8ff-46b0-b0a8-d4f2a6740d79"}
{"timestamp":"2025-09-20T12:01:47.481032","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_32a77db9-134e-43bf-bd17-dc15298b5e71_min1_1758369707492","correlation_token":"transcript-1758369644655-pij2v79bw","conversation_id":"32a77db9-134e-43bf-bd17-dc15298b5e71","minute":1,"metrics_total_requests":9}
{"timestamp":"2025-09-20T12:01:47.492Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_32a77db9-134e-43bf-bd17-dc15298b5e71_min1_1758369707492","correlation_token":"transcript-1758369644655-pij2v79bw"}
{"timestamp":"2025-09-20T12:01:47.512Z","level":"ERROR","service":"BillingService","message":"Invalid correlation token - no attempt found","requestId":"bill_32a77db9-134e-43bf-bd17-dc15298b5e71_min1_1758369707492","correlation_token":"transcript-1758369644655-pij2v79bw","conversation_id":"32a77db9-134e-43bf-bd17-dc15298b5e71"}
{"timestamp":"2025-09-20T12:01:47.514792","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_32a77db9-134e-43bf-bd17-dc15298b5e71_min2_1758369707516","correlation_token":"transcript-1758369644655-pij2v79bw","conversation_id":"32a77db9-134e-43bf-bd17-dc15298b5e71","minute":2,"metrics_total_requests":10}
{"timestamp":"2025-09-20T12:01:47.516Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_32a77db9-134e-43bf-bd17-dc15298b5e71_min2_1758369707516","correlation_token":"transcript-1758369644655-pij2v79bw"}
{"timestamp":"2025-09-20T12:01:47.521Z","level":"ERROR","service":"BillingService","message":"Invalid correlation token - no attempt found","requestId":"bill_32a77db9-134e-43bf-bd17-dc15298b5e71_min2_1758369707516","correlation_token":"transcript-1758369644655-pij2v79bw","conversation_id":"32a77db9-134e-43bf-bd17-dc15298b5e71"}
{"timestamp":"2025-09-20T12:05:12.359001","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min1_1758369912369","correlation_token":"sim_9f45b0f5d4509403eb6ac3ca0713584c_1758369613612","conversation_id":"75432d49-dd97-4171-a099-1fa5e0f6c1d2","minute":1,"metrics_total_requests":11}
{"timestamp":"2025-09-20T12:05:12.370Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min1_1758369912369","correlation_token":"sim_9f45b0f5d4509403eb6ac3ca0713584c_1758369613612"}
{"timestamp":"2025-09-20T12:05:12.398Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min1_1758369912369","minute_requested":1,"minutes_already_billed":0,"attempt_id":"6d431a57-6e41-45f1-8a0d-a65eddb78aea"}
{"timestamp":"2025-09-20T12:05:12.398Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min1_1758369912369","attempt_id":"6d431a57-6e41-45f1-8a0d-a65eddb78aea","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":7,"minutes_already_billed":0,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-20T12:05:12.399Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min1_1758369912369","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":7,"expected_balance_after":6,"minute_to_bill":1}
{"timestamp":"2025-09-20T12:05:12.407Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min1_1758369912369","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-20T12:05:12.411Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min1_1758369912369","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":7,"new_balance":6,"change":-1}
{"timestamp":"2025-09-20T12:05:12.411Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min1_1758369912369","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":6,"minute":1}
{"timestamp":"2025-09-20T12:05:12.415Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min1_1758369912369","transaction_id":"8203dc7e-2c7d-46c5-a386-ed7bf1765568","transaction_type":"DEBIT","balance_after":6}
{"timestamp":"2025-09-20T12:05:12.415Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min1_1758369912369","attempt_id":"6d431a57-6e41-45f1-8a0d-a65eddb78aea","new_minutes_billed":1,"new_duration_seconds":60}
{"timestamp":"2025-09-20T12:05:12.418Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min1_1758369912369","attempt_id":"6d431a57-6e41-45f1-8a0d-a65eddb78aea","minutes_billed":1}
{"timestamp":"2025-09-20T12:05:12.421Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min1_1758369912369","transaction_duration_ms":22,"new_balance":6,"minute_billed":1,"total_minutes_billed_this_attempt":1,"total_successful":1,"total_minutes_billed_all_time":1,"avg_transaction_time":"22.00"}
{"timestamp":"2025-09-20T12:05:12.421Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min1_1758369912369","total_duration_ms":52,"transaction_duration_ms":22,"response":{"status":"continue","creditsRemaining":6,"minuteBilled":1,"totalMinutesBilled":1,"attemptId":"6d431a57-6e41-45f1-8a0d-a65eddb78aea","shouldTerminate":false}}
{"timestamp":"2025-09-20T12:06:12.424825","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min2_1758369972432","correlation_token":"sim_9f45b0f5d4509403eb6ac3ca0713584c_1758369613612","conversation_id":"75432d49-dd97-4171-a099-1fa5e0f6c1d2","minute":2,"metrics_total_requests":12}
{"timestamp":"2025-09-20T12:06:12.433Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min2_1758369972432","correlation_token":"sim_9f45b0f5d4509403eb6ac3ca0713584c_1758369613612"}
{"timestamp":"2025-09-20T12:06:12.446Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min2_1758369972432","minute_requested":2,"minutes_already_billed":1,"attempt_id":"6d431a57-6e41-45f1-8a0d-a65eddb78aea"}
{"timestamp":"2025-09-20T12:06:12.446Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min2_1758369972432","attempt_id":"6d431a57-6e41-45f1-8a0d-a65eddb78aea","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":6,"minutes_already_billed":1,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-20T12:06:12.446Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min2_1758369972432","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":6,"expected_balance_after":5,"minute_to_bill":2}
{"timestamp":"2025-09-20T12:06:12.450Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min2_1758369972432","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-20T12:06:12.453Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min2_1758369972432","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":6,"new_balance":5,"change":-1}
{"timestamp":"2025-09-20T12:06:12.453Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min2_1758369972432","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":5,"minute":2}
{"timestamp":"2025-09-20T12:06:12.456Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min2_1758369972432","transaction_id":"118fc69d-f19c-4d10-a2d4-2073878e89bb","transaction_type":"DEBIT","balance_after":5}
{"timestamp":"2025-09-20T12:06:12.456Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min2_1758369972432","attempt_id":"6d431a57-6e41-45f1-8a0d-a65eddb78aea","new_minutes_billed":2,"new_duration_seconds":120}
{"timestamp":"2025-09-20T12:06:12.459Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min2_1758369972432","attempt_id":"6d431a57-6e41-45f1-8a0d-a65eddb78aea","minutes_billed":2}
{"timestamp":"2025-09-20T12:06:12.461Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min2_1758369972432","transaction_duration_ms":15,"new_balance":5,"minute_billed":2,"total_minutes_billed_this_attempt":2,"total_successful":2,"total_minutes_billed_all_time":2,"avg_transaction_time":"18.50"}
{"timestamp":"2025-09-20T12:06:12.461Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min2_1758369972432","total_duration_ms":29,"transaction_duration_ms":15,"response":{"status":"continue","creditsRemaining":5,"minuteBilled":2,"totalMinutesBilled":2,"attemptId":"6d431a57-6e41-45f1-8a0d-a65eddb78aea","shouldTerminate":false}}
{"timestamp":"2025-09-20T12:07:12.463217","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min3_1758370032466","correlation_token":"sim_9f45b0f5d4509403eb6ac3ca0713584c_1758369613612","conversation_id":"75432d49-dd97-4171-a099-1fa5e0f6c1d2","minute":3,"metrics_total_requests":13}
{"timestamp":"2025-09-20T12:07:12.466Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min3_1758370032466","correlation_token":"sim_9f45b0f5d4509403eb6ac3ca0713584c_1758369613612"}
{"timestamp":"2025-09-20T12:07:12.475Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min3_1758370032466","minute_requested":3,"minutes_already_billed":2,"attempt_id":"6d431a57-6e41-45f1-8a0d-a65eddb78aea"}
{"timestamp":"2025-09-20T12:07:12.475Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min3_1758370032466","attempt_id":"6d431a57-6e41-45f1-8a0d-a65eddb78aea","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":5,"minutes_already_billed":2,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-20T12:07:12.475Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min3_1758370032466","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":5,"expected_balance_after":4,"minute_to_bill":3}
{"timestamp":"2025-09-20T12:07:12.478Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min3_1758370032466","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-20T12:07:12.480Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min3_1758370032466","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":5,"new_balance":4,"change":-1}
{"timestamp":"2025-09-20T12:07:12.480Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min3_1758370032466","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":4,"minute":3}
{"timestamp":"2025-09-20T12:07:12.483Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min3_1758370032466","transaction_id":"52038916-4fe2-49a5-8570-e76ca206b819","transaction_type":"DEBIT","balance_after":4}
{"timestamp":"2025-09-20T12:07:12.483Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min3_1758370032466","attempt_id":"6d431a57-6e41-45f1-8a0d-a65eddb78aea","new_minutes_billed":3,"new_duration_seconds":180}
{"timestamp":"2025-09-20T12:07:12.485Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min3_1758370032466","attempt_id":"6d431a57-6e41-45f1-8a0d-a65eddb78aea","minutes_billed":3}
{"timestamp":"2025-09-20T12:07:12.486Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min3_1758370032466","transaction_duration_ms":11,"new_balance":4,"minute_billed":3,"total_minutes_billed_this_attempt":3,"total_successful":3,"total_minutes_billed_all_time":3,"avg_transaction_time":"16.00"}
{"timestamp":"2025-09-20T12:07:12.486Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min3_1758370032466","total_duration_ms":20,"transaction_duration_ms":11,"response":{"status":"continue","creditsRemaining":4,"minuteBilled":3,"totalMinutesBilled":3,"attemptId":"6d431a57-6e41-45f1-8a0d-a65eddb78aea","shouldTerminate":false}}
{"timestamp":"2025-09-20T12:19:00.412618","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min4_1758370740453","correlation_token":"sim_9f45b0f5d4509403eb6ac3ca0713584c_1758369613612","conversation_id":"75432d49-dd97-4171-a099-1fa5e0f6c1d2","minute":4,"metrics_total_requests":14}
{"timestamp":"2025-09-20T12:19:00.453Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min4_1758370740453","correlation_token":"sim_9f45b0f5d4509403eb6ac3ca0713584c_1758369613612"}
{"timestamp":"2025-09-20T12:19:00.471Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min4_1758370740453","minute_requested":4,"minutes_already_billed":3,"attempt_id":"6d431a57-6e41-45f1-8a0d-a65eddb78aea"}
{"timestamp":"2025-09-20T12:19:00.471Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min4_1758370740453","attempt_id":"6d431a57-6e41-45f1-8a0d-a65eddb78aea","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":4,"minutes_already_billed":3,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-20T12:19:00.471Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min4_1758370740453","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":4,"expected_balance_after":3,"minute_to_bill":4}
{"timestamp":"2025-09-20T12:19:00.476Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min4_1758370740453","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-20T12:19:00.480Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min4_1758370740453","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":4,"new_balance":3,"change":-1}
{"timestamp":"2025-09-20T12:19:00.480Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min4_1758370740453","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":3,"minute":4}
{"timestamp":"2025-09-20T12:19:00.483Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min4_1758370740453","transaction_id":"405e9eb2-a3b3-484a-8544-4285911b84a0","transaction_type":"DEBIT","balance_after":3}
{"timestamp":"2025-09-20T12:19:00.483Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min4_1758370740453","attempt_id":"6d431a57-6e41-45f1-8a0d-a65eddb78aea","new_minutes_billed":4,"new_duration_seconds":240}
{"timestamp":"2025-09-20T12:19:00.485Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min4_1758370740453","attempt_id":"6d431a57-6e41-45f1-8a0d-a65eddb78aea","minutes_billed":4}
{"timestamp":"2025-09-20T12:19:00.550Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min4_1758370740453","transaction_duration_ms":79,"new_balance":3,"minute_billed":4,"total_minutes_billed_this_attempt":4,"total_successful":4,"total_minutes_billed_all_time":4,"avg_transaction_time":"31.75"}
{"timestamp":"2025-09-20T12:19:00.550Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min4_1758370740453","total_duration_ms":97,"transaction_duration_ms":79,"response":{"status":"continue","creditsRemaining":3,"minuteBilled":4,"totalMinutesBilled":4,"attemptId":"6d431a57-6e41-45f1-8a0d-a65eddb78aea","shouldTerminate":false}}
{"timestamp":"2025-09-20T12:19:05.840826","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min15_1758370745843","correlation_token":"sim_9f45b0f5d4509403eb6ac3ca0713584c_1758369613612","conversation_id":"75432d49-dd97-4171-a099-1fa5e0f6c1d2","minute":15,"metrics_total_requests":15}
{"timestamp":"2025-09-20T12:19:05.843Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min15_1758370745843","correlation_token":"sim_9f45b0f5d4509403eb6ac3ca0713584c_1758369613612"}
{"timestamp":"2025-09-20T12:19:05.853Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min15_1758370745843","minute_requested":15,"minutes_already_billed":4,"attempt_id":"6d431a57-6e41-45f1-8a0d-a65eddb78aea"}
{"timestamp":"2025-09-20T12:19:05.853Z","level":"WARN","service":"BillingService","message":"Non-sequential minute billing detected","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min15_1758370745843","minute_requested":15,"expected_minute":5,"gap":10,"attempt_id":"6d431a57-6e41-45f1-8a0d-a65eddb78aea"}
{"timestamp":"2025-09-20T12:19:05.853Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min15_1758370745843","attempt_id":"6d431a57-6e41-45f1-8a0d-a65eddb78aea","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":3,"minutes_already_billed":4,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-20T12:19:05.853Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min15_1758370745843","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":3,"expected_balance_after":2,"minute_to_bill":15}
{"timestamp":"2025-09-20T12:19:05.856Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min15_1758370745843","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-20T12:19:05.858Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min15_1758370745843","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":3,"new_balance":2,"change":-1}
{"timestamp":"2025-09-20T12:19:05.858Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min15_1758370745843","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":2,"minute":15}
{"timestamp":"2025-09-20T12:19:05.862Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min15_1758370745843","transaction_id":"f0d3c6c9-ee40-41df-be1a-787360a84641","transaction_type":"DEBIT","balance_after":2}
{"timestamp":"2025-09-20T12:19:05.862Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min15_1758370745843","attempt_id":"6d431a57-6e41-45f1-8a0d-a65eddb78aea","new_minutes_billed":15,"new_duration_seconds":900}
{"timestamp":"2025-09-20T12:19:05.865Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min15_1758370745843","attempt_id":"6d431a57-6e41-45f1-8a0d-a65eddb78aea","minutes_billed":15}
{"timestamp":"2025-09-20T12:19:05.866Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min15_1758370745843","transaction_duration_ms":13,"new_balance":2,"minute_billed":15,"total_minutes_billed_this_attempt":15,"total_successful":5,"total_minutes_billed_all_time":5,"avg_transaction_time":"28.00"}
{"timestamp":"2025-09-20T12:19:05.867Z","level":"WARN","service":"BillingService","message":"Low credits warning threshold reached","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min15_1758370745843","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","credits_remaining":2,"minute_billed":15,"warning_threshold":2}
{"timestamp":"2025-09-20T12:19:05.867Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min15_1758370745843","total_duration_ms":24,"transaction_duration_ms":13,"response":{"status":"warning","creditsRemaining":2,"minuteBilled":15,"totalMinutesBilled":15,"attemptId":"6d431a57-6e41-45f1-8a0d-a65eddb78aea","shouldTerminate":false,"message":"Low credits warning: 2 minute(s) remaining"}}
{"timestamp":"2025-09-20T12:30:18.427874","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_852e4f52-2171-47ac-ab99-8cc0726ef3c4_min1_1758371418431","correlation_token":"sim_8a52901bfb30afe73bdfd30b7bc6c7f4_1758371324268","conversation_id":"852e4f52-2171-47ac-ab99-8cc0726ef3c4","minute":1,"metrics_total_requests":16}
{"timestamp":"2025-09-20T12:30:18.431Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_852e4f52-2171-47ac-ab99-8cc0726ef3c4_min1_1758371418431","correlation_token":"sim_8a52901bfb30afe73bdfd30b7bc6c7f4_1758371324268"}
{"timestamp":"2025-09-20T12:30:18.439Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_852e4f52-2171-47ac-ab99-8cc0726ef3c4_min1_1758371418431","minute_requested":1,"minutes_already_billed":0,"attempt_id":"aef115f7-eceb-44a3-831f-37806fbbbcc7"}
{"timestamp":"2025-09-20T12:30:18.439Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_852e4f52-2171-47ac-ab99-8cc0726ef3c4_min1_1758371418431","attempt_id":"aef115f7-eceb-44a3-831f-37806fbbbcc7","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":2,"minutes_already_billed":0,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-20T12:30:18.439Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_852e4f52-2171-47ac-ab99-8cc0726ef3c4_min1_1758371418431","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":2,"expected_balance_after":1,"minute_to_bill":1}
{"timestamp":"2025-09-20T12:30:18.442Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_852e4f52-2171-47ac-ab99-8cc0726ef3c4_min1_1758371418431","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-20T12:30:18.444Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_852e4f52-2171-47ac-ab99-8cc0726ef3c4_min1_1758371418431","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":2,"new_balance":1,"change":-1}
{"timestamp":"2025-09-20T12:30:18.444Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_852e4f52-2171-47ac-ab99-8cc0726ef3c4_min1_1758371418431","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":1,"minute":1}
{"timestamp":"2025-09-20T12:30:18.446Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_852e4f52-2171-47ac-ab99-8cc0726ef3c4_min1_1758371418431","transaction_id":"3415a346-1d21-478c-875a-a8ae2a12a524","transaction_type":"DEBIT","balance_after":1}
{"timestamp":"2025-09-20T12:30:18.446Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_852e4f52-2171-47ac-ab99-8cc0726ef3c4_min1_1758371418431","attempt_id":"aef115f7-eceb-44a3-831f-37806fbbbcc7","new_minutes_billed":1,"new_duration_seconds":60}
{"timestamp":"2025-09-20T12:30:18.448Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_852e4f52-2171-47ac-ab99-8cc0726ef3c4_min1_1758371418431","attempt_id":"aef115f7-eceb-44a3-831f-37806fbbbcc7","minutes_billed":1}
{"timestamp":"2025-09-20T12:30:18.450Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_852e4f52-2171-47ac-ab99-8cc0726ef3c4_min1_1758371418431","transaction_duration_ms":11,"new_balance":1,"minute_billed":1,"total_minutes_billed_this_attempt":1,"total_successful":6,"total_minutes_billed_all_time":6,"avg_transaction_time":"25.17"}
{"timestamp":"2025-09-20T12:30:18.450Z","level":"WARN","service":"BillingService","message":"Low credits warning threshold reached","requestId":"bill_852e4f52-2171-47ac-ab99-8cc0726ef3c4_min1_1758371418431","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","credits_remaining":1,"minute_billed":1,"warning_threshold":2}
{"timestamp":"2025-09-20T12:30:18.450Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_852e4f52-2171-47ac-ab99-8cc0726ef3c4_min1_1758371418431","total_duration_ms":19,"transaction_duration_ms":11,"response":{"status":"warning","creditsRemaining":1,"minuteBilled":1,"totalMinutesBilled":1,"attemptId":"aef115f7-eceb-44a3-831f-37806fbbbcc7","shouldTerminate":false,"message":"Low credits warning: 1 minute(s) remaining"}}
{"timestamp":"2025-09-20T12:31:18.454147","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_852e4f52-2171-47ac-ab99-8cc0726ef3c4_min2_1758371478460","correlation_token":"sim_8a52901bfb30afe73bdfd30b7bc6c7f4_1758371324268","conversation_id":"852e4f52-2171-47ac-ab99-8cc0726ef3c4","minute":2,"metrics_total_requests":17}
{"timestamp":"2025-09-20T12:31:18.461Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_852e4f52-2171-47ac-ab99-8cc0726ef3c4_min2_1758371478460","correlation_token":"sim_8a52901bfb30afe73bdfd30b7bc6c7f4_1758371324268"}
{"timestamp":"2025-09-20T12:31:18.473Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_852e4f52-2171-47ac-ab99-8cc0726ef3c4_min2_1758371478460","minute_requested":2,"minutes_already_billed":1,"attempt_id":"aef115f7-eceb-44a3-831f-37806fbbbcc7"}
{"timestamp":"2025-09-20T12:31:18.473Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_852e4f52-2171-47ac-ab99-8cc0726ef3c4_min2_1758371478460","attempt_id":"aef115f7-eceb-44a3-831f-37806fbbbcc7","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":1,"minutes_already_billed":1,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-20T12:31:18.473Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_852e4f52-2171-47ac-ab99-8cc0726ef3c4_min2_1758371478460","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":1,"expected_balance_after":0,"minute_to_bill":2}
{"timestamp":"2025-09-20T12:31:18.479Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_852e4f52-2171-47ac-ab99-8cc0726ef3c4_min2_1758371478460","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-20T12:31:18.481Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_852e4f52-2171-47ac-ab99-8cc0726ef3c4_min2_1758371478460","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":1,"new_balance":0,"change":-1}
{"timestamp":"2025-09-20T12:31:18.481Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_852e4f52-2171-47ac-ab99-8cc0726ef3c4_min2_1758371478460","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":0,"minute":2}
{"timestamp":"2025-09-20T12:31:18.484Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_852e4f52-2171-47ac-ab99-8cc0726ef3c4_min2_1758371478460","transaction_id":"22c3122f-7147-4795-95ba-98ecc2729b60","transaction_type":"DEBIT","balance_after":0}
{"timestamp":"2025-09-20T12:31:18.484Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_852e4f52-2171-47ac-ab99-8cc0726ef3c4_min2_1758371478460","attempt_id":"aef115f7-eceb-44a3-831f-37806fbbbcc7","new_minutes_billed":2,"new_duration_seconds":120}
{"timestamp":"2025-09-20T12:31:18.486Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_852e4f52-2171-47ac-ab99-8cc0726ef3c4_min2_1758371478460","attempt_id":"aef115f7-eceb-44a3-831f-37806fbbbcc7","minutes_billed":2}
{"timestamp":"2025-09-20T12:31:18.488Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_852e4f52-2171-47ac-ab99-8cc0726ef3c4_min2_1758371478460","transaction_duration_ms":15,"new_balance":0,"minute_billed":2,"total_minutes_billed_this_attempt":2,"total_successful":7,"total_minutes_billed_all_time":7,"avg_transaction_time":"23.71"}
{"timestamp":"2025-09-20T12:31:18.488Z","level":"WARN","service":"BillingService","message":"Last credit used - will terminate conversation","requestId":"bill_852e4f52-2171-47ac-ab99-8cc0726ef3c4_min2_1758371478460","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","minute_billed":2,"total_minutes_this_session":2}
{"timestamp":"2025-09-20T12:31:18.488Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_852e4f52-2171-47ac-ab99-8cc0726ef3c4_min2_1758371478460","total_duration_ms":28,"transaction_duration_ms":15,"response":{"status":"terminate","creditsRemaining":0,"minuteBilled":2,"totalMinutesBilled":2,"attemptId":"aef115f7-eceb-44a3-831f-37806fbbbcc7","shouldTerminate":true,"message":"Last credit used - conversation will end","gracePeriodSeconds":60}}
{"timestamp":"2025-09-20T12:32:18.498793","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_852e4f52-2171-47ac-ab99-8cc0726ef3c4_min4_1758371538506","correlation_token":"sim_8a52901bfb30afe73bdfd30b7bc6c7f4_1758371324268","conversation_id":"852e4f52-2171-47ac-ab99-8cc0726ef3c4","minute":4,"metrics_total_requests":18}
{"timestamp":"2025-09-20T12:32:18.506Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_852e4f52-2171-47ac-ab99-8cc0726ef3c4_min4_1758371538506","correlation_token":"sim_8a52901bfb30afe73bdfd30b7bc6c7f4_1758371324268"}
{"timestamp":"2025-09-20T12:32:18.519Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_852e4f52-2171-47ac-ab99-8cc0726ef3c4_min4_1758371538506","minute_requested":4,"minutes_already_billed":2,"attempt_id":"aef115f7-eceb-44a3-831f-37806fbbbcc7"}
{"timestamp":"2025-09-20T12:32:18.519Z","level":"WARN","service":"BillingService","message":"Non-sequential minute billing detected","requestId":"bill_852e4f52-2171-47ac-ab99-8cc0726ef3c4_min4_1758371538506","minute_requested":4,"expected_minute":3,"gap":1,"attempt_id":"aef115f7-eceb-44a3-831f-37806fbbbcc7"}
{"timestamp":"2025-09-20T12:32:18.519Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_852e4f52-2171-47ac-ab99-8cc0726ef3c4_min4_1758371538506","attempt_id":"aef115f7-eceb-44a3-831f-37806fbbbcc7","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":0,"minutes_already_billed":2,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-20T12:32:18.519Z","level":"WARN","service":"BillingService","message":"Insufficient credits detected","requestId":"bill_852e4f52-2171-47ac-ab99-8cc0726ef3c4_min4_1758371538506","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_email":"john.doe@example.com","current_balance":0,"required":1,"minutes_billed":2,"total_insufficient_events":1}
{"timestamp":"2025-09-20T13:01:54.701329","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min1_1758373314707","correlation_token":"sim_909c4aa76664333dbd33add873591bca_1758373233161","conversation_id":"2f51cb14-306b-498d-be37-efe1deef93e7","minute":1,"metrics_total_requests":19}
{"timestamp":"2025-09-20T13:01:54.707Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min1_1758373314707","correlation_token":"sim_909c4aa76664333dbd33add873591bca_1758373233161"}
{"timestamp":"2025-09-20T13:01:54.723Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min1_1758373314707","minute_requested":1,"minutes_already_billed":0,"attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994"}
{"timestamp":"2025-09-20T13:01:54.723Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min1_1758373314707","attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":10,"minutes_already_billed":0,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-20T13:01:54.723Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min1_1758373314707","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":10,"expected_balance_after":9,"minute_to_bill":1}
{"timestamp":"2025-09-20T13:01:54.727Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min1_1758373314707","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-20T13:01:54.730Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min1_1758373314707","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":10,"new_balance":9,"change":-1}
{"timestamp":"2025-09-20T13:01:54.730Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min1_1758373314707","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":9,"minute":1}
{"timestamp":"2025-09-20T13:01:54.733Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min1_1758373314707","transaction_id":"fe404b7d-ef34-437d-bcc3-ce5f8cff3875","transaction_type":"DEBIT","balance_after":9}
{"timestamp":"2025-09-20T13:01:54.733Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min1_1758373314707","attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994","new_minutes_billed":1,"new_duration_seconds":60}
{"timestamp":"2025-09-20T13:01:54.735Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min1_1758373314707","attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994","minutes_billed":1}
{"timestamp":"2025-09-20T13:01:54.738Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min1_1758373314707","transaction_duration_ms":15,"new_balance":9,"minute_billed":1,"total_minutes_billed_this_attempt":1,"total_successful":8,"total_minutes_billed_all_time":8,"avg_transaction_time":"22.63"}
{"timestamp":"2025-09-20T13:01:54.738Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min1_1758373314707","total_duration_ms":31,"transaction_duration_ms":15,"response":{"status":"continue","creditsRemaining":9,"minuteBilled":1,"totalMinutesBilled":1,"attemptId":"1598f8e1-be6c-475c-a76d-9412a5ce9994","shouldTerminate":false}}
{"timestamp":"2025-09-20T13:02:54.747275","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min2_1758373374754","correlation_token":"sim_909c4aa76664333dbd33add873591bca_1758373233161","conversation_id":"2f51cb14-306b-498d-be37-efe1deef93e7","minute":2,"metrics_total_requests":20}
{"timestamp":"2025-09-20T13:02:54.754Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min2_1758373374754","correlation_token":"sim_909c4aa76664333dbd33add873591bca_1758373233161"}
{"timestamp":"2025-09-20T13:02:54.766Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min2_1758373374754","minute_requested":2,"minutes_already_billed":1,"attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994"}
{"timestamp":"2025-09-20T13:02:54.766Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min2_1758373374754","attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":9,"minutes_already_billed":1,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-20T13:02:54.766Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min2_1758373374754","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":9,"expected_balance_after":8,"minute_to_bill":2}
{"timestamp":"2025-09-20T13:02:54.772Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min2_1758373374754","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-20T13:02:54.775Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min2_1758373374754","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":9,"new_balance":8,"change":-1}
{"timestamp":"2025-09-20T13:02:54.775Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min2_1758373374754","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":8,"minute":2}
{"timestamp":"2025-09-20T13:02:54.778Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min2_1758373374754","transaction_id":"5d422cf6-ae98-4e9d-82ec-85bdb828f3ab","transaction_type":"DEBIT","balance_after":8}
{"timestamp":"2025-09-20T13:02:54.778Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min2_1758373374754","attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994","new_minutes_billed":2,"new_duration_seconds":120}
{"timestamp":"2025-09-20T13:02:54.780Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min2_1758373374754","attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994","minutes_billed":2}
{"timestamp":"2025-09-20T13:02:54.781Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min2_1758373374754","transaction_duration_ms":15,"new_balance":8,"minute_billed":2,"total_minutes_billed_this_attempt":2,"total_successful":9,"total_minutes_billed_all_time":9,"avg_transaction_time":"21.78"}
{"timestamp":"2025-09-20T13:02:54.781Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min2_1758373374754","total_duration_ms":27,"transaction_duration_ms":15,"response":{"status":"continue","creditsRemaining":8,"minuteBilled":2,"totalMinutesBilled":2,"attemptId":"1598f8e1-be6c-475c-a76d-9412a5ce9994","shouldTerminate":false}}
{"timestamp":"2025-09-20T13:03:54.794419","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min3_1758373434799","correlation_token":"sim_909c4aa76664333dbd33add873591bca_1758373233161","conversation_id":"2f51cb14-306b-498d-be37-efe1deef93e7","minute":3,"metrics_total_requests":21}
{"timestamp":"2025-09-20T13:03:54.799Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min3_1758373434799","correlation_token":"sim_909c4aa76664333dbd33add873591bca_1758373233161"}
{"timestamp":"2025-09-20T13:03:54.813Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min3_1758373434799","minute_requested":3,"minutes_already_billed":2,"attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994"}
{"timestamp":"2025-09-20T13:03:54.813Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min3_1758373434799","attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":8,"minutes_already_billed":2,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-20T13:03:54.813Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min3_1758373434799","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":8,"expected_balance_after":7,"minute_to_bill":3}
{"timestamp":"2025-09-20T13:03:54.818Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min3_1758373434799","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-20T13:03:54.820Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min3_1758373434799","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":8,"new_balance":7,"change":-1}
{"timestamp":"2025-09-20T13:03:54.820Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min3_1758373434799","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":7,"minute":3}
{"timestamp":"2025-09-20T13:03:54.823Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min3_1758373434799","transaction_id":"1d88d792-7414-4208-8daa-39c4e8987d46","transaction_type":"DEBIT","balance_after":7}
{"timestamp":"2025-09-20T13:03:54.823Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min3_1758373434799","attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994","new_minutes_billed":3,"new_duration_seconds":180}
{"timestamp":"2025-09-20T13:03:54.825Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min3_1758373434799","attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994","minutes_billed":3}
{"timestamp":"2025-09-20T13:03:54.827Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min3_1758373434799","transaction_duration_ms":14,"new_balance":7,"minute_billed":3,"total_minutes_billed_this_attempt":3,"total_successful":10,"total_minutes_billed_all_time":10,"avg_transaction_time":"21.00"}
{"timestamp":"2025-09-20T13:03:54.827Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min3_1758373434799","total_duration_ms":28,"transaction_duration_ms":14,"response":{"status":"continue","creditsRemaining":7,"minuteBilled":3,"totalMinutesBilled":3,"attemptId":"1598f8e1-be6c-475c-a76d-9412a5ce9994","shouldTerminate":false}}
{"timestamp":"2025-09-20T13:04:54.832422","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min4_1758373494838","correlation_token":"sim_909c4aa76664333dbd33add873591bca_1758373233161","conversation_id":"2f51cb14-306b-498d-be37-efe1deef93e7","minute":4,"metrics_total_requests":22}
{"timestamp":"2025-09-20T13:04:54.838Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min4_1758373494838","correlation_token":"sim_909c4aa76664333dbd33add873591bca_1758373233161"}
{"timestamp":"2025-09-20T13:04:54.856Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min4_1758373494838","minute_requested":4,"minutes_already_billed":3,"attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994"}
{"timestamp":"2025-09-20T13:04:54.856Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min4_1758373494838","attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":7,"minutes_already_billed":3,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-20T13:04:54.856Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min4_1758373494838","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":7,"expected_balance_after":6,"minute_to_bill":4}
{"timestamp":"2025-09-20T13:04:54.862Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min4_1758373494838","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-20T13:04:54.867Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min4_1758373494838","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":7,"new_balance":6,"change":-1}
{"timestamp":"2025-09-20T13:04:54.867Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min4_1758373494838","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":6,"minute":4}
{"timestamp":"2025-09-20T13:04:54.870Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min4_1758373494838","transaction_id":"40395fb0-b437-4b6d-9221-62b94f2bb47c","transaction_type":"DEBIT","balance_after":6}
{"timestamp":"2025-09-20T13:04:54.871Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min4_1758373494838","attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994","new_minutes_billed":4,"new_duration_seconds":240}
{"timestamp":"2025-09-20T13:04:54.873Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min4_1758373494838","attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994","minutes_billed":4}
{"timestamp":"2025-09-20T13:04:54.875Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min4_1758373494838","transaction_duration_ms":19,"new_balance":6,"minute_billed":4,"total_minutes_billed_this_attempt":4,"total_successful":11,"total_minutes_billed_all_time":11,"avg_transaction_time":"20.82"}
{"timestamp":"2025-09-20T13:04:54.875Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min4_1758373494838","total_duration_ms":37,"transaction_duration_ms":19,"response":{"status":"continue","creditsRemaining":6,"minuteBilled":4,"totalMinutesBilled":4,"attemptId":"1598f8e1-be6c-475c-a76d-9412a5ce9994","shouldTerminate":false}}
{"timestamp":"2025-09-20T13:05:54.878360","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min5_1758373554885","correlation_token":"sim_909c4aa76664333dbd33add873591bca_1758373233161","conversation_id":"2f51cb14-306b-498d-be37-efe1deef93e7","minute":5,"metrics_total_requests":23}
{"timestamp":"2025-09-20T13:05:54.885Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min5_1758373554885","correlation_token":"sim_909c4aa76664333dbd33add873591bca_1758373233161"}
{"timestamp":"2025-09-20T13:05:54.897Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min5_1758373554885","minute_requested":5,"minutes_already_billed":4,"attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994"}
{"timestamp":"2025-09-20T13:05:54.897Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min5_1758373554885","attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":6,"minutes_already_billed":4,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-20T13:05:54.897Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min5_1758373554885","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":6,"expected_balance_after":5,"minute_to_bill":5}
{"timestamp":"2025-09-20T13:05:54.902Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min5_1758373554885","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-20T13:05:54.905Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min5_1758373554885","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":6,"new_balance":5,"change":-1}
{"timestamp":"2025-09-20T13:05:54.905Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min5_1758373554885","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":5,"minute":5}
{"timestamp":"2025-09-20T13:05:54.908Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min5_1758373554885","transaction_id":"3e31e328-9ed4-4b3f-8dbf-5eb0e32d71b1","transaction_type":"DEBIT","balance_after":5}
{"timestamp":"2025-09-20T13:05:54.908Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min5_1758373554885","attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994","new_minutes_billed":5,"new_duration_seconds":300}
{"timestamp":"2025-09-20T13:05:54.910Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min5_1758373554885","attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994","minutes_billed":5}
{"timestamp":"2025-09-20T13:05:54.911Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min5_1758373554885","transaction_duration_ms":14,"new_balance":5,"minute_billed":5,"total_minutes_billed_this_attempt":5,"total_successful":12,"total_minutes_billed_all_time":12,"avg_transaction_time":"20.25"}
{"timestamp":"2025-09-20T13:05:54.911Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min5_1758373554885","total_duration_ms":26,"transaction_duration_ms":14,"response":{"status":"continue","creditsRemaining":5,"minuteBilled":5,"totalMinutesBilled":5,"attemptId":"1598f8e1-be6c-475c-a76d-9412a5ce9994","shouldTerminate":false}}
{"timestamp":"2025-09-20T13:06:54.914407","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min6_1758373614916","correlation_token":"sim_909c4aa76664333dbd33add873591bca_1758373233161","conversation_id":"2f51cb14-306b-498d-be37-efe1deef93e7","minute":6,"metrics_total_requests":24}
{"timestamp":"2025-09-20T13:06:54.916Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min6_1758373614916","correlation_token":"sim_909c4aa76664333dbd33add873591bca_1758373233161"}
{"timestamp":"2025-09-20T13:06:54.925Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min6_1758373614916","minute_requested":6,"minutes_already_billed":5,"attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994"}
{"timestamp":"2025-09-20T13:06:54.925Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min6_1758373614916","attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":5,"minutes_already_billed":5,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-20T13:06:54.925Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min6_1758373614916","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":5,"expected_balance_after":4,"minute_to_bill":6}
{"timestamp":"2025-09-20T13:06:54.928Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min6_1758373614916","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-20T13:06:54.931Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min6_1758373614916","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":5,"new_balance":4,"change":-1}
{"timestamp":"2025-09-20T13:06:54.931Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min6_1758373614916","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":4,"minute":6}
{"timestamp":"2025-09-20T13:06:54.933Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min6_1758373614916","transaction_id":"78cf6d35-8706-4ca9-a599-0df9814c9aa1","transaction_type":"DEBIT","balance_after":4}
{"timestamp":"2025-09-20T13:06:54.933Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min6_1758373614916","attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994","new_minutes_billed":6,"new_duration_seconds":360}
{"timestamp":"2025-09-20T13:06:54.935Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min6_1758373614916","attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994","minutes_billed":6}
{"timestamp":"2025-09-20T13:06:54.937Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min6_1758373614916","transaction_duration_ms":12,"new_balance":4,"minute_billed":6,"total_minutes_billed_this_attempt":6,"total_successful":13,"total_minutes_billed_all_time":13,"avg_transaction_time":"19.62"}
{"timestamp":"2025-09-20T13:06:54.937Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min6_1758373614916","total_duration_ms":21,"transaction_duration_ms":12,"response":{"status":"continue","creditsRemaining":4,"minuteBilled":6,"totalMinutesBilled":6,"attemptId":"1598f8e1-be6c-475c-a76d-9412a5ce9994","shouldTerminate":false}}
{"timestamp":"2025-09-20T13:07:54.942594","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min7_1758373674947","correlation_token":"sim_909c4aa76664333dbd33add873591bca_1758373233161","conversation_id":"2f51cb14-306b-498d-be37-efe1deef93e7","minute":7,"metrics_total_requests":25}
{"timestamp":"2025-09-20T13:07:54.947Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min7_1758373674947","correlation_token":"sim_909c4aa76664333dbd33add873591bca_1758373233161"}
{"timestamp":"2025-09-20T13:07:54.963Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min7_1758373674947","minute_requested":7,"minutes_already_billed":6,"attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994"}
{"timestamp":"2025-09-20T13:07:54.963Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min7_1758373674947","attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":4,"minutes_already_billed":6,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-20T13:07:54.963Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min7_1758373674947","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":4,"expected_balance_after":3,"minute_to_bill":7}
{"timestamp":"2025-09-20T13:07:54.968Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min7_1758373674947","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-20T13:07:54.971Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min7_1758373674947","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":4,"new_balance":3,"change":-1}
{"timestamp":"2025-09-20T13:07:54.971Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min7_1758373674947","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":3,"minute":7}
{"timestamp":"2025-09-20T13:07:54.974Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min7_1758373674947","transaction_id":"6354f141-10d4-4ff3-b9fe-d8a18c31825d","transaction_type":"DEBIT","balance_after":3}
{"timestamp":"2025-09-20T13:07:54.974Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min7_1758373674947","attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994","new_minutes_billed":7,"new_duration_seconds":420}
{"timestamp":"2025-09-20T13:07:54.977Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min7_1758373674947","attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994","minutes_billed":7}
{"timestamp":"2025-09-20T13:07:54.978Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min7_1758373674947","transaction_duration_ms":15,"new_balance":3,"minute_billed":7,"total_minutes_billed_this_attempt":7,"total_successful":14,"total_minutes_billed_all_time":14,"avg_transaction_time":"19.29"}
{"timestamp":"2025-09-20T13:07:54.978Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min7_1758373674947","total_duration_ms":31,"transaction_duration_ms":15,"response":{"status":"continue","creditsRemaining":3,"minuteBilled":7,"totalMinutesBilled":7,"attemptId":"1598f8e1-be6c-475c-a76d-9412a5ce9994","shouldTerminate":false}}
{"timestamp":"2025-09-20T13:08:54.984259","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min8_1758373734996","correlation_token":"sim_909c4aa76664333dbd33add873591bca_1758373233161","conversation_id":"2f51cb14-306b-498d-be37-efe1deef93e7","minute":8,"metrics_total_requests":26}
{"timestamp":"2025-09-20T13:08:54.996Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min8_1758373734996","correlation_token":"sim_909c4aa76664333dbd33add873591bca_1758373233161"}
{"timestamp":"2025-09-20T13:08:55.024Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min8_1758373734996","minute_requested":8,"minutes_already_billed":7,"attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994"}
{"timestamp":"2025-09-20T13:08:55.024Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min8_1758373734996","attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":3,"minutes_already_billed":7,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-20T13:08:55.024Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min8_1758373734996","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":3,"expected_balance_after":2,"minute_to_bill":8}
{"timestamp":"2025-09-20T13:08:55.034Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min8_1758373734996","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-20T13:08:55.037Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min8_1758373734996","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":3,"new_balance":2,"change":-1}
{"timestamp":"2025-09-20T13:08:55.037Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min8_1758373734996","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":2,"minute":8}
{"timestamp":"2025-09-20T13:08:55.039Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min8_1758373734996","transaction_id":"56b4b4c2-dc07-46ec-85d5-f643f63d4750","transaction_type":"DEBIT","balance_after":2}
{"timestamp":"2025-09-20T13:08:55.039Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min8_1758373734996","attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994","new_minutes_billed":8,"new_duration_seconds":480}
{"timestamp":"2025-09-20T13:08:55.042Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min8_1758373734996","attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994","minutes_billed":8}
{"timestamp":"2025-09-20T13:08:55.043Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min8_1758373734996","transaction_duration_ms":19,"new_balance":2,"minute_billed":8,"total_minutes_billed_this_attempt":8,"total_successful":15,"total_minutes_billed_all_time":15,"avg_transaction_time":"19.27"}
{"timestamp":"2025-09-20T13:08:55.043Z","level":"WARN","service":"BillingService","message":"Low credits warning threshold reached","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min8_1758373734996","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","credits_remaining":2,"minute_billed":8,"warning_threshold":2}
{"timestamp":"2025-09-20T13:08:55.043Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min8_1758373734996","total_duration_ms":47,"transaction_duration_ms":19,"response":{"status":"warning","creditsRemaining":2,"minuteBilled":8,"totalMinutesBilled":8,"attemptId":"1598f8e1-be6c-475c-a76d-9412a5ce9994","shouldTerminate":false,"message":"Low credits warning: 2 minute(s) remaining"}}
{"timestamp":"2025-09-20T13:09:55.048660","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min9_1758373795057","correlation_token":"sim_909c4aa76664333dbd33add873591bca_1758373233161","conversation_id":"2f51cb14-306b-498d-be37-efe1deef93e7","minute":9,"metrics_total_requests":27}
{"timestamp":"2025-09-20T13:09:55.057Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min9_1758373795057","correlation_token":"sim_909c4aa76664333dbd33add873591bca_1758373233161"}
{"timestamp":"2025-09-20T13:09:55.070Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min9_1758373795057","minute_requested":9,"minutes_already_billed":8,"attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994"}
{"timestamp":"2025-09-20T13:09:55.070Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min9_1758373795057","attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":2,"minutes_already_billed":8,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-20T13:09:55.070Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min9_1758373795057","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":2,"expected_balance_after":1,"minute_to_bill":9}
{"timestamp":"2025-09-20T13:09:55.074Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min9_1758373795057","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-20T13:09:55.078Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min9_1758373795057","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":2,"new_balance":1,"change":-1}
{"timestamp":"2025-09-20T13:09:55.078Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min9_1758373795057","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":1,"minute":9}
{"timestamp":"2025-09-20T13:09:55.080Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min9_1758373795057","transaction_id":"ef22549a-5dde-4d1c-976d-68deccb311d6","transaction_type":"DEBIT","balance_after":1}
{"timestamp":"2025-09-20T13:09:55.080Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min9_1758373795057","attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994","new_minutes_billed":9,"new_duration_seconds":540}
{"timestamp":"2025-09-20T13:09:55.082Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min9_1758373795057","attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994","minutes_billed":9}
{"timestamp":"2025-09-20T13:09:55.083Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min9_1758373795057","transaction_duration_ms":13,"new_balance":1,"minute_billed":9,"total_minutes_billed_this_attempt":9,"total_successful":16,"total_minutes_billed_all_time":16,"avg_transaction_time":"18.88"}
{"timestamp":"2025-09-20T13:09:55.083Z","level":"WARN","service":"BillingService","message":"Low credits warning threshold reached","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min9_1758373795057","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","credits_remaining":1,"minute_billed":9,"warning_threshold":2}
{"timestamp":"2025-09-20T13:09:55.083Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min9_1758373795057","total_duration_ms":26,"transaction_duration_ms":13,"response":{"status":"warning","creditsRemaining":1,"minuteBilled":9,"totalMinutesBilled":9,"attemptId":"1598f8e1-be6c-475c-a76d-9412a5ce9994","shouldTerminate":false,"message":"Low credits warning: 1 minute(s) remaining"}}
{"timestamp":"2025-09-20T13:10:18.478443","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min10_1758373818479","correlation_token":"sim_909c4aa76664333dbd33add873591bca_1758373233161","conversation_id":"2f51cb14-306b-498d-be37-efe1deef93e7","minute":10,"metrics_total_requests":28}
{"timestamp":"2025-09-20T13:10:18.479Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min10_1758373818479","correlation_token":"sim_909c4aa76664333dbd33add873591bca_1758373233161"}
{"timestamp":"2025-09-20T13:10:18.491Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min10_1758373818479","minute_requested":10,"minutes_already_billed":9,"attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994"}
{"timestamp":"2025-09-20T13:10:18.492Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min10_1758373818479","attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":1,"minutes_already_billed":9,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-20T13:10:18.492Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min10_1758373818479","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":1,"expected_balance_after":0,"minute_to_bill":10}
{"timestamp":"2025-09-20T13:10:18.496Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min10_1758373818479","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-20T13:10:18.498Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min10_1758373818479","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":1,"new_balance":0,"change":-1}
{"timestamp":"2025-09-20T13:10:18.498Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min10_1758373818479","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":0,"minute":10}
{"timestamp":"2025-09-20T13:10:18.500Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min10_1758373818479","transaction_id":"54768e84-39a3-4998-8d24-106b64c80205","transaction_type":"DEBIT","balance_after":0}
{"timestamp":"2025-09-20T13:10:18.500Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min10_1758373818479","attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994","new_minutes_billed":10,"new_duration_seconds":600}
{"timestamp":"2025-09-20T13:10:18.502Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min10_1758373818479","attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994","minutes_billed":10}
{"timestamp":"2025-09-20T13:10:18.503Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min10_1758373818479","transaction_duration_ms":11,"new_balance":0,"minute_billed":10,"total_minutes_billed_this_attempt":10,"total_successful":17,"total_minutes_billed_all_time":17,"avg_transaction_time":"18.41"}
{"timestamp":"2025-09-20T13:10:18.503Z","level":"WARN","service":"BillingService","message":"Last credit used - will terminate conversation","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min10_1758373818479","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","minute_billed":10,"total_minutes_this_session":10}
{"timestamp":"2025-09-20T13:10:18.503Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min10_1758373818479","total_duration_ms":24,"transaction_duration_ms":11,"response":{"status":"terminate","creditsRemaining":0,"minuteBilled":10,"totalMinutesBilled":10,"attemptId":"1598f8e1-be6c-475c-a76d-9412a5ce9994","shouldTerminate":true,"message":"Last credit used - conversation will end","gracePeriodSeconds":60}}
{"timestamp":"2025-09-20T21:04:37.694803","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_5bbec813-4889-4aea-9cdc-e58e92774dfe_min1_1758402277699","correlation_token":"transcript-1758402217369-rq608s2g1","conversation_id":"5bbec813-4889-4aea-9cdc-e58e92774dfe","minute":1,"metrics_total_requests":29}
{"timestamp":"2025-09-20T21:04:37.699Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_5bbec813-4889-4aea-9cdc-e58e92774dfe_min1_1758402277699","correlation_token":"transcript-1758402217369-rq608s2g1"}
{"timestamp":"2025-09-20T21:04:37.719Z","level":"ERROR","service":"BillingService","message":"Invalid correlation token - no attempt found","requestId":"bill_5bbec813-4889-4aea-9cdc-e58e92774dfe_min1_1758402277699","correlation_token":"transcript-1758402217369-rq608s2g1","conversation_id":"5bbec813-4889-4aea-9cdc-e58e92774dfe"}
{"timestamp":"2025-09-20T21:04:37.721219","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_5bbec813-4889-4aea-9cdc-e58e92774dfe_min2_1758402277722","correlation_token":"transcript-1758402217369-rq608s2g1","conversation_id":"5bbec813-4889-4aea-9cdc-e58e92774dfe","minute":2,"metrics_total_requests":30}
{"timestamp":"2025-09-20T21:04:37.722Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_5bbec813-4889-4aea-9cdc-e58e92774dfe_min2_1758402277722","correlation_token":"transcript-1758402217369-rq608s2g1"}
{"timestamp":"2025-09-20T21:04:37.727Z","level":"ERROR","service":"BillingService","message":"Invalid correlation token - no attempt found","requestId":"bill_5bbec813-4889-4aea-9cdc-e58e92774dfe_min2_1758402277722","correlation_token":"transcript-1758402217369-rq608s2g1","conversation_id":"5bbec813-4889-4aea-9cdc-e58e92774dfe"}
{"timestamp":"2025-09-21T12:32:53.535Z","level":"INFO","service":"BillingService","message":"BillingService initialized","environment":"development","database_url":"configured"}
{"timestamp":"2025-09-21T12:37:20.462425","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min1_1758458240466","correlation_token":"sim_bcfbeccdd98d4ee98ee81cd721cd3251_1758458180122","conversation_id":"627e46c4-36c2-4f14-9321-b92a9a7fa014","minute":1,"metrics_total_requests":1}
{"timestamp":"2025-09-21T12:37:20.466Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min1_1758458240466","correlation_token":"sim_bcfbeccdd98d4ee98ee81cd721cd3251_1758458180122"}
{"timestamp":"2025-09-21T12:37:20.472Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min1_1758458240466","minute_requested":1,"minutes_already_billed":0,"attempt_id":"8f4294c9-6332-47f3-b21c-e34424233f19"}
{"timestamp":"2025-09-21T12:37:20.472Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min1_1758458240466","attempt_id":"8f4294c9-6332-47f3-b21c-e34424233f19","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":10,"minutes_already_billed":0,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-21T12:37:20.473Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min1_1758458240466","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":10,"expected_balance_after":9,"minute_to_bill":1}
{"timestamp":"2025-09-21T12:37:20.478Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min1_1758458240466","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-21T12:37:20.480Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min1_1758458240466","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":10,"new_balance":9,"change":-1}
{"timestamp":"2025-09-21T12:37:20.480Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min1_1758458240466","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":9,"minute":1}
{"timestamp":"2025-09-21T12:37:20.482Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min1_1758458240466","transaction_id":"cf9932f6-3596-49b6-b475-747d9cc9fee8","transaction_type":"DEBIT","balance_after":9}
{"timestamp":"2025-09-21T12:37:20.482Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min1_1758458240466","attempt_id":"8f4294c9-6332-47f3-b21c-e34424233f19","new_minutes_billed":1,"new_duration_seconds":60}
{"timestamp":"2025-09-21T12:37:20.483Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min1_1758458240466","attempt_id":"8f4294c9-6332-47f3-b21c-e34424233f19","minutes_billed":1}
{"timestamp":"2025-09-21T12:37:20.485Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min1_1758458240466","transaction_duration_ms":12,"new_balance":9,"minute_billed":1,"total_minutes_billed_this_attempt":1,"total_successful":1,"total_minutes_billed_all_time":1,"avg_transaction_time":"12.00"}
{"timestamp":"2025-09-21T12:37:20.485Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min1_1758458240466","total_duration_ms":19,"transaction_duration_ms":12,"response":{"status":"continue","creditsRemaining":9,"minuteBilled":1,"totalMinutesBilled":1,"attemptId":"8f4294c9-6332-47f3-b21c-e34424233f19","shouldTerminate":false}}
{"timestamp":"2025-09-21T12:38:20.488418","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min2_1758458300494","correlation_token":"sim_bcfbeccdd98d4ee98ee81cd721cd3251_1758458180122","conversation_id":"627e46c4-36c2-4f14-9321-b92a9a7fa014","minute":2,"metrics_total_requests":2}
{"timestamp":"2025-09-21T12:38:20.494Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min2_1758458300494","correlation_token":"sim_bcfbeccdd98d4ee98ee81cd721cd3251_1758458180122"}
{"timestamp":"2025-09-21T12:38:20.507Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min2_1758458300494","minute_requested":2,"minutes_already_billed":1,"attempt_id":"8f4294c9-6332-47f3-b21c-e34424233f19"}
{"timestamp":"2025-09-21T12:38:20.507Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min2_1758458300494","attempt_id":"8f4294c9-6332-47f3-b21c-e34424233f19","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":9,"minutes_already_billed":1,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-21T12:38:20.507Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min2_1758458300494","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":9,"expected_balance_after":8,"minute_to_bill":2}
{"timestamp":"2025-09-21T12:38:20.512Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min2_1758458300494","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-21T12:38:20.515Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min2_1758458300494","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":9,"new_balance":8,"change":-1}
{"timestamp":"2025-09-21T12:38:20.515Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min2_1758458300494","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":8,"minute":2}
{"timestamp":"2025-09-21T12:38:20.518Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min2_1758458300494","transaction_id":"57820aaa-d69a-4245-a0e8-57d5330fc5a5","transaction_type":"DEBIT","balance_after":8}
{"timestamp":"2025-09-21T12:38:20.518Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min2_1758458300494","attempt_id":"8f4294c9-6332-47f3-b21c-e34424233f19","new_minutes_billed":2,"new_duration_seconds":120}
{"timestamp":"2025-09-21T12:38:20.520Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min2_1758458300494","attempt_id":"8f4294c9-6332-47f3-b21c-e34424233f19","minutes_billed":2}
{"timestamp":"2025-09-21T12:38:20.522Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min2_1758458300494","transaction_duration_ms":15,"new_balance":8,"minute_billed":2,"total_minutes_billed_this_attempt":2,"total_successful":2,"total_minutes_billed_all_time":2,"avg_transaction_time":"13.50"}
{"timestamp":"2025-09-21T12:38:20.522Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min2_1758458300494","total_duration_ms":28,"transaction_duration_ms":15,"response":{"status":"continue","creditsRemaining":8,"minuteBilled":2,"totalMinutesBilled":2,"attemptId":"8f4294c9-6332-47f3-b21c-e34424233f19","shouldTerminate":false}}
{"timestamp":"2025-09-21T12:39:20.529258","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min3_1758458360537","correlation_token":"sim_bcfbeccdd98d4ee98ee81cd721cd3251_1758458180122","conversation_id":"627e46c4-36c2-4f14-9321-b92a9a7fa014","minute":3,"metrics_total_requests":3}
{"timestamp":"2025-09-21T12:39:20.537Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min3_1758458360537","correlation_token":"sim_bcfbeccdd98d4ee98ee81cd721cd3251_1758458180122"}
{"timestamp":"2025-09-21T12:39:20.549Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min3_1758458360537","minute_requested":3,"minutes_already_billed":2,"attempt_id":"8f4294c9-6332-47f3-b21c-e34424233f19"}
{"timestamp":"2025-09-21T12:39:20.549Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min3_1758458360537","attempt_id":"8f4294c9-6332-47f3-b21c-e34424233f19","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":8,"minutes_already_billed":2,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-21T12:39:20.549Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min3_1758458360537","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":8,"expected_balance_after":7,"minute_to_bill":3}
{"timestamp":"2025-09-21T12:39:20.555Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min3_1758458360537","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-21T12:39:20.558Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min3_1758458360537","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":8,"new_balance":7,"change":-1}
{"timestamp":"2025-09-21T12:39:20.558Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min3_1758458360537","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":7,"minute":3}
{"timestamp":"2025-09-21T12:39:20.561Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min3_1758458360537","transaction_id":"e70c0010-685c-4c6c-9e19-ad8c034e32a0","transaction_type":"DEBIT","balance_after":7}
{"timestamp":"2025-09-21T12:39:20.561Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min3_1758458360537","attempt_id":"8f4294c9-6332-47f3-b21c-e34424233f19","new_minutes_billed":3,"new_duration_seconds":180}
{"timestamp":"2025-09-21T12:39:20.564Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min3_1758458360537","attempt_id":"8f4294c9-6332-47f3-b21c-e34424233f19","minutes_billed":3}
{"timestamp":"2025-09-21T12:39:20.566Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min3_1758458360537","transaction_duration_ms":17,"new_balance":7,"minute_billed":3,"total_minutes_billed_this_attempt":3,"total_successful":3,"total_minutes_billed_all_time":3,"avg_transaction_time":"14.67"}
{"timestamp":"2025-09-21T12:39:20.566Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min3_1758458360537","total_duration_ms":29,"transaction_duration_ms":17,"response":{"status":"continue","creditsRemaining":7,"minuteBilled":3,"totalMinutesBilled":3,"attemptId":"8f4294c9-6332-47f3-b21c-e34424233f19","shouldTerminate":false}}
{"timestamp":"2025-09-21T12:40:20.571932","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min4_1758458420579","correlation_token":"sim_bcfbeccdd98d4ee98ee81cd721cd3251_1758458180122","conversation_id":"627e46c4-36c2-4f14-9321-b92a9a7fa014","minute":4,"metrics_total_requests":4}
{"timestamp":"2025-09-21T12:40:20.579Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min4_1758458420579","correlation_token":"sim_bcfbeccdd98d4ee98ee81cd721cd3251_1758458180122"}
{"timestamp":"2025-09-21T12:40:20.591Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min4_1758458420579","minute_requested":4,"minutes_already_billed":3,"attempt_id":"8f4294c9-6332-47f3-b21c-e34424233f19"}
{"timestamp":"2025-09-21T12:40:20.591Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min4_1758458420579","attempt_id":"8f4294c9-6332-47f3-b21c-e34424233f19","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":7,"minutes_already_billed":3,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-21T12:40:20.591Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min4_1758458420579","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":7,"expected_balance_after":6,"minute_to_bill":4}
{"timestamp":"2025-09-21T12:40:20.595Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min4_1758458420579","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-21T12:40:20.597Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min4_1758458420579","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":7,"new_balance":6,"change":-1}
{"timestamp":"2025-09-21T12:40:20.597Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min4_1758458420579","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":6,"minute":4}
{"timestamp":"2025-09-21T12:40:20.600Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min4_1758458420579","transaction_id":"db358e69-4597-47e0-b6c6-b09d869c6450","transaction_type":"DEBIT","balance_after":6}
{"timestamp":"2025-09-21T12:40:20.600Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min4_1758458420579","attempt_id":"8f4294c9-6332-47f3-b21c-e34424233f19","new_minutes_billed":4,"new_duration_seconds":240}
{"timestamp":"2025-09-21T12:40:20.603Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min4_1758458420579","attempt_id":"8f4294c9-6332-47f3-b21c-e34424233f19","minutes_billed":4}
{"timestamp":"2025-09-21T12:40:20.605Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min4_1758458420579","transaction_duration_ms":14,"new_balance":6,"minute_billed":4,"total_minutes_billed_this_attempt":4,"total_successful":4,"total_minutes_billed_all_time":4,"avg_transaction_time":"14.50"}
{"timestamp":"2025-09-21T12:40:20.605Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min4_1758458420579","total_duration_ms":26,"transaction_duration_ms":14,"response":{"status":"continue","creditsRemaining":6,"minuteBilled":4,"totalMinutesBilled":4,"attemptId":"8f4294c9-6332-47f3-b21c-e34424233f19","shouldTerminate":false}}
{"timestamp":"2025-09-21T12:41:20.611595","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min5_1758458480623","correlation_token":"sim_bcfbeccdd98d4ee98ee81cd721cd3251_1758458180122","conversation_id":"627e46c4-36c2-4f14-9321-b92a9a7fa014","minute":5,"metrics_total_requests":5}
{"timestamp":"2025-09-21T12:41:20.624Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min5_1758458480623","correlation_token":"sim_bcfbeccdd98d4ee98ee81cd721cd3251_1758458180122"}
{"timestamp":"2025-09-21T12:41:20.679Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min5_1758458480623","minute_requested":5,"minutes_already_billed":4,"attempt_id":"8f4294c9-6332-47f3-b21c-e34424233f19"}
{"timestamp":"2025-09-21T12:41:20.680Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min5_1758458480623","attempt_id":"8f4294c9-6332-47f3-b21c-e34424233f19","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":6,"minutes_already_billed":4,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-21T12:41:20.680Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min5_1758458480623","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":6,"expected_balance_after":5,"minute_to_bill":5}
{"timestamp":"2025-09-21T12:41:20.698Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min5_1758458480623","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-21T12:41:20.715Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min5_1758458480623","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":6,"new_balance":5,"change":-1}
{"timestamp":"2025-09-21T12:41:20.715Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min5_1758458480623","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":5,"minute":5}
{"timestamp":"2025-09-21T12:41:20.718Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min5_1758458480623","transaction_id":"eaae6693-6f31-47e9-a8ca-5a6a972df9d1","transaction_type":"DEBIT","balance_after":5}
{"timestamp":"2025-09-21T12:41:20.718Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min5_1758458480623","attempt_id":"8f4294c9-6332-47f3-b21c-e34424233f19","new_minutes_billed":5,"new_duration_seconds":300}
{"timestamp":"2025-09-21T12:41:20.721Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min5_1758458480623","attempt_id":"8f4294c9-6332-47f3-b21c-e34424233f19","minutes_billed":5}
{"timestamp":"2025-09-21T12:41:20.723Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min5_1758458480623","transaction_duration_ms":43,"new_balance":5,"minute_billed":5,"total_minutes_billed_this_attempt":5,"total_successful":5,"total_minutes_billed_all_time":5,"avg_transaction_time":"20.20"}
{"timestamp":"2025-09-21T12:41:20.723Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min5_1758458480623","total_duration_ms":100,"transaction_duration_ms":43,"response":{"status":"continue","creditsRemaining":5,"minuteBilled":5,"totalMinutesBilled":5,"attemptId":"8f4294c9-6332-47f3-b21c-e34424233f19","shouldTerminate":false}}
{"timestamp":"2025-09-21T12:42:20.728907","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min6_1758458540735","correlation_token":"sim_bcfbeccdd98d4ee98ee81cd721cd3251_1758458180122","conversation_id":"627e46c4-36c2-4f14-9321-b92a9a7fa014","minute":6,"metrics_total_requests":6}
{"timestamp":"2025-09-21T12:42:20.735Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min6_1758458540735","correlation_token":"sim_bcfbeccdd98d4ee98ee81cd721cd3251_1758458180122"}
{"timestamp":"2025-09-21T12:42:20.749Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min6_1758458540735","minute_requested":6,"minutes_already_billed":5,"attempt_id":"8f4294c9-6332-47f3-b21c-e34424233f19"}
{"timestamp":"2025-09-21T12:42:20.749Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min6_1758458540735","attempt_id":"8f4294c9-6332-47f3-b21c-e34424233f19","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":5,"minutes_already_billed":5,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-21T12:42:20.750Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min6_1758458540735","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":5,"expected_balance_after":4,"minute_to_bill":6}
{"timestamp":"2025-09-21T12:42:20.753Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min6_1758458540735","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-21T12:42:20.756Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min6_1758458540735","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":5,"new_balance":4,"change":-1}
{"timestamp":"2025-09-21T12:42:20.756Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min6_1758458540735","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":4,"minute":6}
{"timestamp":"2025-09-21T12:42:20.758Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min6_1758458540735","transaction_id":"374e05cd-498c-415b-8895-730cd61e578b","transaction_type":"DEBIT","balance_after":4}
{"timestamp":"2025-09-21T12:42:20.758Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min6_1758458540735","attempt_id":"8f4294c9-6332-47f3-b21c-e34424233f19","new_minutes_billed":6,"new_duration_seconds":360}
{"timestamp":"2025-09-21T12:42:20.761Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min6_1758458540735","attempt_id":"8f4294c9-6332-47f3-b21c-e34424233f19","minutes_billed":6}
{"timestamp":"2025-09-21T12:42:20.763Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min6_1758458540735","transaction_duration_ms":13,"new_balance":4,"minute_billed":6,"total_minutes_billed_this_attempt":6,"total_successful":6,"total_minutes_billed_all_time":6,"avg_transaction_time":"19.00"}
{"timestamp":"2025-09-21T12:42:20.763Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min6_1758458540735","total_duration_ms":28,"transaction_duration_ms":13,"response":{"status":"continue","creditsRemaining":4,"minuteBilled":6,"totalMinutesBilled":6,"attemptId":"8f4294c9-6332-47f3-b21c-e34424233f19","shouldTerminate":false}}
{"timestamp":"2025-09-21T12:42:38.273782","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min7_1758458558277","correlation_token":"sim_bcfbeccdd98d4ee98ee81cd721cd3251_1758458180122","conversation_id":"627e46c4-36c2-4f14-9321-b92a9a7fa014","minute":7,"metrics_total_requests":7}
{"timestamp":"2025-09-21T12:42:38.278Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min7_1758458558277","correlation_token":"sim_bcfbeccdd98d4ee98ee81cd721cd3251_1758458180122"}
{"timestamp":"2025-09-21T12:42:38.290Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min7_1758458558277","minute_requested":7,"minutes_already_billed":6,"attempt_id":"8f4294c9-6332-47f3-b21c-e34424233f19"}
{"timestamp":"2025-09-21T12:42:38.290Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min7_1758458558277","attempt_id":"8f4294c9-6332-47f3-b21c-e34424233f19","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":4,"minutes_already_billed":6,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-21T12:42:38.290Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min7_1758458558277","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":4,"expected_balance_after":3,"minute_to_bill":7}
{"timestamp":"2025-09-21T12:42:38.296Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min7_1758458558277","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-21T12:42:38.299Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min7_1758458558277","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":4,"new_balance":3,"change":-1}
{"timestamp":"2025-09-21T12:42:38.299Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min7_1758458558277","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":3,"minute":7}
{"timestamp":"2025-09-21T12:42:38.302Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min7_1758458558277","transaction_id":"93021c26-c138-4937-908f-004ad0cc90f3","transaction_type":"DEBIT","balance_after":3}
{"timestamp":"2025-09-21T12:42:38.302Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min7_1758458558277","attempt_id":"8f4294c9-6332-47f3-b21c-e34424233f19","new_minutes_billed":7,"new_duration_seconds":420}
{"timestamp":"2025-09-21T12:42:38.306Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min7_1758458558277","attempt_id":"8f4294c9-6332-47f3-b21c-e34424233f19","minutes_billed":7}
{"timestamp":"2025-09-21T12:42:38.309Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min7_1758458558277","transaction_duration_ms":18,"new_balance":3,"minute_billed":7,"total_minutes_billed_this_attempt":7,"total_successful":7,"total_minutes_billed_all_time":7,"avg_transaction_time":"18.86"}
{"timestamp":"2025-09-21T12:42:38.309Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_627e46c4-36c2-4f14-9321-b92a9a7fa014_min7_1758458558277","total_duration_ms":32,"transaction_duration_ms":18,"response":{"status":"continue","creditsRemaining":3,"minuteBilled":7,"totalMinutesBilled":7,"attemptId":"8f4294c9-6332-47f3-b21c-e34424233f19","shouldTerminate":false}}
{"timestamp":"2025-09-21T12:45:46.359218","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_771f8a41-bca5-4a17-8aaa-786908018ad3_min1_1758458746366","correlation_token":"sim_5843fb55034be0b70c9cf207f7082ae3_1758458686026","conversation_id":"771f8a41-bca5-4a17-8aaa-786908018ad3","minute":1,"metrics_total_requests":8}
{"timestamp":"2025-09-21T12:45:46.366Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_771f8a41-bca5-4a17-8aaa-786908018ad3_min1_1758458746366","correlation_token":"sim_5843fb55034be0b70c9cf207f7082ae3_1758458686026"}
{"timestamp":"2025-09-21T12:45:46.391Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_771f8a41-bca5-4a17-8aaa-786908018ad3_min1_1758458746366","minute_requested":1,"minutes_already_billed":0,"attempt_id":"8b651344-a2a2-47c0-8906-da08feeb0601"}
{"timestamp":"2025-09-21T12:45:46.391Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_771f8a41-bca5-4a17-8aaa-786908018ad3_min1_1758458746366","attempt_id":"8b651344-a2a2-47c0-8906-da08feeb0601","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":3,"minutes_already_billed":0,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-21T12:45:46.391Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_771f8a41-bca5-4a17-8aaa-786908018ad3_min1_1758458746366","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":3,"expected_balance_after":2,"minute_to_bill":1}
{"timestamp":"2025-09-21T12:45:46.397Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_771f8a41-bca5-4a17-8aaa-786908018ad3_min1_1758458746366","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-21T12:45:46.400Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_771f8a41-bca5-4a17-8aaa-786908018ad3_min1_1758458746366","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":3,"new_balance":2,"change":-1}
{"timestamp":"2025-09-21T12:45:46.400Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_771f8a41-bca5-4a17-8aaa-786908018ad3_min1_1758458746366","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":2,"minute":1}
{"timestamp":"2025-09-21T12:45:46.403Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_771f8a41-bca5-4a17-8aaa-786908018ad3_min1_1758458746366","transaction_id":"0f663c2b-70b6-49ae-a4fd-74fb0741ba56","transaction_type":"DEBIT","balance_after":2}
{"timestamp":"2025-09-21T12:45:46.403Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_771f8a41-bca5-4a17-8aaa-786908018ad3_min1_1758458746366","attempt_id":"8b651344-a2a2-47c0-8906-da08feeb0601","new_minutes_billed":1,"new_duration_seconds":60}
{"timestamp":"2025-09-21T12:45:46.412Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_771f8a41-bca5-4a17-8aaa-786908018ad3_min1_1758458746366","attempt_id":"8b651344-a2a2-47c0-8906-da08feeb0601","minutes_billed":1}
{"timestamp":"2025-09-21T12:45:46.417Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_771f8a41-bca5-4a17-8aaa-786908018ad3_min1_1758458746366","transaction_duration_ms":26,"new_balance":2,"minute_billed":1,"total_minutes_billed_this_attempt":1,"total_successful":8,"total_minutes_billed_all_time":8,"avg_transaction_time":"19.75"}
{"timestamp":"2025-09-21T12:45:46.417Z","level":"WARN","service":"BillingService","message":"Low credits warning threshold reached","requestId":"bill_771f8a41-bca5-4a17-8aaa-786908018ad3_min1_1758458746366","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","credits_remaining":2,"minute_billed":1,"warning_threshold":2}
{"timestamp":"2025-09-21T12:45:46.417Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_771f8a41-bca5-4a17-8aaa-786908018ad3_min1_1758458746366","total_duration_ms":51,"transaction_duration_ms":26,"response":{"status":"warning","creditsRemaining":2,"minuteBilled":1,"totalMinutesBilled":1,"attemptId":"8b651344-a2a2-47c0-8906-da08feeb0601","shouldTerminate":false,"message":"Low credits warning: 2 minute(s) remaining"}}
{"timestamp":"2025-09-21T12:46:46.427851","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_771f8a41-bca5-4a17-8aaa-786908018ad3_min2_1758458806430","correlation_token":"sim_5843fb55034be0b70c9cf207f7082ae3_1758458686026","conversation_id":"771f8a41-bca5-4a17-8aaa-786908018ad3","minute":2,"metrics_total_requests":9}
{"timestamp":"2025-09-21T12:46:46.431Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_771f8a41-bca5-4a17-8aaa-786908018ad3_min2_1758458806430","correlation_token":"sim_5843fb55034be0b70c9cf207f7082ae3_1758458686026"}
{"timestamp":"2025-09-21T12:46:46.439Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_771f8a41-bca5-4a17-8aaa-786908018ad3_min2_1758458806430","minute_requested":2,"minutes_already_billed":1,"attempt_id":"8b651344-a2a2-47c0-8906-da08feeb0601"}
{"timestamp":"2025-09-21T12:46:46.440Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_771f8a41-bca5-4a17-8aaa-786908018ad3_min2_1758458806430","attempt_id":"8b651344-a2a2-47c0-8906-da08feeb0601","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":2,"minutes_already_billed":1,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-21T12:46:46.440Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_771f8a41-bca5-4a17-8aaa-786908018ad3_min2_1758458806430","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":2,"expected_balance_after":1,"minute_to_bill":2}
{"timestamp":"2025-09-21T12:46:46.445Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_771f8a41-bca5-4a17-8aaa-786908018ad3_min2_1758458806430","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-21T12:46:46.447Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_771f8a41-bca5-4a17-8aaa-786908018ad3_min2_1758458806430","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":2,"new_balance":1,"change":-1}
{"timestamp":"2025-09-21T12:46:46.447Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_771f8a41-bca5-4a17-8aaa-786908018ad3_min2_1758458806430","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":1,"minute":2}
{"timestamp":"2025-09-21T12:46:46.449Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_771f8a41-bca5-4a17-8aaa-786908018ad3_min2_1758458806430","transaction_id":"6b6195e3-b936-42e2-a0cc-6c57b65977ac","transaction_type":"DEBIT","balance_after":1}
{"timestamp":"2025-09-21T12:46:46.449Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_771f8a41-bca5-4a17-8aaa-786908018ad3_min2_1758458806430","attempt_id":"8b651344-a2a2-47c0-8906-da08feeb0601","new_minutes_billed":2,"new_duration_seconds":120}
{"timestamp":"2025-09-21T12:46:46.451Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_771f8a41-bca5-4a17-8aaa-786908018ad3_min2_1758458806430","attempt_id":"8b651344-a2a2-47c0-8906-da08feeb0601","minutes_billed":2}
{"timestamp":"2025-09-21T12:46:46.453Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_771f8a41-bca5-4a17-8aaa-786908018ad3_min2_1758458806430","transaction_duration_ms":13,"new_balance":1,"minute_billed":2,"total_minutes_billed_this_attempt":2,"total_successful":9,"total_minutes_billed_all_time":9,"avg_transaction_time":"19.00"}
{"timestamp":"2025-09-21T12:46:46.453Z","level":"WARN","service":"BillingService","message":"Low credits warning threshold reached","requestId":"bill_771f8a41-bca5-4a17-8aaa-786908018ad3_min2_1758458806430","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","credits_remaining":1,"minute_billed":2,"warning_threshold":2}
{"timestamp":"2025-09-21T12:46:46.453Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_771f8a41-bca5-4a17-8aaa-786908018ad3_min2_1758458806430","total_duration_ms":23,"transaction_duration_ms":13,"response":{"status":"warning","creditsRemaining":1,"minuteBilled":2,"totalMinutesBilled":2,"attemptId":"8b651344-a2a2-47c0-8906-da08feeb0601","shouldTerminate":false,"message":"Low credits warning: 1 minute(s) remaining"}}
{"timestamp":"2025-09-21T12:47:46.456055","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_771f8a41-bca5-4a17-8aaa-786908018ad3_min3_1758458866463","correlation_token":"sim_5843fb55034be0b70c9cf207f7082ae3_1758458686026","conversation_id":"771f8a41-bca5-4a17-8aaa-786908018ad3","minute":3,"metrics_total_requests":10}
{"timestamp":"2025-09-21T12:47:46.463Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_771f8a41-bca5-4a17-8aaa-786908018ad3_min3_1758458866463","correlation_token":"sim_5843fb55034be0b70c9cf207f7082ae3_1758458686026"}
{"timestamp":"2025-09-21T12:47:46.484Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_771f8a41-bca5-4a17-8aaa-786908018ad3_min3_1758458866463","minute_requested":3,"minutes_already_billed":2,"attempt_id":"8b651344-a2a2-47c0-8906-da08feeb0601"}
{"timestamp":"2025-09-21T12:47:46.484Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_771f8a41-bca5-4a17-8aaa-786908018ad3_min3_1758458866463","attempt_id":"8b651344-a2a2-47c0-8906-da08feeb0601","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":1,"minutes_already_billed":2,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-21T12:47:46.484Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_771f8a41-bca5-4a17-8aaa-786908018ad3_min3_1758458866463","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":1,"expected_balance_after":0,"minute_to_bill":3}
{"timestamp":"2025-09-21T12:47:46.489Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_771f8a41-bca5-4a17-8aaa-786908018ad3_min3_1758458866463","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-21T12:47:46.492Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_771f8a41-bca5-4a17-8aaa-786908018ad3_min3_1758458866463","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":1,"new_balance":0,"change":-1}
{"timestamp":"2025-09-21T12:47:46.492Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_771f8a41-bca5-4a17-8aaa-786908018ad3_min3_1758458866463","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":0,"minute":3}
{"timestamp":"2025-09-21T12:47:46.496Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_771f8a41-bca5-4a17-8aaa-786908018ad3_min3_1758458866463","transaction_id":"50ef7551-9f38-4a4d-9b6b-68b7a3a7a341","transaction_type":"DEBIT","balance_after":0}
{"timestamp":"2025-09-21T12:47:46.496Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_771f8a41-bca5-4a17-8aaa-786908018ad3_min3_1758458866463","attempt_id":"8b651344-a2a2-47c0-8906-da08feeb0601","new_minutes_billed":3,"new_duration_seconds":180}
{"timestamp":"2025-09-21T12:47:46.499Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_771f8a41-bca5-4a17-8aaa-786908018ad3_min3_1758458866463","attempt_id":"8b651344-a2a2-47c0-8906-da08feeb0601","minutes_billed":3}
{"timestamp":"2025-09-21T12:47:46.501Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_771f8a41-bca5-4a17-8aaa-786908018ad3_min3_1758458866463","transaction_duration_ms":17,"new_balance":0,"minute_billed":3,"total_minutes_billed_this_attempt":3,"total_successful":10,"total_minutes_billed_all_time":10,"avg_transaction_time":"18.80"}
{"timestamp":"2025-09-21T12:47:46.501Z","level":"WARN","service":"BillingService","message":"Last credit used - will terminate conversation","requestId":"bill_771f8a41-bca5-4a17-8aaa-786908018ad3_min3_1758458866463","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","minute_billed":3,"total_minutes_this_session":3}
{"timestamp":"2025-09-21T12:47:46.501Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_771f8a41-bca5-4a17-8aaa-786908018ad3_min3_1758458866463","total_duration_ms":38,"transaction_duration_ms":17,"response":{"status":"terminate","creditsRemaining":0,"minuteBilled":3,"totalMinutesBilled":3,"attemptId":"8b651344-a2a2-47c0-8906-da08feeb0601","shouldTerminate":true,"message":"Last credit used - conversation will end","gracePeriodSeconds":60}}
{"timestamp":"2025-09-21T12:48:46.509314","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_771f8a41-bca5-4a17-8aaa-786908018ad3_min5_1758458926516","correlation_token":"sim_5843fb55034be0b70c9cf207f7082ae3_1758458686026","conversation_id":"771f8a41-bca5-4a17-8aaa-786908018ad3","minute":5,"metrics_total_requests":11}
{"timestamp":"2025-09-21T12:48:46.517Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_771f8a41-bca5-4a17-8aaa-786908018ad3_min5_1758458926516","correlation_token":"sim_5843fb55034be0b70c9cf207f7082ae3_1758458686026"}
{"timestamp":"2025-09-21T12:48:46.538Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_771f8a41-bca5-4a17-8aaa-786908018ad3_min5_1758458926516","minute_requested":5,"minutes_already_billed":3,"attempt_id":"8b651344-a2a2-47c0-8906-da08feeb0601"}
{"timestamp":"2025-09-21T12:48:46.538Z","level":"WARN","service":"BillingService","message":"Non-sequential minute billing detected","requestId":"bill_771f8a41-bca5-4a17-8aaa-786908018ad3_min5_1758458926516","minute_requested":5,"expected_minute":4,"gap":1,"attempt_id":"8b651344-a2a2-47c0-8906-da08feeb0601"}
{"timestamp":"2025-09-21T12:48:46.538Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_771f8a41-bca5-4a17-8aaa-786908018ad3_min5_1758458926516","attempt_id":"8b651344-a2a2-47c0-8906-da08feeb0601","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":0,"minutes_already_billed":3,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-21T12:48:46.538Z","level":"WARN","service":"BillingService","message":"Insufficient credits detected","requestId":"bill_771f8a41-bca5-4a17-8aaa-786908018ad3_min5_1758458926516","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_email":"john.doe@example.com","current_balance":0,"required":1,"minutes_billed":3,"total_insufficient_events":1}
{"timestamp":"2025-09-21T12:55:14.861016","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min1_1758459314866","correlation_token":"sim_b8d76b9b0b56946a3bdc7bd454191a36_1758459056257","conversation_id":"0ae31958-f6c6-42d2-9e7a-99911534fb36","minute":1,"metrics_total_requests":12}
{"timestamp":"2025-09-21T12:55:14.866Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min1_1758459314866","correlation_token":"sim_b8d76b9b0b56946a3bdc7bd454191a36_1758459056257"}
{"timestamp":"2025-09-21T12:55:14.874Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min1_1758459314866","minute_requested":1,"minutes_already_billed":0,"attempt_id":"cb16e5f9-a566-4e2b-8d76-285f287d0a4e"}
{"timestamp":"2025-09-21T12:55:14.874Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min1_1758459314866","attempt_id":"cb16e5f9-a566-4e2b-8d76-285f287d0a4e","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":10,"minutes_already_billed":0,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-21T12:55:14.874Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min1_1758459314866","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":10,"expected_balance_after":9,"minute_to_bill":1}
{"timestamp":"2025-09-21T12:55:14.877Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min1_1758459314866","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-21T12:55:14.880Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min1_1758459314866","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":10,"new_balance":9,"change":-1}
{"timestamp":"2025-09-21T12:55:14.880Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min1_1758459314866","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":9,"minute":1}
{"timestamp":"2025-09-21T12:55:14.882Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min1_1758459314866","transaction_id":"81c975cb-1eaa-4fa8-afed-7d0f3e407b2a","transaction_type":"DEBIT","balance_after":9}
{"timestamp":"2025-09-21T12:55:14.882Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min1_1758459314866","attempt_id":"cb16e5f9-a566-4e2b-8d76-285f287d0a4e","new_minutes_billed":1,"new_duration_seconds":60}
{"timestamp":"2025-09-21T12:55:14.884Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min1_1758459314866","attempt_id":"cb16e5f9-a566-4e2b-8d76-285f287d0a4e","minutes_billed":1}
{"timestamp":"2025-09-21T12:55:14.886Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min1_1758459314866","transaction_duration_ms":12,"new_balance":9,"minute_billed":1,"total_minutes_billed_this_attempt":1,"total_successful":11,"total_minutes_billed_all_time":11,"avg_transaction_time":"18.18"}
{"timestamp":"2025-09-21T12:55:14.886Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min1_1758459314866","total_duration_ms":20,"transaction_duration_ms":12,"response":{"status":"continue","creditsRemaining":9,"minuteBilled":1,"totalMinutesBilled":1,"attemptId":"cb16e5f9-a566-4e2b-8d76-285f287d0a4e","shouldTerminate":false}}
{"timestamp":"2025-09-21T12:56:14.890055","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min2_1758459374897","correlation_token":"sim_b8d76b9b0b56946a3bdc7bd454191a36_1758459056257","conversation_id":"0ae31958-f6c6-42d2-9e7a-99911534fb36","minute":2,"metrics_total_requests":13}
{"timestamp":"2025-09-21T12:56:14.898Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min2_1758459374897","correlation_token":"sim_b8d76b9b0b56946a3bdc7bd454191a36_1758459056257"}
{"timestamp":"2025-09-21T12:56:14.923Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min2_1758459374897","minute_requested":2,"minutes_already_billed":1,"attempt_id":"cb16e5f9-a566-4e2b-8d76-285f287d0a4e"}
{"timestamp":"2025-09-21T12:56:14.923Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min2_1758459374897","attempt_id":"cb16e5f9-a566-4e2b-8d76-285f287d0a4e","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":9,"minutes_already_billed":1,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-21T12:56:14.923Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min2_1758459374897","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":9,"expected_balance_after":8,"minute_to_bill":2}
{"timestamp":"2025-09-21T12:56:14.926Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min2_1758459374897","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-21T12:56:14.937Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min2_1758459374897","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":9,"new_balance":8,"change":-1}
{"timestamp":"2025-09-21T12:56:14.937Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min2_1758459374897","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":8,"minute":2}
{"timestamp":"2025-09-21T12:56:14.942Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min2_1758459374897","transaction_id":"33a57979-5aa4-4e88-8ce8-3572cd4df6b1","transaction_type":"DEBIT","balance_after":8}
{"timestamp":"2025-09-21T12:56:14.942Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min2_1758459374897","attempt_id":"cb16e5f9-a566-4e2b-8d76-285f287d0a4e","new_minutes_billed":2,"new_duration_seconds":120}
{"timestamp":"2025-09-21T12:56:14.945Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min2_1758459374897","attempt_id":"cb16e5f9-a566-4e2b-8d76-285f287d0a4e","minutes_billed":2}
{"timestamp":"2025-09-21T12:56:14.948Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min2_1758459374897","transaction_duration_ms":25,"new_balance":8,"minute_billed":2,"total_minutes_billed_this_attempt":2,"total_successful":12,"total_minutes_billed_all_time":12,"avg_transaction_time":"18.75"}
{"timestamp":"2025-09-21T12:56:14.948Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min2_1758459374897","total_duration_ms":51,"transaction_duration_ms":25,"response":{"status":"continue","creditsRemaining":8,"minuteBilled":2,"totalMinutesBilled":2,"attemptId":"cb16e5f9-a566-4e2b-8d76-285f287d0a4e","shouldTerminate":false}}
{"timestamp":"2025-09-21T12:57:14.958297","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min3_1758459434970","correlation_token":"sim_b8d76b9b0b56946a3bdc7bd454191a36_1758459056257","conversation_id":"0ae31958-f6c6-42d2-9e7a-99911534fb36","minute":3,"metrics_total_requests":14}
{"timestamp":"2025-09-21T12:57:14.972Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min3_1758459434970","correlation_token":"sim_b8d76b9b0b56946a3bdc7bd454191a36_1758459056257"}
{"timestamp":"2025-09-21T12:57:15.000Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min3_1758459434970","minute_requested":3,"minutes_already_billed":2,"attempt_id":"cb16e5f9-a566-4e2b-8d76-285f287d0a4e"}
{"timestamp":"2025-09-21T12:57:15.000Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min3_1758459434970","attempt_id":"cb16e5f9-a566-4e2b-8d76-285f287d0a4e","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":8,"minutes_already_billed":2,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-21T12:57:15.000Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min3_1758459434970","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":8,"expected_balance_after":7,"minute_to_bill":3}
{"timestamp":"2025-09-21T12:57:15.008Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min3_1758459434970","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-21T12:57:15.012Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min3_1758459434970","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":8,"new_balance":7,"change":-1}
{"timestamp":"2025-09-21T12:57:15.012Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min3_1758459434970","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":7,"minute":3}
{"timestamp":"2025-09-21T12:57:15.014Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min3_1758459434970","transaction_id":"b661808f-4d8a-4562-a1f4-7ca94406df39","transaction_type":"DEBIT","balance_after":7}
{"timestamp":"2025-09-21T12:57:15.014Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min3_1758459434970","attempt_id":"cb16e5f9-a566-4e2b-8d76-285f287d0a4e","new_minutes_billed":3,"new_duration_seconds":180}
{"timestamp":"2025-09-21T12:57:15.016Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min3_1758459434970","attempt_id":"cb16e5f9-a566-4e2b-8d76-285f287d0a4e","minutes_billed":3}
{"timestamp":"2025-09-21T12:57:15.018Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min3_1758459434970","transaction_duration_ms":18,"new_balance":7,"minute_billed":3,"total_minutes_billed_this_attempt":3,"total_successful":13,"total_minutes_billed_all_time":13,"avg_transaction_time":"18.69"}
{"timestamp":"2025-09-21T12:57:15.018Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min3_1758459434970","total_duration_ms":48,"transaction_duration_ms":18,"response":{"status":"continue","creditsRemaining":7,"minuteBilled":3,"totalMinutesBilled":3,"attemptId":"cb16e5f9-a566-4e2b-8d76-285f287d0a4e","shouldTerminate":false}}
{"timestamp":"2025-09-21T12:58:15.027381","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min4_1758459495041","correlation_token":"sim_b8d76b9b0b56946a3bdc7bd454191a36_1758459056257","conversation_id":"0ae31958-f6c6-42d2-9e7a-99911534fb36","minute":4,"metrics_total_requests":15}
{"timestamp":"2025-09-21T12:58:15.042Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min4_1758459495041","correlation_token":"sim_b8d76b9b0b56946a3bdc7bd454191a36_1758459056257"}
{"timestamp":"2025-09-21T12:58:15.074Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min4_1758459495041","minute_requested":4,"minutes_already_billed":3,"attempt_id":"cb16e5f9-a566-4e2b-8d76-285f287d0a4e"}
{"timestamp":"2025-09-21T12:58:15.075Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min4_1758459495041","attempt_id":"cb16e5f9-a566-4e2b-8d76-285f287d0a4e","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":7,"minutes_already_billed":3,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-21T12:58:15.075Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min4_1758459495041","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":7,"expected_balance_after":6,"minute_to_bill":4}
{"timestamp":"2025-09-21T12:58:15.078Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min4_1758459495041","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-21T12:58:15.083Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min4_1758459495041","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":7,"new_balance":6,"change":-1}
{"timestamp":"2025-09-21T12:58:15.083Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min4_1758459495041","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":6,"minute":4}
{"timestamp":"2025-09-21T12:58:15.086Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min4_1758459495041","transaction_id":"874ebb06-20de-43b0-a841-4cb5139fdaff","transaction_type":"DEBIT","balance_after":6}
{"timestamp":"2025-09-21T12:58:15.086Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min4_1758459495041","attempt_id":"cb16e5f9-a566-4e2b-8d76-285f287d0a4e","new_minutes_billed":4,"new_duration_seconds":240}
{"timestamp":"2025-09-21T12:58:15.089Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min4_1758459495041","attempt_id":"cb16e5f9-a566-4e2b-8d76-285f287d0a4e","minutes_billed":4}
{"timestamp":"2025-09-21T12:58:15.091Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min4_1758459495041","transaction_duration_ms":16,"new_balance":6,"minute_billed":4,"total_minutes_billed_this_attempt":4,"total_successful":14,"total_minutes_billed_all_time":14,"avg_transaction_time":"18.50"}
{"timestamp":"2025-09-21T12:58:15.091Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min4_1758459495041","total_duration_ms":50,"transaction_duration_ms":16,"response":{"status":"continue","creditsRemaining":6,"minuteBilled":4,"totalMinutesBilled":4,"attemptId":"cb16e5f9-a566-4e2b-8d76-285f287d0a4e","shouldTerminate":false}}
{"timestamp":"2025-09-21T12:59:15.095298","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min5_1758459555096","correlation_token":"sim_b8d76b9b0b56946a3bdc7bd454191a36_1758459056257","conversation_id":"0ae31958-f6c6-42d2-9e7a-99911534fb36","minute":5,"metrics_total_requests":16}
{"timestamp":"2025-09-21T12:59:15.096Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min5_1758459555096","correlation_token":"sim_b8d76b9b0b56946a3bdc7bd454191a36_1758459056257"}
{"timestamp":"2025-09-21T12:59:15.104Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min5_1758459555096","minute_requested":5,"minutes_already_billed":4,"attempt_id":"cb16e5f9-a566-4e2b-8d76-285f287d0a4e"}
{"timestamp":"2025-09-21T12:59:15.104Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min5_1758459555096","attempt_id":"cb16e5f9-a566-4e2b-8d76-285f287d0a4e","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":6,"minutes_already_billed":4,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-21T12:59:15.104Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min5_1758459555096","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":6,"expected_balance_after":5,"minute_to_bill":5}
{"timestamp":"2025-09-21T12:59:15.106Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min5_1758459555096","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-21T12:59:15.108Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min5_1758459555096","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":6,"new_balance":5,"change":-1}
{"timestamp":"2025-09-21T12:59:15.108Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min5_1758459555096","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":5,"minute":5}
{"timestamp":"2025-09-21T12:59:15.110Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min5_1758459555096","transaction_id":"1ed454de-3e33-4e37-a72f-d285177e1958","transaction_type":"DEBIT","balance_after":5}
{"timestamp":"2025-09-21T12:59:15.110Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min5_1758459555096","attempt_id":"cb16e5f9-a566-4e2b-8d76-285f287d0a4e","new_minutes_billed":5,"new_duration_seconds":300}
{"timestamp":"2025-09-21T12:59:15.112Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min5_1758459555096","attempt_id":"cb16e5f9-a566-4e2b-8d76-285f287d0a4e","minutes_billed":5}
{"timestamp":"2025-09-21T12:59:15.113Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min5_1758459555096","transaction_duration_ms":9,"new_balance":5,"minute_billed":5,"total_minutes_billed_this_attempt":5,"total_successful":15,"total_minutes_billed_all_time":15,"avg_transaction_time":"17.87"}
{"timestamp":"2025-09-21T12:59:15.114Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min5_1758459555096","total_duration_ms":18,"transaction_duration_ms":9,"response":{"status":"continue","creditsRemaining":5,"minuteBilled":5,"totalMinutesBilled":5,"attemptId":"cb16e5f9-a566-4e2b-8d76-285f287d0a4e","shouldTerminate":false}}
{"timestamp":"2025-09-21T13:00:15.117796","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min6_1758459615122","correlation_token":"sim_b8d76b9b0b56946a3bdc7bd454191a36_1758459056257","conversation_id":"0ae31958-f6c6-42d2-9e7a-99911534fb36","minute":6,"metrics_total_requests":17}
{"timestamp":"2025-09-21T13:00:15.122Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min6_1758459615122","correlation_token":"sim_b8d76b9b0b56946a3bdc7bd454191a36_1758459056257"}
{"timestamp":"2025-09-21T13:00:15.137Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min6_1758459615122","minute_requested":6,"minutes_already_billed":5,"attempt_id":"cb16e5f9-a566-4e2b-8d76-285f287d0a4e"}
{"timestamp":"2025-09-21T13:00:15.137Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min6_1758459615122","attempt_id":"cb16e5f9-a566-4e2b-8d76-285f287d0a4e","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":5,"minutes_already_billed":5,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-21T13:00:15.137Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min6_1758459615122","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":5,"expected_balance_after":4,"minute_to_bill":6}
{"timestamp":"2025-09-21T13:00:15.142Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min6_1758459615122","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-21T13:00:15.145Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min6_1758459615122","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":5,"new_balance":4,"change":-1}
{"timestamp":"2025-09-21T13:00:15.145Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min6_1758459615122","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":4,"minute":6}
{"timestamp":"2025-09-21T13:00:15.147Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min6_1758459615122","transaction_id":"4e1ae6c9-3b38-4dc8-8970-80d343f27221","transaction_type":"DEBIT","balance_after":4}
{"timestamp":"2025-09-21T13:00:15.148Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min6_1758459615122","attempt_id":"cb16e5f9-a566-4e2b-8d76-285f287d0a4e","new_minutes_billed":6,"new_duration_seconds":360}
{"timestamp":"2025-09-21T13:00:15.150Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min6_1758459615122","attempt_id":"cb16e5f9-a566-4e2b-8d76-285f287d0a4e","minutes_billed":6}
{"timestamp":"2025-09-21T13:00:15.151Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min6_1758459615122","transaction_duration_ms":14,"new_balance":4,"minute_billed":6,"total_minutes_billed_this_attempt":6,"total_successful":16,"total_minutes_billed_all_time":16,"avg_transaction_time":"17.63"}
{"timestamp":"2025-09-21T13:00:15.151Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min6_1758459615122","total_duration_ms":29,"transaction_duration_ms":14,"response":{"status":"continue","creditsRemaining":4,"minuteBilled":6,"totalMinutesBilled":6,"attemptId":"cb16e5f9-a566-4e2b-8d76-285f287d0a4e","shouldTerminate":false}}
{"timestamp":"2025-09-21T13:00:20.826814","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min7_1758459620829","correlation_token":"sim_b8d76b9b0b56946a3bdc7bd454191a36_1758459056257","conversation_id":"0ae31958-f6c6-42d2-9e7a-99911534fb36","minute":7,"metrics_total_requests":18}
{"timestamp":"2025-09-21T13:00:20.829Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min7_1758459620829","correlation_token":"sim_b8d76b9b0b56946a3bdc7bd454191a36_1758459056257"}
{"timestamp":"2025-09-21T13:00:20.837Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min7_1758459620829","minute_requested":7,"minutes_already_billed":6,"attempt_id":"cb16e5f9-a566-4e2b-8d76-285f287d0a4e"}
{"timestamp":"2025-09-21T13:00:20.837Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min7_1758459620829","attempt_id":"cb16e5f9-a566-4e2b-8d76-285f287d0a4e","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":4,"minutes_already_billed":6,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-21T13:00:20.837Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min7_1758459620829","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":4,"expected_balance_after":3,"minute_to_bill":7}
{"timestamp":"2025-09-21T13:00:20.841Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min7_1758459620829","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-21T13:00:20.844Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min7_1758459620829","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":4,"new_balance":3,"change":-1}
{"timestamp":"2025-09-21T13:00:20.844Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min7_1758459620829","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":3,"minute":7}
{"timestamp":"2025-09-21T13:00:20.846Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min7_1758459620829","transaction_id":"babec30c-39c2-4587-bff8-4fd6230b2ab4","transaction_type":"DEBIT","balance_after":3}
{"timestamp":"2025-09-21T13:00:20.846Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min7_1758459620829","attempt_id":"cb16e5f9-a566-4e2b-8d76-285f287d0a4e","new_minutes_billed":7,"new_duration_seconds":420}
{"timestamp":"2025-09-21T13:00:20.848Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min7_1758459620829","attempt_id":"cb16e5f9-a566-4e2b-8d76-285f287d0a4e","minutes_billed":7}
{"timestamp":"2025-09-21T13:00:20.849Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min7_1758459620829","transaction_duration_ms":12,"new_balance":3,"minute_billed":7,"total_minutes_billed_this_attempt":7,"total_successful":17,"total_minutes_billed_all_time":17,"avg_transaction_time":"17.29"}
{"timestamp":"2025-09-21T13:00:20.849Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_0ae31958-f6c6-42d2-9e7a-99911534fb36_min7_1758459620829","total_duration_ms":20,"transaction_duration_ms":12,"response":{"status":"continue","creditsRemaining":3,"minuteBilled":7,"totalMinutesBilled":7,"attemptId":"cb16e5f9-a566-4e2b-8d76-285f287d0a4e","shouldTerminate":false}}
{"timestamp":"2025-09-21T13:04:10.325185","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_00052a58-b53c-4bb6-b2c2-c43f4aa3cc09_min1_1758459850327","correlation_token":"sim_592915840ce4be9191c4989787516ed7_1758459789973","conversation_id":"00052a58-b53c-4bb6-b2c2-c43f4aa3cc09","minute":1,"metrics_total_requests":19}
{"timestamp":"2025-09-21T13:04:10.328Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_00052a58-b53c-4bb6-b2c2-c43f4aa3cc09_min1_1758459850327","correlation_token":"sim_592915840ce4be9191c4989787516ed7_1758459789973"}
{"timestamp":"2025-09-21T13:04:10.338Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_00052a58-b53c-4bb6-b2c2-c43f4aa3cc09_min1_1758459850327","minute_requested":1,"minutes_already_billed":0,"attempt_id":"307141d9-0e15-4770-a9e7-619b4bd67fe7"}
{"timestamp":"2025-09-21T13:04:10.338Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_00052a58-b53c-4bb6-b2c2-c43f4aa3cc09_min1_1758459850327","attempt_id":"307141d9-0e15-4770-a9e7-619b4bd67fe7","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":3,"minutes_already_billed":0,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-21T13:04:10.338Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_00052a58-b53c-4bb6-b2c2-c43f4aa3cc09_min1_1758459850327","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":3,"expected_balance_after":2,"minute_to_bill":1}
{"timestamp":"2025-09-21T13:04:10.342Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_00052a58-b53c-4bb6-b2c2-c43f4aa3cc09_min1_1758459850327","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-21T13:04:10.345Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_00052a58-b53c-4bb6-b2c2-c43f4aa3cc09_min1_1758459850327","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":3,"new_balance":2,"change":-1}
{"timestamp":"2025-09-21T13:04:10.345Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_00052a58-b53c-4bb6-b2c2-c43f4aa3cc09_min1_1758459850327","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":2,"minute":1}
{"timestamp":"2025-09-21T13:04:10.347Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_00052a58-b53c-4bb6-b2c2-c43f4aa3cc09_min1_1758459850327","transaction_id":"86844dbb-98af-42b1-bf54-80eb2b45ab8a","transaction_type":"DEBIT","balance_after":2}
{"timestamp":"2025-09-21T13:04:10.347Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_00052a58-b53c-4bb6-b2c2-c43f4aa3cc09_min1_1758459850327","attempt_id":"307141d9-0e15-4770-a9e7-619b4bd67fe7","new_minutes_billed":1,"new_duration_seconds":60}
{"timestamp":"2025-09-21T13:04:10.349Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_00052a58-b53c-4bb6-b2c2-c43f4aa3cc09_min1_1758459850327","attempt_id":"307141d9-0e15-4770-a9e7-619b4bd67fe7","minutes_billed":1}
{"timestamp":"2025-09-21T13:04:10.351Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_00052a58-b53c-4bb6-b2c2-c43f4aa3cc09_min1_1758459850327","transaction_duration_ms":13,"new_balance":2,"minute_billed":1,"total_minutes_billed_this_attempt":1,"total_successful":18,"total_minutes_billed_all_time":18,"avg_transaction_time":"17.06"}
{"timestamp":"2025-09-21T13:04:10.351Z","level":"WARN","service":"BillingService","message":"Low credits warning threshold reached","requestId":"bill_00052a58-b53c-4bb6-b2c2-c43f4aa3cc09_min1_1758459850327","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","credits_remaining":2,"minute_billed":1,"warning_threshold":2}
{"timestamp":"2025-09-21T13:04:10.351Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_00052a58-b53c-4bb6-b2c2-c43f4aa3cc09_min1_1758459850327","total_duration_ms":24,"transaction_duration_ms":13,"response":{"status":"warning","creditsRemaining":2,"minuteBilled":1,"totalMinutesBilled":1,"attemptId":"307141d9-0e15-4770-a9e7-619b4bd67fe7","shouldTerminate":false,"message":"Low credits warning: 2 minute(s) remaining"}}
{"timestamp":"2025-09-21T13:05:10.357253","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_00052a58-b53c-4bb6-b2c2-c43f4aa3cc09_min2_1758459910363","correlation_token":"sim_592915840ce4be9191c4989787516ed7_1758459789973","conversation_id":"00052a58-b53c-4bb6-b2c2-c43f4aa3cc09","minute":2,"metrics_total_requests":20}
{"timestamp":"2025-09-21T13:05:10.363Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_00052a58-b53c-4bb6-b2c2-c43f4aa3cc09_min2_1758459910363","correlation_token":"sim_592915840ce4be9191c4989787516ed7_1758459789973"}
{"timestamp":"2025-09-21T13:05:10.378Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_00052a58-b53c-4bb6-b2c2-c43f4aa3cc09_min2_1758459910363","minute_requested":2,"minutes_already_billed":1,"attempt_id":"307141d9-0e15-4770-a9e7-619b4bd67fe7"}
{"timestamp":"2025-09-21T13:05:10.378Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_00052a58-b53c-4bb6-b2c2-c43f4aa3cc09_min2_1758459910363","attempt_id":"307141d9-0e15-4770-a9e7-619b4bd67fe7","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":2,"minutes_already_billed":1,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-21T13:05:10.378Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_00052a58-b53c-4bb6-b2c2-c43f4aa3cc09_min2_1758459910363","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":2,"expected_balance_after":1,"minute_to_bill":2}
{"timestamp":"2025-09-21T13:05:10.381Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_00052a58-b53c-4bb6-b2c2-c43f4aa3cc09_min2_1758459910363","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-21T13:05:10.384Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_00052a58-b53c-4bb6-b2c2-c43f4aa3cc09_min2_1758459910363","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":2,"new_balance":1,"change":-1}
{"timestamp":"2025-09-21T13:05:10.384Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_00052a58-b53c-4bb6-b2c2-c43f4aa3cc09_min2_1758459910363","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":1,"minute":2}
{"timestamp":"2025-09-21T13:05:10.387Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_00052a58-b53c-4bb6-b2c2-c43f4aa3cc09_min2_1758459910363","transaction_id":"ff63fa7a-642d-4834-97c7-c32d80038fa3","transaction_type":"DEBIT","balance_after":1}
{"timestamp":"2025-09-21T13:05:10.387Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_00052a58-b53c-4bb6-b2c2-c43f4aa3cc09_min2_1758459910363","attempt_id":"307141d9-0e15-4770-a9e7-619b4bd67fe7","new_minutes_billed":2,"new_duration_seconds":120}
{"timestamp":"2025-09-21T13:05:10.390Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_00052a58-b53c-4bb6-b2c2-c43f4aa3cc09_min2_1758459910363","attempt_id":"307141d9-0e15-4770-a9e7-619b4bd67fe7","minutes_billed":2}
{"timestamp":"2025-09-21T13:05:10.392Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_00052a58-b53c-4bb6-b2c2-c43f4aa3cc09_min2_1758459910363","transaction_duration_ms":14,"new_balance":1,"minute_billed":2,"total_minutes_billed_this_attempt":2,"total_successful":19,"total_minutes_billed_all_time":19,"avg_transaction_time":"16.89"}
{"timestamp":"2025-09-21T13:05:10.392Z","level":"WARN","service":"BillingService","message":"Low credits warning threshold reached","requestId":"bill_00052a58-b53c-4bb6-b2c2-c43f4aa3cc09_min2_1758459910363","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","credits_remaining":1,"minute_billed":2,"warning_threshold":2}
{"timestamp":"2025-09-21T13:05:10.392Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_00052a58-b53c-4bb6-b2c2-c43f4aa3cc09_min2_1758459910363","total_duration_ms":29,"transaction_duration_ms":14,"response":{"status":"warning","creditsRemaining":1,"minuteBilled":2,"totalMinutesBilled":2,"attemptId":"307141d9-0e15-4770-a9e7-619b4bd67fe7","shouldTerminate":false,"message":"Low credits warning: 1 minute(s) remaining"}}
{"timestamp":"2025-09-21T13:06:10.396155","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_00052a58-b53c-4bb6-b2c2-c43f4aa3cc09_min3_1758459970402","correlation_token":"sim_592915840ce4be9191c4989787516ed7_1758459789973","conversation_id":"00052a58-b53c-4bb6-b2c2-c43f4aa3cc09","minute":3,"metrics_total_requests":21}
{"timestamp":"2025-09-21T13:06:10.402Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_00052a58-b53c-4bb6-b2c2-c43f4aa3cc09_min3_1758459970402","correlation_token":"sim_592915840ce4be9191c4989787516ed7_1758459789973"}
{"timestamp":"2025-09-21T13:06:10.416Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_00052a58-b53c-4bb6-b2c2-c43f4aa3cc09_min3_1758459970402","minute_requested":3,"minutes_already_billed":2,"attempt_id":"307141d9-0e15-4770-a9e7-619b4bd67fe7"}
{"timestamp":"2025-09-21T13:06:10.416Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_00052a58-b53c-4bb6-b2c2-c43f4aa3cc09_min3_1758459970402","attempt_id":"307141d9-0e15-4770-a9e7-619b4bd67fe7","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":1,"minutes_already_billed":2,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-21T13:06:10.416Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_00052a58-b53c-4bb6-b2c2-c43f4aa3cc09_min3_1758459970402","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":1,"expected_balance_after":0,"minute_to_bill":3}
{"timestamp":"2025-09-21T13:06:10.421Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_00052a58-b53c-4bb6-b2c2-c43f4aa3cc09_min3_1758459970402","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-21T13:06:10.424Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_00052a58-b53c-4bb6-b2c2-c43f4aa3cc09_min3_1758459970402","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":1,"new_balance":0,"change":-1}
{"timestamp":"2025-09-21T13:06:10.424Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_00052a58-b53c-4bb6-b2c2-c43f4aa3cc09_min3_1758459970402","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":0,"minute":3}
{"timestamp":"2025-09-21T13:06:10.428Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_00052a58-b53c-4bb6-b2c2-c43f4aa3cc09_min3_1758459970402","transaction_id":"58d687b6-82af-4fb0-b73c-e9e8e242c113","transaction_type":"DEBIT","balance_after":0}
{"timestamp":"2025-09-21T13:06:10.428Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_00052a58-b53c-4bb6-b2c2-c43f4aa3cc09_min3_1758459970402","attempt_id":"307141d9-0e15-4770-a9e7-619b4bd67fe7","new_minutes_billed":3,"new_duration_seconds":180}
{"timestamp":"2025-09-21T13:06:10.431Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_00052a58-b53c-4bb6-b2c2-c43f4aa3cc09_min3_1758459970402","attempt_id":"307141d9-0e15-4770-a9e7-619b4bd67fe7","minutes_billed":3}
{"timestamp":"2025-09-21T13:06:10.433Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_00052a58-b53c-4bb6-b2c2-c43f4aa3cc09_min3_1758459970402","transaction_duration_ms":17,"new_balance":0,"minute_billed":3,"total_minutes_billed_this_attempt":3,"total_successful":20,"total_minutes_billed_all_time":20,"avg_transaction_time":"16.90"}
{"timestamp":"2025-09-21T13:06:10.433Z","level":"WARN","service":"BillingService","message":"Last credit used - will terminate conversation","requestId":"bill_00052a58-b53c-4bb6-b2c2-c43f4aa3cc09_min3_1758459970402","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","minute_billed":3,"total_minutes_this_session":3}
{"timestamp":"2025-09-21T13:06:10.433Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_00052a58-b53c-4bb6-b2c2-c43f4aa3cc09_min3_1758459970402","total_duration_ms":31,"transaction_duration_ms":17,"response":{"status":"terminate","creditsRemaining":0,"minuteBilled":3,"totalMinutesBilled":3,"attemptId":"307141d9-0e15-4770-a9e7-619b4bd67fe7","shouldTerminate":true,"message":"Last credit used - conversation will end","gracePeriodSeconds":60}}
{"timestamp":"2025-09-21T13:07:10.438119","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_00052a58-b53c-4bb6-b2c2-c43f4aa3cc09_min5_1758460030440","correlation_token":"sim_592915840ce4be9191c4989787516ed7_1758459789973","conversation_id":"00052a58-b53c-4bb6-b2c2-c43f4aa3cc09","minute":5,"metrics_total_requests":22}
{"timestamp":"2025-09-21T13:07:10.440Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_00052a58-b53c-4bb6-b2c2-c43f4aa3cc09_min5_1758460030440","correlation_token":"sim_592915840ce4be9191c4989787516ed7_1758459789973"}
{"timestamp":"2025-09-21T13:07:10.446Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_00052a58-b53c-4bb6-b2c2-c43f4aa3cc09_min5_1758460030440","minute_requested":5,"minutes_already_billed":3,"attempt_id":"307141d9-0e15-4770-a9e7-619b4bd67fe7"}
{"timestamp":"2025-09-21T13:07:10.447Z","level":"WARN","service":"BillingService","message":"Non-sequential minute billing detected","requestId":"bill_00052a58-b53c-4bb6-b2c2-c43f4aa3cc09_min5_1758460030440","minute_requested":5,"expected_minute":4,"gap":1,"attempt_id":"307141d9-0e15-4770-a9e7-619b4bd67fe7"}
{"timestamp":"2025-09-21T13:07:10.447Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_00052a58-b53c-4bb6-b2c2-c43f4aa3cc09_min5_1758460030440","attempt_id":"307141d9-0e15-4770-a9e7-619b4bd67fe7","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":0,"minutes_already_billed":3,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-21T13:07:10.447Z","level":"WARN","service":"BillingService","message":"Insufficient credits detected","requestId":"bill_00052a58-b53c-4bb6-b2c2-c43f4aa3cc09_min5_1758460030440","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_email":"john.doe@example.com","current_balance":0,"required":1,"minutes_billed":3,"total_insufficient_events":2}
{"timestamp":"2025-09-21T13:08:35.535659","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min1_1758460115540","correlation_token":"sim_cb32ed92769159a690dae36c671c52c5_1758460055192","conversation_id":"fd9ce2ca-1aca-4561-ad67-326f3bbc3a63","minute":1,"metrics_total_requests":23}
{"timestamp":"2025-09-21T13:08:35.540Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min1_1758460115540","correlation_token":"sim_cb32ed92769159a690dae36c671c52c5_1758460055192"}
{"timestamp":"2025-09-21T13:08:35.554Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min1_1758460115540","minute_requested":1,"minutes_already_billed":0,"attempt_id":"ad2b4566-8a89-47e5-bbf2-126728fef650"}
{"timestamp":"2025-09-21T13:08:35.554Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min1_1758460115540","attempt_id":"ad2b4566-8a89-47e5-bbf2-126728fef650","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":10,"minutes_already_billed":0,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-21T13:08:35.554Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min1_1758460115540","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":10,"expected_balance_after":9,"minute_to_bill":1}
{"timestamp":"2025-09-21T13:08:35.559Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min1_1758460115540","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-21T13:08:35.562Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min1_1758460115540","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":10,"new_balance":9,"change":-1}
{"timestamp":"2025-09-21T13:08:35.562Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min1_1758460115540","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":9,"minute":1}
{"timestamp":"2025-09-21T13:08:35.565Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min1_1758460115540","transaction_id":"e1cc3f21-6a71-43b0-923d-65e44cfbd28f","transaction_type":"DEBIT","balance_after":9}
{"timestamp":"2025-09-21T13:08:35.565Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min1_1758460115540","attempt_id":"ad2b4566-8a89-47e5-bbf2-126728fef650","new_minutes_billed":1,"new_duration_seconds":60}
{"timestamp":"2025-09-21T13:08:35.567Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min1_1758460115540","attempt_id":"ad2b4566-8a89-47e5-bbf2-126728fef650","minutes_billed":1}
{"timestamp":"2025-09-21T13:08:35.569Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min1_1758460115540","transaction_duration_ms":15,"new_balance":9,"minute_billed":1,"total_minutes_billed_this_attempt":1,"total_successful":21,"total_minutes_billed_all_time":21,"avg_transaction_time":"16.81"}
{"timestamp":"2025-09-21T13:08:35.569Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min1_1758460115540","total_duration_ms":29,"transaction_duration_ms":15,"response":{"status":"continue","creditsRemaining":9,"minuteBilled":1,"totalMinutesBilled":1,"attemptId":"ad2b4566-8a89-47e5-bbf2-126728fef650","shouldTerminate":false}}
{"timestamp":"2025-09-21T13:09:35.573909","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min2_1758460175578","correlation_token":"sim_cb32ed92769159a690dae36c671c52c5_1758460055192","conversation_id":"fd9ce2ca-1aca-4561-ad67-326f3bbc3a63","minute":2,"metrics_total_requests":24}
{"timestamp":"2025-09-21T13:09:35.578Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min2_1758460175578","correlation_token":"sim_cb32ed92769159a690dae36c671c52c5_1758460055192"}
{"timestamp":"2025-09-21T13:09:35.596Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min2_1758460175578","minute_requested":2,"minutes_already_billed":1,"attempt_id":"ad2b4566-8a89-47e5-bbf2-126728fef650"}
{"timestamp":"2025-09-21T13:09:35.596Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min2_1758460175578","attempt_id":"ad2b4566-8a89-47e5-bbf2-126728fef650","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":9,"minutes_already_billed":1,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-21T13:09:35.596Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min2_1758460175578","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":9,"expected_balance_after":8,"minute_to_bill":2}
{"timestamp":"2025-09-21T13:09:35.601Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min2_1758460175578","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-21T13:09:35.604Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min2_1758460175578","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":9,"new_balance":8,"change":-1}
{"timestamp":"2025-09-21T13:09:35.604Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min2_1758460175578","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":8,"minute":2}
{"timestamp":"2025-09-21T13:09:35.609Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min2_1758460175578","transaction_id":"24035665-b306-4f4f-b620-54cd7f4a18aa","transaction_type":"DEBIT","balance_after":8}
{"timestamp":"2025-09-21T13:09:35.609Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min2_1758460175578","attempt_id":"ad2b4566-8a89-47e5-bbf2-126728fef650","new_minutes_billed":2,"new_duration_seconds":120}
{"timestamp":"2025-09-21T13:09:35.612Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min2_1758460175578","attempt_id":"ad2b4566-8a89-47e5-bbf2-126728fef650","minutes_billed":2}
{"timestamp":"2025-09-21T13:09:35.614Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min2_1758460175578","transaction_duration_ms":18,"new_balance":8,"minute_billed":2,"total_minutes_billed_this_attempt":2,"total_successful":22,"total_minutes_billed_all_time":22,"avg_transaction_time":"16.86"}
{"timestamp":"2025-09-21T13:09:35.614Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min2_1758460175578","total_duration_ms":36,"transaction_duration_ms":18,"response":{"status":"continue","creditsRemaining":8,"minuteBilled":2,"totalMinutesBilled":2,"attemptId":"ad2b4566-8a89-47e5-bbf2-126728fef650","shouldTerminate":false}}
{"timestamp":"2025-09-21T13:10:35.617492","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min3_1758460235623","correlation_token":"sim_cb32ed92769159a690dae36c671c52c5_1758460055192","conversation_id":"fd9ce2ca-1aca-4561-ad67-326f3bbc3a63","minute":3,"metrics_total_requests":25}
{"timestamp":"2025-09-21T13:10:35.624Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min3_1758460235623","correlation_token":"sim_cb32ed92769159a690dae36c671c52c5_1758460055192"}
{"timestamp":"2025-09-21T13:10:35.638Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min3_1758460235623","minute_requested":3,"minutes_already_billed":2,"attempt_id":"ad2b4566-8a89-47e5-bbf2-126728fef650"}
{"timestamp":"2025-09-21T13:10:35.639Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min3_1758460235623","attempt_id":"ad2b4566-8a89-47e5-bbf2-126728fef650","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":8,"minutes_already_billed":2,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-21T13:10:35.639Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min3_1758460235623","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":8,"expected_balance_after":7,"minute_to_bill":3}
{"timestamp":"2025-09-21T13:10:35.642Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min3_1758460235623","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-21T13:10:35.645Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min3_1758460235623","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":8,"new_balance":7,"change":-1}
{"timestamp":"2025-09-21T13:10:35.645Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min3_1758460235623","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":7,"minute":3}
{"timestamp":"2025-09-21T13:10:35.647Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min3_1758460235623","transaction_id":"e8407050-6add-4d3a-ad39-7368b5412005","transaction_type":"DEBIT","balance_after":7}
{"timestamp":"2025-09-21T13:10:35.647Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min3_1758460235623","attempt_id":"ad2b4566-8a89-47e5-bbf2-126728fef650","new_minutes_billed":3,"new_duration_seconds":180}
{"timestamp":"2025-09-21T13:10:35.653Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min3_1758460235623","attempt_id":"ad2b4566-8a89-47e5-bbf2-126728fef650","minutes_billed":3}
{"timestamp":"2025-09-21T13:10:35.655Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min3_1758460235623","transaction_duration_ms":16,"new_balance":7,"minute_billed":3,"total_minutes_billed_this_attempt":3,"total_successful":23,"total_minutes_billed_all_time":23,"avg_transaction_time":"16.83"}
{"timestamp":"2025-09-21T13:10:35.655Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min3_1758460235623","total_duration_ms":32,"transaction_duration_ms":16,"response":{"status":"continue","creditsRemaining":7,"minuteBilled":3,"totalMinutesBilled":3,"attemptId":"ad2b4566-8a89-47e5-bbf2-126728fef650","shouldTerminate":false}}
{"timestamp":"2025-09-21T13:11:35.659215","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min4_1758460295668","correlation_token":"sim_cb32ed92769159a690dae36c671c52c5_1758460055192","conversation_id":"fd9ce2ca-1aca-4561-ad67-326f3bbc3a63","minute":4,"metrics_total_requests":26}
{"timestamp":"2025-09-21T13:11:35.668Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min4_1758460295668","correlation_token":"sim_cb32ed92769159a690dae36c671c52c5_1758460055192"}
{"timestamp":"2025-09-21T13:11:35.680Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min4_1758460295668","minute_requested":4,"minutes_already_billed":3,"attempt_id":"ad2b4566-8a89-47e5-bbf2-126728fef650"}
{"timestamp":"2025-09-21T13:11:35.680Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min4_1758460295668","attempt_id":"ad2b4566-8a89-47e5-bbf2-126728fef650","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":7,"minutes_already_billed":3,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-21T13:11:35.680Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min4_1758460295668","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":7,"expected_balance_after":6,"minute_to_bill":4}
{"timestamp":"2025-09-21T13:11:35.684Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min4_1758460295668","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-21T13:11:35.687Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min4_1758460295668","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":7,"new_balance":6,"change":-1}
{"timestamp":"2025-09-21T13:11:35.687Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min4_1758460295668","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":6,"minute":4}
{"timestamp":"2025-09-21T13:11:35.689Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min4_1758460295668","transaction_id":"31cb10cc-ce9b-4471-9e8f-b8dc3e435dba","transaction_type":"DEBIT","balance_after":6}
{"timestamp":"2025-09-21T13:11:35.689Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min4_1758460295668","attempt_id":"ad2b4566-8a89-47e5-bbf2-126728fef650","new_minutes_billed":4,"new_duration_seconds":240}
{"timestamp":"2025-09-21T13:11:35.691Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min4_1758460295668","attempt_id":"ad2b4566-8a89-47e5-bbf2-126728fef650","minutes_billed":4}
{"timestamp":"2025-09-21T13:11:35.693Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min4_1758460295668","transaction_duration_ms":13,"new_balance":6,"minute_billed":4,"total_minutes_billed_this_attempt":4,"total_successful":24,"total_minutes_billed_all_time":24,"avg_transaction_time":"16.67"}
{"timestamp":"2025-09-21T13:11:35.693Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min4_1758460295668","total_duration_ms":25,"transaction_duration_ms":13,"response":{"status":"continue","creditsRemaining":6,"minuteBilled":4,"totalMinutesBilled":4,"attemptId":"ad2b4566-8a89-47e5-bbf2-126728fef650","shouldTerminate":false}}
{"timestamp":"2025-09-21T13:12:35.695132","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min5_1758460355716","correlation_token":"sim_cb32ed92769159a690dae36c671c52c5_1758460055192","conversation_id":"fd9ce2ca-1aca-4561-ad67-326f3bbc3a63","minute":5,"metrics_total_requests":27}
{"timestamp":"2025-09-21T13:12:35.716Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min5_1758460355716","correlation_token":"sim_cb32ed92769159a690dae36c671c52c5_1758460055192"}
{"timestamp":"2025-09-21T13:12:35.729Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min5_1758460355716","minute_requested":5,"minutes_already_billed":4,"attempt_id":"ad2b4566-8a89-47e5-bbf2-126728fef650"}
{"timestamp":"2025-09-21T13:12:35.729Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min5_1758460355716","attempt_id":"ad2b4566-8a89-47e5-bbf2-126728fef650","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":6,"minutes_already_billed":4,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-21T13:12:35.729Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min5_1758460355716","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":6,"expected_balance_after":5,"minute_to_bill":5}
{"timestamp":"2025-09-21T13:12:35.737Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min5_1758460355716","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-21T13:12:35.740Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min5_1758460355716","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":6,"new_balance":5,"change":-1}
{"timestamp":"2025-09-21T13:12:35.740Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min5_1758460355716","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":5,"minute":5}
{"timestamp":"2025-09-21T13:12:35.744Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min5_1758460355716","transaction_id":"d2d4faae-6432-4caf-86d4-1880e55b65b5","transaction_type":"DEBIT","balance_after":5}
{"timestamp":"2025-09-21T13:12:35.745Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min5_1758460355716","attempt_id":"ad2b4566-8a89-47e5-bbf2-126728fef650","new_minutes_billed":5,"new_duration_seconds":300}
{"timestamp":"2025-09-21T13:12:35.751Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min5_1758460355716","attempt_id":"ad2b4566-8a89-47e5-bbf2-126728fef650","minutes_billed":5}
{"timestamp":"2025-09-21T13:12:35.753Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min5_1758460355716","transaction_duration_ms":24,"new_balance":5,"minute_billed":5,"total_minutes_billed_this_attempt":5,"total_successful":25,"total_minutes_billed_all_time":25,"avg_transaction_time":"16.96"}
{"timestamp":"2025-09-21T13:12:35.753Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min5_1758460355716","total_duration_ms":37,"transaction_duration_ms":24,"response":{"status":"continue","creditsRemaining":5,"minuteBilled":5,"totalMinutesBilled":5,"attemptId":"ad2b4566-8a89-47e5-bbf2-126728fef650","shouldTerminate":false}}
{"timestamp":"2025-09-21T13:17:28.882013","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min6_1758460648933","correlation_token":"sim_cb32ed92769159a690dae36c671c52c5_1758460055192","conversation_id":"fd9ce2ca-1aca-4561-ad67-326f3bbc3a63","minute":6,"metrics_total_requests":28}
{"timestamp":"2025-09-21T13:17:28.933Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min6_1758460648933","correlation_token":"sim_cb32ed92769159a690dae36c671c52c5_1758460055192"}
{"timestamp":"2025-09-21T13:17:28.943Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min6_1758460648933","minute_requested":6,"minutes_already_billed":5,"attempt_id":"ad2b4566-8a89-47e5-bbf2-126728fef650"}
{"timestamp":"2025-09-21T13:17:28.943Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min6_1758460648933","attempt_id":"ad2b4566-8a89-47e5-bbf2-126728fef650","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":5,"minutes_already_billed":5,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-21T13:17:28.943Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min6_1758460648933","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":5,"expected_balance_after":4,"minute_to_bill":6}
{"timestamp":"2025-09-21T13:17:28.946Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min6_1758460648933","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-21T13:17:28.948Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min6_1758460648933","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":5,"new_balance":4,"change":-1}
{"timestamp":"2025-09-21T13:17:28.948Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min6_1758460648933","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":4,"minute":6}
{"timestamp":"2025-09-21T13:17:28.951Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min6_1758460648933","transaction_id":"3fdbbbde-d455-419a-af99-38e58eff2ac4","transaction_type":"DEBIT","balance_after":4}
{"timestamp":"2025-09-21T13:17:28.951Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min6_1758460648933","attempt_id":"ad2b4566-8a89-47e5-bbf2-126728fef650","new_minutes_billed":6,"new_duration_seconds":360}
{"timestamp":"2025-09-21T13:17:29.024Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min6_1758460648933","attempt_id":"ad2b4566-8a89-47e5-bbf2-126728fef650","minutes_billed":6}
{"timestamp":"2025-09-21T13:17:29.027Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min6_1758460648933","transaction_duration_ms":84,"new_balance":4,"minute_billed":6,"total_minutes_billed_this_attempt":6,"total_successful":26,"total_minutes_billed_all_time":26,"avg_transaction_time":"19.54"}
{"timestamp":"2025-09-21T13:17:29.027Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min6_1758460648933","total_duration_ms":94,"transaction_duration_ms":84,"response":{"status":"continue","creditsRemaining":4,"minuteBilled":6,"totalMinutesBilled":6,"attemptId":"ad2b4566-8a89-47e5-bbf2-126728fef650","shouldTerminate":false}}
{"timestamp":"2025-09-21T13:33:27.226117","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min26_1758461607230","correlation_token":"sim_cb32ed92769159a690dae36c671c52c5_1758460055192","conversation_id":"fd9ce2ca-1aca-4561-ad67-326f3bbc3a63","minute":26,"metrics_total_requests":29}
{"timestamp":"2025-09-21T13:33:27.231Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min26_1758461607230","correlation_token":"sim_cb32ed92769159a690dae36c671c52c5_1758460055192"}
{"timestamp":"2025-09-21T13:33:27.268Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min26_1758461607230","minute_requested":26,"minutes_already_billed":6,"attempt_id":"ad2b4566-8a89-47e5-bbf2-126728fef650"}
{"timestamp":"2025-09-21T13:33:27.268Z","level":"WARN","service":"BillingService","message":"Non-sequential minute billing detected","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min26_1758461607230","minute_requested":26,"expected_minute":7,"gap":19,"attempt_id":"ad2b4566-8a89-47e5-bbf2-126728fef650"}
{"timestamp":"2025-09-21T13:33:27.268Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min26_1758461607230","attempt_id":"ad2b4566-8a89-47e5-bbf2-126728fef650","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":4,"minutes_already_billed":6,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-21T13:33:27.268Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min26_1758461607230","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":4,"expected_balance_after":3,"minute_to_bill":26}
{"timestamp":"2025-09-21T13:33:27.274Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min26_1758461607230","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-21T13:33:27.277Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min26_1758461607230","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":4,"new_balance":3,"change":-1}
{"timestamp":"2025-09-21T13:33:27.277Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min26_1758461607230","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":3,"minute":26}
{"timestamp":"2025-09-21T13:33:27.280Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min26_1758461607230","transaction_id":"6baf8425-d745-4fbf-b94d-39e227f11455","transaction_type":"DEBIT","balance_after":3}
{"timestamp":"2025-09-21T13:33:27.280Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min26_1758461607230","attempt_id":"ad2b4566-8a89-47e5-bbf2-126728fef650","new_minutes_billed":26,"new_duration_seconds":1560}
{"timestamp":"2025-09-21T13:33:27.283Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min26_1758461607230","attempt_id":"ad2b4566-8a89-47e5-bbf2-126728fef650","minutes_billed":26}
{"timestamp":"2025-09-21T13:33:27.284Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min26_1758461607230","transaction_duration_ms":16,"new_balance":3,"minute_billed":26,"total_minutes_billed_this_attempt":26,"total_successful":27,"total_minutes_billed_all_time":27,"avg_transaction_time":"19.41"}
{"timestamp":"2025-09-21T13:33:27.284Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_fd9ce2ca-1aca-4561-ad67-326f3bbc3a63_min26_1758461607230","total_duration_ms":54,"transaction_duration_ms":16,"response":{"status":"continue","creditsRemaining":3,"minuteBilled":26,"totalMinutesBilled":26,"attemptId":"ad2b4566-8a89-47e5-bbf2-126728fef650","shouldTerminate":false}}
{"timestamp":"2025-09-22T09:30:49.199061","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_3a5545fc-b609-4e66-bb70-c3dd8c9db76a_min1_1758533449210","correlation_token":"sim_6e69cd5253ee50f10f8682ece7c5cda5_1758533375570","conversation_id":"3a5545fc-b609-4e66-bb70-c3dd8c9db76a","minute":1,"metrics_total_requests":30}
{"timestamp":"2025-09-22T09:30:49.211Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_3a5545fc-b609-4e66-bb70-c3dd8c9db76a_min1_1758533449210","correlation_token":"sim_6e69cd5253ee50f10f8682ece7c5cda5_1758533375570"}
{"timestamp":"2025-09-22T09:30:49.230Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_3a5545fc-b609-4e66-bb70-c3dd8c9db76a_min1_1758533449210","minute_requested":1,"minutes_already_billed":0,"attempt_id":"e2332cb3-c9dd-4c96-a641-fcac9e3205e4"}
{"timestamp":"2025-09-22T09:30:49.231Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_3a5545fc-b609-4e66-bb70-c3dd8c9db76a_min1_1758533449210","attempt_id":"e2332cb3-c9dd-4c96-a641-fcac9e3205e4","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":3,"minutes_already_billed":0,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-22T09:30:49.231Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_3a5545fc-b609-4e66-bb70-c3dd8c9db76a_min1_1758533449210","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":3,"expected_balance_after":2,"minute_to_bill":1}
{"timestamp":"2025-09-22T09:30:49.234Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_3a5545fc-b609-4e66-bb70-c3dd8c9db76a_min1_1758533449210","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-22T09:30:49.237Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_3a5545fc-b609-4e66-bb70-c3dd8c9db76a_min1_1758533449210","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":3,"new_balance":2,"change":-1}
{"timestamp":"2025-09-22T09:30:49.237Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_3a5545fc-b609-4e66-bb70-c3dd8c9db76a_min1_1758533449210","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":2,"minute":1}
{"timestamp":"2025-09-22T09:30:49.240Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_3a5545fc-b609-4e66-bb70-c3dd8c9db76a_min1_1758533449210","transaction_id":"7cd5e308-bf33-40e6-804e-c1fce25b174c","transaction_type":"DEBIT","balance_after":2}
{"timestamp":"2025-09-22T09:30:49.240Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_3a5545fc-b609-4e66-bb70-c3dd8c9db76a_min1_1758533449210","attempt_id":"e2332cb3-c9dd-4c96-a641-fcac9e3205e4","new_minutes_billed":1,"new_duration_seconds":60}
{"timestamp":"2025-09-22T09:30:49.242Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_3a5545fc-b609-4e66-bb70-c3dd8c9db76a_min1_1758533449210","attempt_id":"e2332cb3-c9dd-4c96-a641-fcac9e3205e4","minutes_billed":1}
{"timestamp":"2025-09-22T09:30:49.244Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_3a5545fc-b609-4e66-bb70-c3dd8c9db76a_min1_1758533449210","transaction_duration_ms":13,"new_balance":2,"minute_billed":1,"total_minutes_billed_this_attempt":1,"total_successful":28,"total_minutes_billed_all_time":28,"avg_transaction_time":"19.18"}
{"timestamp":"2025-09-22T09:30:49.244Z","level":"WARN","service":"BillingService","message":"Low credits warning threshold reached","requestId":"bill_3a5545fc-b609-4e66-bb70-c3dd8c9db76a_min1_1758533449210","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","credits_remaining":2,"minute_billed":1,"warning_threshold":2}
{"timestamp":"2025-09-22T09:30:49.244Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_3a5545fc-b609-4e66-bb70-c3dd8c9db76a_min1_1758533449210","total_duration_ms":34,"transaction_duration_ms":13,"response":{"status":"warning","creditsRemaining":2,"minuteBilled":1,"totalMinutesBilled":1,"attemptId":"e2332cb3-c9dd-4c96-a641-fcac9e3205e4","shouldTerminate":false,"message":"Low credits warning: 2 minute(s) remaining"}}
{"timestamp":"2025-09-22T09:31:49.247273","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_3a5545fc-b609-4e66-bb70-c3dd8c9db76a_min2_1758533509251","correlation_token":"sim_6e69cd5253ee50f10f8682ece7c5cda5_1758533375570","conversation_id":"3a5545fc-b609-4e66-bb70-c3dd8c9db76a","minute":2,"metrics_total_requests":31}
{"timestamp":"2025-09-22T09:31:49.251Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_3a5545fc-b609-4e66-bb70-c3dd8c9db76a_min2_1758533509251","correlation_token":"sim_6e69cd5253ee50f10f8682ece7c5cda5_1758533375570"}
{"timestamp":"2025-09-22T09:31:49.266Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_3a5545fc-b609-4e66-bb70-c3dd8c9db76a_min2_1758533509251","minute_requested":2,"minutes_already_billed":1,"attempt_id":"e2332cb3-c9dd-4c96-a641-fcac9e3205e4"}
{"timestamp":"2025-09-22T09:31:49.267Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_3a5545fc-b609-4e66-bb70-c3dd8c9db76a_min2_1758533509251","attempt_id":"e2332cb3-c9dd-4c96-a641-fcac9e3205e4","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":2,"minutes_already_billed":1,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-22T09:31:49.267Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_3a5545fc-b609-4e66-bb70-c3dd8c9db76a_min2_1758533509251","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":2,"expected_balance_after":1,"minute_to_bill":2}
{"timestamp":"2025-09-22T09:31:49.269Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_3a5545fc-b609-4e66-bb70-c3dd8c9db76a_min2_1758533509251","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-22T09:31:49.271Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_3a5545fc-b609-4e66-bb70-c3dd8c9db76a_min2_1758533509251","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":2,"new_balance":1,"change":-1}
{"timestamp":"2025-09-22T09:31:49.271Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_3a5545fc-b609-4e66-bb70-c3dd8c9db76a_min2_1758533509251","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":1,"minute":2}
{"timestamp":"2025-09-22T09:31:49.273Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_3a5545fc-b609-4e66-bb70-c3dd8c9db76a_min2_1758533509251","transaction_id":"ad17b674-1fd2-4030-9d92-c2c79f5d13b2","transaction_type":"DEBIT","balance_after":1}
{"timestamp":"2025-09-22T09:31:49.273Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_3a5545fc-b609-4e66-bb70-c3dd8c9db76a_min2_1758533509251","attempt_id":"e2332cb3-c9dd-4c96-a641-fcac9e3205e4","new_minutes_billed":2,"new_duration_seconds":120}
{"timestamp":"2025-09-22T09:31:49.275Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_3a5545fc-b609-4e66-bb70-c3dd8c9db76a_min2_1758533509251","attempt_id":"e2332cb3-c9dd-4c96-a641-fcac9e3205e4","minutes_billed":2}
{"timestamp":"2025-09-22T09:31:49.277Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_3a5545fc-b609-4e66-bb70-c3dd8c9db76a_min2_1758533509251","transaction_duration_ms":10,"new_balance":1,"minute_billed":2,"total_minutes_billed_this_attempt":2,"total_successful":29,"total_minutes_billed_all_time":29,"avg_transaction_time":"18.86"}
{"timestamp":"2025-09-22T09:31:49.277Z","level":"WARN","service":"BillingService","message":"Low credits warning threshold reached","requestId":"bill_3a5545fc-b609-4e66-bb70-c3dd8c9db76a_min2_1758533509251","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","credits_remaining":1,"minute_billed":2,"warning_threshold":2}
{"timestamp":"2025-09-22T09:31:49.277Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_3a5545fc-b609-4e66-bb70-c3dd8c9db76a_min2_1758533509251","total_duration_ms":26,"transaction_duration_ms":10,"response":{"status":"warning","creditsRemaining":1,"minuteBilled":2,"totalMinutesBilled":2,"attemptId":"e2332cb3-c9dd-4c96-a641-fcac9e3205e4","shouldTerminate":false,"message":"Low credits warning: 1 minute(s) remaining"}}
{"timestamp":"2025-09-22T09:32:49.281816","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_3a5545fc-b609-4e66-bb70-c3dd8c9db76a_min3_1758533569288","correlation_token":"sim_6e69cd5253ee50f10f8682ece7c5cda5_1758533375570","conversation_id":"3a5545fc-b609-4e66-bb70-c3dd8c9db76a","minute":3,"metrics_total_requests":32}
{"timestamp":"2025-09-22T09:32:49.289Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_3a5545fc-b609-4e66-bb70-c3dd8c9db76a_min3_1758533569288","correlation_token":"sim_6e69cd5253ee50f10f8682ece7c5cda5_1758533375570"}
{"timestamp":"2025-09-22T09:32:49.301Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_3a5545fc-b609-4e66-bb70-c3dd8c9db76a_min3_1758533569288","minute_requested":3,"minutes_already_billed":2,"attempt_id":"e2332cb3-c9dd-4c96-a641-fcac9e3205e4"}
{"timestamp":"2025-09-22T09:32:49.301Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_3a5545fc-b609-4e66-bb70-c3dd8c9db76a_min3_1758533569288","attempt_id":"e2332cb3-c9dd-4c96-a641-fcac9e3205e4","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":1,"minutes_already_billed":2,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-22T09:32:49.301Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_3a5545fc-b609-4e66-bb70-c3dd8c9db76a_min3_1758533569288","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":1,"expected_balance_after":0,"minute_to_bill":3}
{"timestamp":"2025-09-22T09:32:49.306Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_3a5545fc-b609-4e66-bb70-c3dd8c9db76a_min3_1758533569288","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-22T09:32:49.310Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_3a5545fc-b609-4e66-bb70-c3dd8c9db76a_min3_1758533569288","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":1,"new_balance":0,"change":-1}
{"timestamp":"2025-09-22T09:32:49.310Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_3a5545fc-b609-4e66-bb70-c3dd8c9db76a_min3_1758533569288","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":0,"minute":3}
{"timestamp":"2025-09-22T09:32:49.312Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_3a5545fc-b609-4e66-bb70-c3dd8c9db76a_min3_1758533569288","transaction_id":"215e5bdf-52cf-4725-bb12-721c0fd45fcb","transaction_type":"DEBIT","balance_after":0}
{"timestamp":"2025-09-22T09:32:49.312Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_3a5545fc-b609-4e66-bb70-c3dd8c9db76a_min3_1758533569288","attempt_id":"e2332cb3-c9dd-4c96-a641-fcac9e3205e4","new_minutes_billed":3,"new_duration_seconds":180}
{"timestamp":"2025-09-22T09:32:49.315Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_3a5545fc-b609-4e66-bb70-c3dd8c9db76a_min3_1758533569288","attempt_id":"e2332cb3-c9dd-4c96-a641-fcac9e3205e4","minutes_billed":3}
{"timestamp":"2025-09-22T09:32:49.317Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_3a5545fc-b609-4e66-bb70-c3dd8c9db76a_min3_1758533569288","transaction_duration_ms":16,"new_balance":0,"minute_billed":3,"total_minutes_billed_this_attempt":3,"total_successful":30,"total_minutes_billed_all_time":30,"avg_transaction_time":"18.77"}
{"timestamp":"2025-09-22T09:32:49.317Z","level":"WARN","service":"BillingService","message":"Last credit used - will terminate conversation","requestId":"bill_3a5545fc-b609-4e66-bb70-c3dd8c9db76a_min3_1758533569288","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","minute_billed":3,"total_minutes_this_session":3}
{"timestamp":"2025-09-22T09:32:49.317Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_3a5545fc-b609-4e66-bb70-c3dd8c9db76a_min3_1758533569288","total_duration_ms":29,"transaction_duration_ms":16,"response":{"status":"terminate","creditsRemaining":0,"minuteBilled":3,"totalMinutesBilled":3,"attemptId":"e2332cb3-c9dd-4c96-a641-fcac9e3205e4","shouldTerminate":true,"message":"Last credit used - conversation will end","gracePeriodSeconds":60}}
{"timestamp":"2025-09-22T09:33:49.321965","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_3a5545fc-b609-4e66-bb70-c3dd8c9db76a_min5_1758533629324","correlation_token":"sim_6e69cd5253ee50f10f8682ece7c5cda5_1758533375570","conversation_id":"3a5545fc-b609-4e66-bb70-c3dd8c9db76a","minute":5,"metrics_total_requests":33}
{"timestamp":"2025-09-22T09:33:49.324Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_3a5545fc-b609-4e66-bb70-c3dd8c9db76a_min5_1758533629324","correlation_token":"sim_6e69cd5253ee50f10f8682ece7c5cda5_1758533375570"}
{"timestamp":"2025-09-22T09:33:49.334Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_3a5545fc-b609-4e66-bb70-c3dd8c9db76a_min5_1758533629324","minute_requested":5,"minutes_already_billed":3,"attempt_id":"e2332cb3-c9dd-4c96-a641-fcac9e3205e4"}
{"timestamp":"2025-09-22T09:33:49.334Z","level":"WARN","service":"BillingService","message":"Non-sequential minute billing detected","requestId":"bill_3a5545fc-b609-4e66-bb70-c3dd8c9db76a_min5_1758533629324","minute_requested":5,"expected_minute":4,"gap":1,"attempt_id":"e2332cb3-c9dd-4c96-a641-fcac9e3205e4"}
{"timestamp":"2025-09-22T09:33:49.335Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_3a5545fc-b609-4e66-bb70-c3dd8c9db76a_min5_1758533629324","attempt_id":"e2332cb3-c9dd-4c96-a641-fcac9e3205e4","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":0,"minutes_already_billed":3,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-22T09:33:49.335Z","level":"WARN","service":"BillingService","message":"Insufficient credits detected","requestId":"bill_3a5545fc-b609-4e66-bb70-c3dd8c9db76a_min5_1758533629324","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_email":"john.doe@example.com","current_balance":0,"required":1,"minutes_billed":3,"total_insufficient_events":3}
{"timestamp":"2025-09-22T09:44:49.078424","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min1_1758534289090","correlation_token":"sim_7a998722dfc1bc948cd49b1398196e6d_1758534162849","conversation_id":"c51f20e9-365f-46e7-b1f8-abb2778de8b0","minute":1,"metrics_total_requests":34}
{"timestamp":"2025-09-22T09:44:49.091Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min1_1758534289090","correlation_token":"sim_7a998722dfc1bc948cd49b1398196e6d_1758534162849"}
{"timestamp":"2025-09-22T09:44:49.118Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min1_1758534289090","minute_requested":1,"minutes_already_billed":0,"attempt_id":"efde8c5f-80c0-41fd-a720-9cb297138a14"}
{"timestamp":"2025-09-22T09:44:49.118Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min1_1758534289090","attempt_id":"efde8c5f-80c0-41fd-a720-9cb297138a14","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":10,"minutes_already_billed":0,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-22T09:44:49.118Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min1_1758534289090","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":10,"expected_balance_after":9,"minute_to_bill":1}
{"timestamp":"2025-09-22T09:44:49.125Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min1_1758534289090","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-22T09:44:49.127Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min1_1758534289090","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":10,"new_balance":9,"change":-1}
{"timestamp":"2025-09-22T09:44:49.127Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min1_1758534289090","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":9,"minute":1}
{"timestamp":"2025-09-22T09:44:49.130Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min1_1758534289090","transaction_id":"050ac026-f95f-4f3c-b466-9f5fb6bae6c5","transaction_type":"DEBIT","balance_after":9}
{"timestamp":"2025-09-22T09:44:49.130Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min1_1758534289090","attempt_id":"efde8c5f-80c0-41fd-a720-9cb297138a14","new_minutes_billed":1,"new_duration_seconds":60}
{"timestamp":"2025-09-22T09:44:49.132Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min1_1758534289090","attempt_id":"efde8c5f-80c0-41fd-a720-9cb297138a14","minutes_billed":1}
{"timestamp":"2025-09-22T09:44:49.134Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min1_1758534289090","transaction_duration_ms":16,"new_balance":9,"minute_billed":1,"total_minutes_billed_this_attempt":1,"total_successful":31,"total_minutes_billed_all_time":31,"avg_transaction_time":"18.68"}
{"timestamp":"2025-09-22T09:44:49.134Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min1_1758534289090","total_duration_ms":44,"transaction_duration_ms":16,"response":{"status":"continue","creditsRemaining":9,"minuteBilled":1,"totalMinutesBilled":1,"attemptId":"efde8c5f-80c0-41fd-a720-9cb297138a14","shouldTerminate":false}}
{"timestamp":"2025-09-22T09:45:24.720847","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_bf00b666-6a5c-4687-89db-783abf2e97c6_min1_1758534324727","correlation_token":"sim_7a998722dfc1bc948cd49b1398196e6d_1758534162849","conversation_id":"bf00b666-6a5c-4687-89db-783abf2e97c6","minute":1,"metrics_total_requests":35}
{"timestamp":"2025-09-22T09:45:24.727Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_bf00b666-6a5c-4687-89db-783abf2e97c6_min1_1758534324727","correlation_token":"sim_7a998722dfc1bc948cd49b1398196e6d_1758534162849"}
{"timestamp":"2025-09-22T09:45:24.742Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_bf00b666-6a5c-4687-89db-783abf2e97c6_min1_1758534324727","minute_requested":1,"minutes_already_billed":1,"attempt_id":"efde8c5f-80c0-41fd-a720-9cb297138a14"}
{"timestamp":"2025-09-22T09:45:24.742Z","level":"WARN","service":"BillingService","message":"Minute already billed - returning idempotent response","requestId":"bill_bf00b666-6a5c-4687-89db-783abf2e97c6_min1_1758534324727","minute_requested":1,"minutes_already_billed":1,"attempt_id":"efde8c5f-80c0-41fd-a720-9cb297138a14","total_duplicates":1}
{"timestamp":"2025-09-22T09:45:24.743Z","level":"INFO","service":"BillingService","message":"Returning idempotent response","requestId":"bill_bf00b666-6a5c-4687-89db-783abf2e97c6_min1_1758534324727","response":{"status":"continue","creditsRemaining":9,"minuteBilled":1,"totalMinutesBilled":1,"attemptId":"efde8c5f-80c0-41fd-a720-9cb297138a14","shouldTerminate":false,"message":"Already billed (idempotent response)"},"duration_ms":16}
{"timestamp":"2025-09-22T09:45:40.708220","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_56651fcd-06f4-40b8-a2fc-bf11486cadee_min1_1758534340709","correlation_token":"sim_7a998722dfc1bc948cd49b1398196e6d_1758534162849","conversation_id":"56651fcd-06f4-40b8-a2fc-bf11486cadee","minute":1,"metrics_total_requests":36}
{"timestamp":"2025-09-22T09:45:40.709Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_56651fcd-06f4-40b8-a2fc-bf11486cadee_min1_1758534340709","correlation_token":"sim_7a998722dfc1bc948cd49b1398196e6d_1758534162849"}
{"timestamp":"2025-09-22T09:45:40.716Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_56651fcd-06f4-40b8-a2fc-bf11486cadee_min1_1758534340709","minute_requested":1,"minutes_already_billed":1,"attempt_id":"efde8c5f-80c0-41fd-a720-9cb297138a14"}
{"timestamp":"2025-09-22T09:45:40.716Z","level":"WARN","service":"BillingService","message":"Minute already billed - returning idempotent response","requestId":"bill_56651fcd-06f4-40b8-a2fc-bf11486cadee_min1_1758534340709","minute_requested":1,"minutes_already_billed":1,"attempt_id":"efde8c5f-80c0-41fd-a720-9cb297138a14","total_duplicates":2}
{"timestamp":"2025-09-22T09:45:40.716Z","level":"INFO","service":"BillingService","message":"Returning idempotent response","requestId":"bill_56651fcd-06f4-40b8-a2fc-bf11486cadee_min1_1758534340709","response":{"status":"continue","creditsRemaining":9,"minuteBilled":1,"totalMinutesBilled":1,"attemptId":"efde8c5f-80c0-41fd-a720-9cb297138a14","shouldTerminate":false,"message":"Already billed (idempotent response)"},"duration_ms":7}
{"timestamp":"2025-09-22T09:45:49.136093","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min2_1758534349139","correlation_token":"sim_7a998722dfc1bc948cd49b1398196e6d_1758534162849","conversation_id":"c51f20e9-365f-46e7-b1f8-abb2778de8b0","minute":2,"metrics_total_requests":37}
{"timestamp":"2025-09-22T09:45:49.139Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min2_1758534349139","correlation_token":"sim_7a998722dfc1bc948cd49b1398196e6d_1758534162849"}
{"timestamp":"2025-09-22T09:45:49.150Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min2_1758534349139","minute_requested":2,"minutes_already_billed":1,"attempt_id":"efde8c5f-80c0-41fd-a720-9cb297138a14"}
{"timestamp":"2025-09-22T09:45:49.150Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min2_1758534349139","attempt_id":"efde8c5f-80c0-41fd-a720-9cb297138a14","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":9,"minutes_already_billed":1,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-22T09:45:49.150Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min2_1758534349139","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":9,"expected_balance_after":8,"minute_to_bill":2}
{"timestamp":"2025-09-22T09:45:49.153Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min2_1758534349139","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-22T09:45:49.156Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min2_1758534349139","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":9,"new_balance":8,"change":-1}
{"timestamp":"2025-09-22T09:45:49.156Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min2_1758534349139","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":8,"minute":2}
{"timestamp":"2025-09-22T09:45:49.161Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min2_1758534349139","transaction_id":"10712d9a-7f47-41be-b621-771124a32245","transaction_type":"DEBIT","balance_after":8}
{"timestamp":"2025-09-22T09:45:49.161Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min2_1758534349139","attempt_id":"efde8c5f-80c0-41fd-a720-9cb297138a14","new_minutes_billed":2,"new_duration_seconds":120}
{"timestamp":"2025-09-22T09:45:49.164Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min2_1758534349139","attempt_id":"efde8c5f-80c0-41fd-a720-9cb297138a14","minutes_billed":2}
{"timestamp":"2025-09-22T09:45:49.166Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min2_1758534349139","transaction_duration_ms":16,"new_balance":8,"minute_billed":2,"total_minutes_billed_this_attempt":2,"total_successful":32,"total_minutes_billed_all_time":32,"avg_transaction_time":"18.59"}
{"timestamp":"2025-09-22T09:45:49.166Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min2_1758534349139","total_duration_ms":27,"transaction_duration_ms":16,"response":{"status":"continue","creditsRemaining":8,"minuteBilled":2,"totalMinutesBilled":2,"attemptId":"efde8c5f-80c0-41fd-a720-9cb297138a14","shouldTerminate":false}}
{"timestamp":"2025-09-22T09:46:24.747992","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_bf00b666-6a5c-4687-89db-783abf2e97c6_min2_1758534384754","correlation_token":"sim_7a998722dfc1bc948cd49b1398196e6d_1758534162849","conversation_id":"bf00b666-6a5c-4687-89db-783abf2e97c6","minute":2,"metrics_total_requests":38}
{"timestamp":"2025-09-22T09:46:24.754Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_bf00b666-6a5c-4687-89db-783abf2e97c6_min2_1758534384754","correlation_token":"sim_7a998722dfc1bc948cd49b1398196e6d_1758534162849"}
{"timestamp":"2025-09-22T09:46:24.767Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_bf00b666-6a5c-4687-89db-783abf2e97c6_min2_1758534384754","minute_requested":2,"minutes_already_billed":2,"attempt_id":"efde8c5f-80c0-41fd-a720-9cb297138a14"}
{"timestamp":"2025-09-22T09:46:24.767Z","level":"WARN","service":"BillingService","message":"Minute already billed - returning idempotent response","requestId":"bill_bf00b666-6a5c-4687-89db-783abf2e97c6_min2_1758534384754","minute_requested":2,"minutes_already_billed":2,"attempt_id":"efde8c5f-80c0-41fd-a720-9cb297138a14","total_duplicates":3}
{"timestamp":"2025-09-22T09:46:24.767Z","level":"INFO","service":"BillingService","message":"Returning idempotent response","requestId":"bill_bf00b666-6a5c-4687-89db-783abf2e97c6_min2_1758534384754","response":{"status":"continue","creditsRemaining":8,"minuteBilled":2,"totalMinutesBilled":2,"attemptId":"efde8c5f-80c0-41fd-a720-9cb297138a14","shouldTerminate":false,"message":"Already billed (idempotent response)"},"duration_ms":13}
{"timestamp":"2025-09-22T09:46:40.718170","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_56651fcd-06f4-40b8-a2fc-bf11486cadee_min2_1758534400724","correlation_token":"sim_7a998722dfc1bc948cd49b1398196e6d_1758534162849","conversation_id":"56651fcd-06f4-40b8-a2fc-bf11486cadee","minute":2,"metrics_total_requests":39}
{"timestamp":"2025-09-22T09:46:40.724Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_56651fcd-06f4-40b8-a2fc-bf11486cadee_min2_1758534400724","correlation_token":"sim_7a998722dfc1bc948cd49b1398196e6d_1758534162849"}
{"timestamp":"2025-09-22T09:46:40.737Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_56651fcd-06f4-40b8-a2fc-bf11486cadee_min2_1758534400724","minute_requested":2,"minutes_already_billed":2,"attempt_id":"efde8c5f-80c0-41fd-a720-9cb297138a14"}
{"timestamp":"2025-09-22T09:46:40.737Z","level":"WARN","service":"BillingService","message":"Minute already billed - returning idempotent response","requestId":"bill_56651fcd-06f4-40b8-a2fc-bf11486cadee_min2_1758534400724","minute_requested":2,"minutes_already_billed":2,"attempt_id":"efde8c5f-80c0-41fd-a720-9cb297138a14","total_duplicates":4}
{"timestamp":"2025-09-22T09:46:40.737Z","level":"INFO","service":"BillingService","message":"Returning idempotent response","requestId":"bill_56651fcd-06f4-40b8-a2fc-bf11486cadee_min2_1758534400724","response":{"status":"continue","creditsRemaining":8,"minuteBilled":2,"totalMinutesBilled":2,"attemptId":"efde8c5f-80c0-41fd-a720-9cb297138a14","shouldTerminate":false,"message":"Already billed (idempotent response)"},"duration_ms":13}
{"timestamp":"2025-09-22T09:46:49.168014","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min3_1758534409173","correlation_token":"sim_7a998722dfc1bc948cd49b1398196e6d_1758534162849","conversation_id":"c51f20e9-365f-46e7-b1f8-abb2778de8b0","minute":3,"metrics_total_requests":40}
{"timestamp":"2025-09-22T09:46:49.174Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min3_1758534409173","correlation_token":"sim_7a998722dfc1bc948cd49b1398196e6d_1758534162849"}
{"timestamp":"2025-09-22T09:46:49.185Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min3_1758534409173","minute_requested":3,"minutes_already_billed":2,"attempt_id":"efde8c5f-80c0-41fd-a720-9cb297138a14"}
{"timestamp":"2025-09-22T09:46:49.185Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min3_1758534409173","attempt_id":"efde8c5f-80c0-41fd-a720-9cb297138a14","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":8,"minutes_already_billed":2,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-22T09:46:49.185Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min3_1758534409173","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":8,"expected_balance_after":7,"minute_to_bill":3}
{"timestamp":"2025-09-22T09:46:49.189Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min3_1758534409173","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-22T09:46:49.191Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min3_1758534409173","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":8,"new_balance":7,"change":-1}
{"timestamp":"2025-09-22T09:46:49.191Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min3_1758534409173","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":7,"minute":3}
{"timestamp":"2025-09-22T09:46:49.193Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min3_1758534409173","transaction_id":"30344077-c99b-4156-a428-6183e02feae0","transaction_type":"DEBIT","balance_after":7}
{"timestamp":"2025-09-22T09:46:49.193Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min3_1758534409173","attempt_id":"efde8c5f-80c0-41fd-a720-9cb297138a14","new_minutes_billed":3,"new_duration_seconds":180}
{"timestamp":"2025-09-22T09:46:49.196Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min3_1758534409173","attempt_id":"efde8c5f-80c0-41fd-a720-9cb297138a14","minutes_billed":3}
{"timestamp":"2025-09-22T09:46:49.197Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min3_1758534409173","transaction_duration_ms":12,"new_balance":7,"minute_billed":3,"total_minutes_billed_this_attempt":3,"total_successful":33,"total_minutes_billed_all_time":33,"avg_transaction_time":"18.39"}
{"timestamp":"2025-09-22T09:46:49.197Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min3_1758534409173","total_duration_ms":24,"transaction_duration_ms":12,"response":{"status":"continue","creditsRemaining":7,"minuteBilled":3,"totalMinutesBilled":3,"attemptId":"efde8c5f-80c0-41fd-a720-9cb297138a14","shouldTerminate":false}}
{"timestamp":"2025-09-22T09:47:24.772056","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_bf00b666-6a5c-4687-89db-783abf2e97c6_min3_1758534444779","correlation_token":"sim_7a998722dfc1bc948cd49b1398196e6d_1758534162849","conversation_id":"bf00b666-6a5c-4687-89db-783abf2e97c6","minute":3,"metrics_total_requests":41}
{"timestamp":"2025-09-22T09:47:24.779Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_bf00b666-6a5c-4687-89db-783abf2e97c6_min3_1758534444779","correlation_token":"sim_7a998722dfc1bc948cd49b1398196e6d_1758534162849"}
{"timestamp":"2025-09-22T09:47:24.791Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_bf00b666-6a5c-4687-89db-783abf2e97c6_min3_1758534444779","minute_requested":3,"minutes_already_billed":3,"attempt_id":"efde8c5f-80c0-41fd-a720-9cb297138a14"}
{"timestamp":"2025-09-22T09:47:24.791Z","level":"WARN","service":"BillingService","message":"Minute already billed - returning idempotent response","requestId":"bill_bf00b666-6a5c-4687-89db-783abf2e97c6_min3_1758534444779","minute_requested":3,"minutes_already_billed":3,"attempt_id":"efde8c5f-80c0-41fd-a720-9cb297138a14","total_duplicates":5}
{"timestamp":"2025-09-22T09:47:24.791Z","level":"INFO","service":"BillingService","message":"Returning idempotent response","requestId":"bill_bf00b666-6a5c-4687-89db-783abf2e97c6_min3_1758534444779","response":{"status":"continue","creditsRemaining":7,"minuteBilled":3,"totalMinutesBilled":3,"attemptId":"efde8c5f-80c0-41fd-a720-9cb297138a14","shouldTerminate":false,"message":"Already billed (idempotent response)"},"duration_ms":12}
{"timestamp":"2025-09-22T09:47:40.740307","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_56651fcd-06f4-40b8-a2fc-bf11486cadee_min3_1758534460747","correlation_token":"sim_7a998722dfc1bc948cd49b1398196e6d_1758534162849","conversation_id":"56651fcd-06f4-40b8-a2fc-bf11486cadee","minute":3,"metrics_total_requests":42}
{"timestamp":"2025-09-22T09:47:40.747Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_56651fcd-06f4-40b8-a2fc-bf11486cadee_min3_1758534460747","correlation_token":"sim_7a998722dfc1bc948cd49b1398196e6d_1758534162849"}
{"timestamp":"2025-09-22T09:47:40.762Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_56651fcd-06f4-40b8-a2fc-bf11486cadee_min3_1758534460747","minute_requested":3,"minutes_already_billed":3,"attempt_id":"efde8c5f-80c0-41fd-a720-9cb297138a14"}
{"timestamp":"2025-09-22T09:47:40.762Z","level":"WARN","service":"BillingService","message":"Minute already billed - returning idempotent response","requestId":"bill_56651fcd-06f4-40b8-a2fc-bf11486cadee_min3_1758534460747","minute_requested":3,"minutes_already_billed":3,"attempt_id":"efde8c5f-80c0-41fd-a720-9cb297138a14","total_duplicates":6}
{"timestamp":"2025-09-22T09:47:40.762Z","level":"INFO","service":"BillingService","message":"Returning idempotent response","requestId":"bill_56651fcd-06f4-40b8-a2fc-bf11486cadee_min3_1758534460747","response":{"status":"continue","creditsRemaining":7,"minuteBilled":3,"totalMinutesBilled":3,"attemptId":"efde8c5f-80c0-41fd-a720-9cb297138a14","shouldTerminate":false,"message":"Already billed (idempotent response)"},"duration_ms":15}
{"timestamp":"2025-09-22T09:47:49.200711","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min4_1758534469205","correlation_token":"sim_7a998722dfc1bc948cd49b1398196e6d_1758534162849","conversation_id":"c51f20e9-365f-46e7-b1f8-abb2778de8b0","minute":4,"metrics_total_requests":43}
{"timestamp":"2025-09-22T09:47:49.205Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min4_1758534469205","correlation_token":"sim_7a998722dfc1bc948cd49b1398196e6d_1758534162849"}
{"timestamp":"2025-09-22T09:47:49.214Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min4_1758534469205","minute_requested":4,"minutes_already_billed":3,"attempt_id":"efde8c5f-80c0-41fd-a720-9cb297138a14"}
{"timestamp":"2025-09-22T09:47:49.214Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min4_1758534469205","attempt_id":"efde8c5f-80c0-41fd-a720-9cb297138a14","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":7,"minutes_already_billed":3,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-22T09:47:49.215Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min4_1758534469205","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":7,"expected_balance_after":6,"minute_to_bill":4}
{"timestamp":"2025-09-22T09:47:49.218Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min4_1758534469205","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-22T09:47:49.220Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min4_1758534469205","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":7,"new_balance":6,"change":-1}
{"timestamp":"2025-09-22T09:47:49.220Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min4_1758534469205","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":6,"minute":4}
{"timestamp":"2025-09-22T09:47:49.222Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min4_1758534469205","transaction_id":"880c11eb-507a-44cf-a86b-1e47129e39be","transaction_type":"DEBIT","balance_after":6}
{"timestamp":"2025-09-22T09:47:49.222Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min4_1758534469205","attempt_id":"efde8c5f-80c0-41fd-a720-9cb297138a14","new_minutes_billed":4,"new_duration_seconds":240}
{"timestamp":"2025-09-22T09:47:49.224Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min4_1758534469205","attempt_id":"efde8c5f-80c0-41fd-a720-9cb297138a14","minutes_billed":4}
{"timestamp":"2025-09-22T09:47:49.225Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min4_1758534469205","transaction_duration_ms":10,"new_balance":6,"minute_billed":4,"total_minutes_billed_this_attempt":4,"total_successful":34,"total_minutes_billed_all_time":34,"avg_transaction_time":"18.15"}
{"timestamp":"2025-09-22T09:47:49.225Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min4_1758534469205","total_duration_ms":20,"transaction_duration_ms":10,"response":{"status":"continue","creditsRemaining":6,"minuteBilled":4,"totalMinutesBilled":4,"attemptId":"efde8c5f-80c0-41fd-a720-9cb297138a14","shouldTerminate":false}}
{"timestamp":"2025-09-22T09:48:24.795482","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_bf00b666-6a5c-4687-89db-783abf2e97c6_min4_1758534504803","correlation_token":"sim_7a998722dfc1bc948cd49b1398196e6d_1758534162849","conversation_id":"bf00b666-6a5c-4687-89db-783abf2e97c6","minute":4,"metrics_total_requests":44}
{"timestamp":"2025-09-22T09:48:24.803Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_bf00b666-6a5c-4687-89db-783abf2e97c6_min4_1758534504803","correlation_token":"sim_7a998722dfc1bc948cd49b1398196e6d_1758534162849"}
{"timestamp":"2025-09-22T09:48:24.819Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_bf00b666-6a5c-4687-89db-783abf2e97c6_min4_1758534504803","minute_requested":4,"minutes_already_billed":4,"attempt_id":"efde8c5f-80c0-41fd-a720-9cb297138a14"}
{"timestamp":"2025-09-22T09:48:24.819Z","level":"WARN","service":"BillingService","message":"Minute already billed - returning idempotent response","requestId":"bill_bf00b666-6a5c-4687-89db-783abf2e97c6_min4_1758534504803","minute_requested":4,"minutes_already_billed":4,"attempt_id":"efde8c5f-80c0-41fd-a720-9cb297138a14","total_duplicates":7}
{"timestamp":"2025-09-22T09:48:24.819Z","level":"INFO","service":"BillingService","message":"Returning idempotent response","requestId":"bill_bf00b666-6a5c-4687-89db-783abf2e97c6_min4_1758534504803","response":{"status":"continue","creditsRemaining":6,"minuteBilled":4,"totalMinutesBilled":4,"attemptId":"efde8c5f-80c0-41fd-a720-9cb297138a14","shouldTerminate":false,"message":"Already billed (idempotent response)"},"duration_ms":16}
{"timestamp":"2025-09-22T09:48:40.765378","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_56651fcd-06f4-40b8-a2fc-bf11486cadee_min4_1758534520773","correlation_token":"sim_7a998722dfc1bc948cd49b1398196e6d_1758534162849","conversation_id":"56651fcd-06f4-40b8-a2fc-bf11486cadee","minute":4,"metrics_total_requests":45}
{"timestamp":"2025-09-22T09:48:40.773Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_56651fcd-06f4-40b8-a2fc-bf11486cadee_min4_1758534520773","correlation_token":"sim_7a998722dfc1bc948cd49b1398196e6d_1758534162849"}
{"timestamp":"2025-09-22T09:48:40.791Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_56651fcd-06f4-40b8-a2fc-bf11486cadee_min4_1758534520773","minute_requested":4,"minutes_already_billed":4,"attempt_id":"efde8c5f-80c0-41fd-a720-9cb297138a14"}
{"timestamp":"2025-09-22T09:48:40.791Z","level":"WARN","service":"BillingService","message":"Minute already billed - returning idempotent response","requestId":"bill_56651fcd-06f4-40b8-a2fc-bf11486cadee_min4_1758534520773","minute_requested":4,"minutes_already_billed":4,"attempt_id":"efde8c5f-80c0-41fd-a720-9cb297138a14","total_duplicates":8}
{"timestamp":"2025-09-22T09:48:40.791Z","level":"INFO","service":"BillingService","message":"Returning idempotent response","requestId":"bill_56651fcd-06f4-40b8-a2fc-bf11486cadee_min4_1758534520773","response":{"status":"continue","creditsRemaining":6,"minuteBilled":4,"totalMinutesBilled":4,"attemptId":"efde8c5f-80c0-41fd-a720-9cb297138a14","shouldTerminate":false,"message":"Already billed (idempotent response)"},"duration_ms":18}
{"timestamp":"2025-09-22T09:48:49.228137","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min5_1758534529231","correlation_token":"sim_7a998722dfc1bc948cd49b1398196e6d_1758534162849","conversation_id":"c51f20e9-365f-46e7-b1f8-abb2778de8b0","minute":5,"metrics_total_requests":46}
{"timestamp":"2025-09-22T09:48:49.231Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min5_1758534529231","correlation_token":"sim_7a998722dfc1bc948cd49b1398196e6d_1758534162849"}
{"timestamp":"2025-09-22T09:48:49.246Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min5_1758534529231","minute_requested":5,"minutes_already_billed":4,"attempt_id":"efde8c5f-80c0-41fd-a720-9cb297138a14"}
{"timestamp":"2025-09-22T09:48:49.246Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min5_1758534529231","attempt_id":"efde8c5f-80c0-41fd-a720-9cb297138a14","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":6,"minutes_already_billed":4,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-22T09:48:49.246Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min5_1758534529231","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":6,"expected_balance_after":5,"minute_to_bill":5}
{"timestamp":"2025-09-22T09:48:49.250Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min5_1758534529231","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-22T09:48:49.253Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min5_1758534529231","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":6,"new_balance":5,"change":-1}
{"timestamp":"2025-09-22T09:48:49.253Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min5_1758534529231","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":5,"minute":5}
{"timestamp":"2025-09-22T09:48:49.256Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min5_1758534529231","transaction_id":"420e097b-0384-44bf-9cfd-6f59fda0995d","transaction_type":"DEBIT","balance_after":5}
{"timestamp":"2025-09-22T09:48:49.256Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min5_1758534529231","attempt_id":"efde8c5f-80c0-41fd-a720-9cb297138a14","new_minutes_billed":5,"new_duration_seconds":300}
{"timestamp":"2025-09-22T09:48:49.260Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min5_1758534529231","attempt_id":"efde8c5f-80c0-41fd-a720-9cb297138a14","minutes_billed":5}
{"timestamp":"2025-09-22T09:48:49.262Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min5_1758534529231","transaction_duration_ms":16,"new_balance":5,"minute_billed":5,"total_minutes_billed_this_attempt":5,"total_successful":35,"total_minutes_billed_all_time":35,"avg_transaction_time":"18.09"}
{"timestamp":"2025-09-22T09:48:49.262Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min5_1758534529231","total_duration_ms":31,"transaction_duration_ms":16,"response":{"status":"continue","creditsRemaining":5,"minuteBilled":5,"totalMinutesBilled":5,"attemptId":"efde8c5f-80c0-41fd-a720-9cb297138a14","shouldTerminate":false}}
{"timestamp":"2025-09-22T09:49:18.890129","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min6_1758534558893","correlation_token":"sim_7a998722dfc1bc948cd49b1398196e6d_1758534162849","conversation_id":"c51f20e9-365f-46e7-b1f8-abb2778de8b0","minute":6,"metrics_total_requests":47}
{"timestamp":"2025-09-22T09:49:18.893Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min6_1758534558893","correlation_token":"sim_7a998722dfc1bc948cd49b1398196e6d_1758534162849"}
{"timestamp":"2025-09-22T09:49:18.904Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min6_1758534558893","minute_requested":6,"minutes_already_billed":5,"attempt_id":"efde8c5f-80c0-41fd-a720-9cb297138a14"}
{"timestamp":"2025-09-22T09:49:18.904Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min6_1758534558893","attempt_id":"efde8c5f-80c0-41fd-a720-9cb297138a14","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":5,"minutes_already_billed":5,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-22T09:49:18.904Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min6_1758534558893","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":5,"expected_balance_after":4,"minute_to_bill":6}
{"timestamp":"2025-09-22T09:49:18.907Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min6_1758534558893","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-22T09:49:18.909Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min6_1758534558893","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":5,"new_balance":4,"change":-1}
{"timestamp":"2025-09-22T09:49:18.909Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min6_1758534558893","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":4,"minute":6}
{"timestamp":"2025-09-22T09:49:18.911Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min6_1758534558893","transaction_id":"a9457334-b565-40db-bda3-3688864f87ec","transaction_type":"DEBIT","balance_after":4}
{"timestamp":"2025-09-22T09:49:18.912Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min6_1758534558893","attempt_id":"efde8c5f-80c0-41fd-a720-9cb297138a14","new_minutes_billed":6,"new_duration_seconds":360}
{"timestamp":"2025-09-22T09:49:18.913Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min6_1758534558893","attempt_id":"efde8c5f-80c0-41fd-a720-9cb297138a14","minutes_billed":6}
{"timestamp":"2025-09-22T09:49:18.914Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min6_1758534558893","transaction_duration_ms":10,"new_balance":4,"minute_billed":6,"total_minutes_billed_this_attempt":6,"total_successful":36,"total_minutes_billed_all_time":36,"avg_transaction_time":"17.86"}
{"timestamp":"2025-09-22T09:49:18.914Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_c51f20e9-365f-46e7-b1f8-abb2778de8b0_min6_1758534558893","total_duration_ms":21,"transaction_duration_ms":10,"response":{"status":"continue","creditsRemaining":4,"minuteBilled":6,"totalMinutesBilled":6,"attemptId":"efde8c5f-80c0-41fd-a720-9cb297138a14","shouldTerminate":false}}
{"timestamp":"2025-09-22T09:49:19.829331","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_56651fcd-06f4-40b8-a2fc-bf11486cadee_min5_1758534559832","correlation_token":"sim_7a998722dfc1bc948cd49b1398196e6d_1758534162849","conversation_id":"56651fcd-06f4-40b8-a2fc-bf11486cadee","minute":5,"metrics_total_requests":48}
{"timestamp":"2025-09-22T09:49:19.832Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_56651fcd-06f4-40b8-a2fc-bf11486cadee_min5_1758534559832","correlation_token":"sim_7a998722dfc1bc948cd49b1398196e6d_1758534162849"}
{"timestamp":"2025-09-22T09:49:19.842Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_56651fcd-06f4-40b8-a2fc-bf11486cadee_min5_1758534559832","minute_requested":5,"minutes_already_billed":6,"attempt_id":"efde8c5f-80c0-41fd-a720-9cb297138a14"}
{"timestamp":"2025-09-22T09:49:19.842Z","level":"WARN","service":"BillingService","message":"Minute already billed - returning idempotent response","requestId":"bill_56651fcd-06f4-40b8-a2fc-bf11486cadee_min5_1758534559832","minute_requested":5,"minutes_already_billed":6,"attempt_id":"efde8c5f-80c0-41fd-a720-9cb297138a14","total_duplicates":9}
{"timestamp":"2025-09-22T09:49:19.842Z","level":"INFO","service":"BillingService","message":"Returning idempotent response","requestId":"bill_56651fcd-06f4-40b8-a2fc-bf11486cadee_min5_1758534559832","response":{"status":"continue","creditsRemaining":4,"minuteBilled":5,"totalMinutesBilled":6,"attemptId":"efde8c5f-80c0-41fd-a720-9cb297138a14","shouldTerminate":false,"message":"Already billed (idempotent response)"},"duration_ms":10}
{"timestamp":"2025-09-22T09:49:19.947831","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_bf00b666-6a5c-4687-89db-783abf2e97c6_min5_1758534559949","correlation_token":"sim_7a998722dfc1bc948cd49b1398196e6d_1758534162849","conversation_id":"bf00b666-6a5c-4687-89db-783abf2e97c6","minute":5,"metrics_total_requests":49}
{"timestamp":"2025-09-22T09:49:19.949Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_bf00b666-6a5c-4687-89db-783abf2e97c6_min5_1758534559949","correlation_token":"sim_7a998722dfc1bc948cd49b1398196e6d_1758534162849"}
{"timestamp":"2025-09-22T09:49:19.957Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_bf00b666-6a5c-4687-89db-783abf2e97c6_min5_1758534559949","minute_requested":5,"minutes_already_billed":6,"attempt_id":"efde8c5f-80c0-41fd-a720-9cb297138a14"}
{"timestamp":"2025-09-22T09:49:19.957Z","level":"WARN","service":"BillingService","message":"Minute already billed - returning idempotent response","requestId":"bill_bf00b666-6a5c-4687-89db-783abf2e97c6_min5_1758534559949","minute_requested":5,"minutes_already_billed":6,"attempt_id":"efde8c5f-80c0-41fd-a720-9cb297138a14","total_duplicates":10}
{"timestamp":"2025-09-22T09:49:19.957Z","level":"INFO","service":"BillingService","message":"Returning idempotent response","requestId":"bill_bf00b666-6a5c-4687-89db-783abf2e97c6_min5_1758534559949","response":{"status":"continue","creditsRemaining":4,"minuteBilled":5,"totalMinutesBilled":6,"attemptId":"efde8c5f-80c0-41fd-a720-9cb297138a14","shouldTerminate":false,"message":"Already billed (idempotent response)"},"duration_ms":8}
{"timestamp":"2025-09-22T09:56:19.475702","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_47f19ad4-7c03-472c-b7a8-60c2a31ce3d7_min1_1758534979477","correlation_token":"sim_7a998722dfc1bc948cd49b1398196e6d_1758534162849","conversation_id":"47f19ad4-7c03-472c-b7a8-60c2a31ce3d7","minute":1,"metrics_total_requests":50}
{"timestamp":"2025-09-22T09:56:19.478Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_47f19ad4-7c03-472c-b7a8-60c2a31ce3d7_min1_1758534979477","correlation_token":"sim_7a998722dfc1bc948cd49b1398196e6d_1758534162849"}
{"timestamp":"2025-09-22T09:56:19.487Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_47f19ad4-7c03-472c-b7a8-60c2a31ce3d7_min1_1758534979477","minute_requested":1,"minutes_already_billed":6,"attempt_id":"efde8c5f-80c0-41fd-a720-9cb297138a14"}
{"timestamp":"2025-09-22T09:56:19.487Z","level":"WARN","service":"BillingService","message":"Minute already billed - returning idempotent response","requestId":"bill_47f19ad4-7c03-472c-b7a8-60c2a31ce3d7_min1_1758534979477","minute_requested":1,"minutes_already_billed":6,"attempt_id":"efde8c5f-80c0-41fd-a720-9cb297138a14","total_duplicates":11}
{"timestamp":"2025-09-22T09:56:19.487Z","level":"INFO","service":"BillingService","message":"Returning idempotent response","requestId":"bill_47f19ad4-7c03-472c-b7a8-60c2a31ce3d7_min1_1758534979477","response":{"status":"continue","creditsRemaining":4,"minuteBilled":1,"totalMinutesBilled":6,"attemptId":"efde8c5f-80c0-41fd-a720-9cb297138a14","shouldTerminate":false,"message":"Already billed (idempotent response)"},"duration_ms":10}
{"timestamp":"2025-09-22T09:57:19.426029","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_47f19ad4-7c03-472c-b7a8-60c2a31ce3d7_min2_1758535039433","correlation_token":"sim_7a998722dfc1bc948cd49b1398196e6d_1758534162849","conversation_id":"47f19ad4-7c03-472c-b7a8-60c2a31ce3d7","minute":2,"metrics_total_requests":51}
{"timestamp":"2025-09-22T09:57:19.433Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_47f19ad4-7c03-472c-b7a8-60c2a31ce3d7_min2_1758535039433","correlation_token":"sim_7a998722dfc1bc948cd49b1398196e6d_1758534162849"}
{"timestamp":"2025-09-22T09:57:19.451Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_47f19ad4-7c03-472c-b7a8-60c2a31ce3d7_min2_1758535039433","minute_requested":2,"minutes_already_billed":6,"attempt_id":"efde8c5f-80c0-41fd-a720-9cb297138a14"}
{"timestamp":"2025-09-22T09:57:19.451Z","level":"WARN","service":"BillingService","message":"Minute already billed - returning idempotent response","requestId":"bill_47f19ad4-7c03-472c-b7a8-60c2a31ce3d7_min2_1758535039433","minute_requested":2,"minutes_already_billed":6,"attempt_id":"efde8c5f-80c0-41fd-a720-9cb297138a14","total_duplicates":12}
{"timestamp":"2025-09-22T09:57:19.451Z","level":"INFO","service":"BillingService","message":"Returning idempotent response","requestId":"bill_47f19ad4-7c03-472c-b7a8-60c2a31ce3d7_min2_1758535039433","response":{"status":"continue","creditsRemaining":4,"minuteBilled":2,"totalMinutesBilled":6,"attemptId":"efde8c5f-80c0-41fd-a720-9cb297138a14","shouldTerminate":false,"message":"Already billed (idempotent response)"},"duration_ms":18}
{"timestamp":"2025-09-22T09:57:30.903841","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_ea789eb7-964a-4b81-b022-98e38c518bfc_min1_1758535050905","correlation_token":"sim_e9aedc4d957d191018c284479e1241a2_1758535025260","conversation_id":"ea789eb7-964a-4b81-b022-98e38c518bfc","minute":1,"metrics_total_requests":52}
{"timestamp":"2025-09-22T09:57:30.905Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_ea789eb7-964a-4b81-b022-98e38c518bfc_min1_1758535050905","correlation_token":"sim_e9aedc4d957d191018c284479e1241a2_1758535025260"}
{"timestamp":"2025-09-22T09:57:30.913Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_ea789eb7-964a-4b81-b022-98e38c518bfc_min1_1758535050905","minute_requested":1,"minutes_already_billed":0,"attempt_id":"bbd9e241-b441-40b7-b109-d71a90872c4a"}
{"timestamp":"2025-09-22T09:57:30.913Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_ea789eb7-964a-4b81-b022-98e38c518bfc_min1_1758535050905","attempt_id":"bbd9e241-b441-40b7-b109-d71a90872c4a","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":4,"minutes_already_billed":0,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-22T09:57:30.914Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_ea789eb7-964a-4b81-b022-98e38c518bfc_min1_1758535050905","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":4,"expected_balance_after":3,"minute_to_bill":1}
{"timestamp":"2025-09-22T09:57:30.920Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_ea789eb7-964a-4b81-b022-98e38c518bfc_min1_1758535050905","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-22T09:57:30.923Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_ea789eb7-964a-4b81-b022-98e38c518bfc_min1_1758535050905","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":4,"new_balance":3,"change":-1}
{"timestamp":"2025-09-22T09:57:30.923Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_ea789eb7-964a-4b81-b022-98e38c518bfc_min1_1758535050905","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":3,"minute":1}
{"timestamp":"2025-09-22T09:57:30.925Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_ea789eb7-964a-4b81-b022-98e38c518bfc_min1_1758535050905","transaction_id":"e6715d17-438d-46aa-aa96-b910da53c49a","transaction_type":"DEBIT","balance_after":3}
{"timestamp":"2025-09-22T09:57:30.925Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_ea789eb7-964a-4b81-b022-98e38c518bfc_min1_1758535050905","attempt_id":"bbd9e241-b441-40b7-b109-d71a90872c4a","new_minutes_billed":1,"new_duration_seconds":60}
{"timestamp":"2025-09-22T09:57:30.927Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_ea789eb7-964a-4b81-b022-98e38c518bfc_min1_1758535050905","attempt_id":"bbd9e241-b441-40b7-b109-d71a90872c4a","minutes_billed":1}
{"timestamp":"2025-09-22T09:57:30.928Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_ea789eb7-964a-4b81-b022-98e38c518bfc_min1_1758535050905","transaction_duration_ms":14,"new_balance":3,"minute_billed":1,"total_minutes_billed_this_attempt":1,"total_successful":37,"total_minutes_billed_all_time":37,"avg_transaction_time":"17.76"}
{"timestamp":"2025-09-22T09:57:30.929Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_ea789eb7-964a-4b81-b022-98e38c518bfc_min1_1758535050905","total_duration_ms":24,"transaction_duration_ms":14,"response":{"status":"continue","creditsRemaining":3,"minuteBilled":1,"totalMinutesBilled":1,"attemptId":"bbd9e241-b441-40b7-b109-d71a90872c4a","shouldTerminate":false}}
{"timestamp":"2025-09-22T09:58:05.620838","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_74bb6e03-1ae0-4290-8360-424df476e6d3_min1_1758535085623","correlation_token":"sim_e9aedc4d957d191018c284479e1241a2_1758535025260","conversation_id":"74bb6e03-1ae0-4290-8360-424df476e6d3","minute":1,"metrics_total_requests":53}
{"timestamp":"2025-09-22T09:58:05.623Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_74bb6e03-1ae0-4290-8360-424df476e6d3_min1_1758535085623","correlation_token":"sim_e9aedc4d957d191018c284479e1241a2_1758535025260"}
{"timestamp":"2025-09-22T09:58:05.633Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_74bb6e03-1ae0-4290-8360-424df476e6d3_min1_1758535085623","minute_requested":1,"minutes_already_billed":1,"attempt_id":"bbd9e241-b441-40b7-b109-d71a90872c4a"}
{"timestamp":"2025-09-22T09:58:05.633Z","level":"WARN","service":"BillingService","message":"Minute already billed - returning idempotent response","requestId":"bill_74bb6e03-1ae0-4290-8360-424df476e6d3_min1_1758535085623","minute_requested":1,"minutes_already_billed":1,"attempt_id":"bbd9e241-b441-40b7-b109-d71a90872c4a","total_duplicates":13}
{"timestamp":"2025-09-22T09:58:05.633Z","level":"INFO","service":"BillingService","message":"Returning idempotent response","requestId":"bill_74bb6e03-1ae0-4290-8360-424df476e6d3_min1_1758535085623","response":{"status":"continue","creditsRemaining":3,"minuteBilled":1,"totalMinutesBilled":1,"attemptId":"bbd9e241-b441-40b7-b109-d71a90872c4a","shouldTerminate":false,"message":"Already billed (idempotent response)"},"duration_ms":10}
{"timestamp":"2025-09-22T09:58:19.454736","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_47f19ad4-7c03-472c-b7a8-60c2a31ce3d7_min3_1758535099459","correlation_token":"sim_7a998722dfc1bc948cd49b1398196e6d_1758534162849","conversation_id":"47f19ad4-7c03-472c-b7a8-60c2a31ce3d7","minute":3,"metrics_total_requests":54}
{"timestamp":"2025-09-22T09:58:19.459Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_47f19ad4-7c03-472c-b7a8-60c2a31ce3d7_min3_1758535099459","correlation_token":"sim_7a998722dfc1bc948cd49b1398196e6d_1758534162849"}
{"timestamp":"2025-09-22T09:58:19.474Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_47f19ad4-7c03-472c-b7a8-60c2a31ce3d7_min3_1758535099459","minute_requested":3,"minutes_already_billed":6,"attempt_id":"efde8c5f-80c0-41fd-a720-9cb297138a14"}
{"timestamp":"2025-09-22T09:58:19.474Z","level":"WARN","service":"BillingService","message":"Minute already billed - returning idempotent response","requestId":"bill_47f19ad4-7c03-472c-b7a8-60c2a31ce3d7_min3_1758535099459","minute_requested":3,"minutes_already_billed":6,"attempt_id":"efde8c5f-80c0-41fd-a720-9cb297138a14","total_duplicates":14}
{"timestamp":"2025-09-22T09:58:19.474Z","level":"INFO","service":"BillingService","message":"Returning idempotent response","requestId":"bill_47f19ad4-7c03-472c-b7a8-60c2a31ce3d7_min3_1758535099459","response":{"status":"continue","creditsRemaining":3,"minuteBilled":3,"totalMinutesBilled":6,"attemptId":"efde8c5f-80c0-41fd-a720-9cb297138a14","shouldTerminate":false,"message":"Already billed (idempotent response)"},"duration_ms":15}
{"timestamp":"2025-09-22T09:58:30.930894","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_ea789eb7-964a-4b81-b022-98e38c518bfc_min2_1758535110932","correlation_token":"sim_e9aedc4d957d191018c284479e1241a2_1758535025260","conversation_id":"ea789eb7-964a-4b81-b022-98e38c518bfc","minute":2,"metrics_total_requests":55}
{"timestamp":"2025-09-22T09:58:30.932Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_ea789eb7-964a-4b81-b022-98e38c518bfc_min2_1758535110932","correlation_token":"sim_e9aedc4d957d191018c284479e1241a2_1758535025260"}
{"timestamp":"2025-09-22T09:58:30.940Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_ea789eb7-964a-4b81-b022-98e38c518bfc_min2_1758535110932","minute_requested":2,"minutes_already_billed":1,"attempt_id":"bbd9e241-b441-40b7-b109-d71a90872c4a"}
{"timestamp":"2025-09-22T09:58:30.940Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_ea789eb7-964a-4b81-b022-98e38c518bfc_min2_1758535110932","attempt_id":"bbd9e241-b441-40b7-b109-d71a90872c4a","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":3,"minutes_already_billed":1,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-22T09:58:30.940Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_ea789eb7-964a-4b81-b022-98e38c518bfc_min2_1758535110932","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":3,"expected_balance_after":2,"minute_to_bill":2}
{"timestamp":"2025-09-22T09:58:30.943Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_ea789eb7-964a-4b81-b022-98e38c518bfc_min2_1758535110932","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-22T09:58:30.945Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_ea789eb7-964a-4b81-b022-98e38c518bfc_min2_1758535110932","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":3,"new_balance":2,"change":-1}
{"timestamp":"2025-09-22T09:58:30.945Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_ea789eb7-964a-4b81-b022-98e38c518bfc_min2_1758535110932","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":2,"minute":2}
{"timestamp":"2025-09-22T09:58:30.947Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_ea789eb7-964a-4b81-b022-98e38c518bfc_min2_1758535110932","transaction_id":"96789e8e-d6d6-4282-867e-ece1d89b82c3","transaction_type":"DEBIT","balance_after":2}
{"timestamp":"2025-09-22T09:58:30.947Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_ea789eb7-964a-4b81-b022-98e38c518bfc_min2_1758535110932","attempt_id":"bbd9e241-b441-40b7-b109-d71a90872c4a","new_minutes_billed":2,"new_duration_seconds":120}
{"timestamp":"2025-09-22T09:58:30.949Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_ea789eb7-964a-4b81-b022-98e38c518bfc_min2_1758535110932","attempt_id":"bbd9e241-b441-40b7-b109-d71a90872c4a","minutes_billed":2}
{"timestamp":"2025-09-22T09:58:30.950Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_ea789eb7-964a-4b81-b022-98e38c518bfc_min2_1758535110932","transaction_duration_ms":10,"new_balance":2,"minute_billed":2,"total_minutes_billed_this_attempt":2,"total_successful":38,"total_minutes_billed_all_time":38,"avg_transaction_time":"17.55"}
{"timestamp":"2025-09-22T09:58:30.950Z","level":"WARN","service":"BillingService","message":"Low credits warning threshold reached","requestId":"bill_ea789eb7-964a-4b81-b022-98e38c518bfc_min2_1758535110932","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","credits_remaining":2,"minute_billed":2,"warning_threshold":2}
{"timestamp":"2025-09-22T09:58:30.950Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_ea789eb7-964a-4b81-b022-98e38c518bfc_min2_1758535110932","total_duration_ms":18,"transaction_duration_ms":10,"response":{"status":"warning","creditsRemaining":2,"minuteBilled":2,"totalMinutesBilled":2,"attemptId":"bbd9e241-b441-40b7-b109-d71a90872c4a","shouldTerminate":false,"message":"Low credits warning: 2 minute(s) remaining"}}
{"timestamp":"2025-09-22T09:59:05.636509","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_74bb6e03-1ae0-4290-8360-424df476e6d3_min2_1758535145641","correlation_token":"sim_e9aedc4d957d191018c284479e1241a2_1758535025260","conversation_id":"74bb6e03-1ae0-4290-8360-424df476e6d3","minute":2,"metrics_total_requests":56}
{"timestamp":"2025-09-22T09:59:05.642Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_74bb6e03-1ae0-4290-8360-424df476e6d3_min2_1758535145641","correlation_token":"sim_e9aedc4d957d191018c284479e1241a2_1758535025260"}
{"timestamp":"2025-09-22T09:59:05.655Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_74bb6e03-1ae0-4290-8360-424df476e6d3_min2_1758535145641","minute_requested":2,"minutes_already_billed":2,"attempt_id":"bbd9e241-b441-40b7-b109-d71a90872c4a"}
{"timestamp":"2025-09-22T09:59:05.655Z","level":"WARN","service":"BillingService","message":"Minute already billed - returning idempotent response","requestId":"bill_74bb6e03-1ae0-4290-8360-424df476e6d3_min2_1758535145641","minute_requested":2,"minutes_already_billed":2,"attempt_id":"bbd9e241-b441-40b7-b109-d71a90872c4a","total_duplicates":15}
{"timestamp":"2025-09-22T09:59:05.655Z","level":"INFO","service":"BillingService","message":"Returning idempotent response","requestId":"bill_74bb6e03-1ae0-4290-8360-424df476e6d3_min2_1758535145641","response":{"status":"continue","creditsRemaining":2,"minuteBilled":2,"totalMinutesBilled":2,"attemptId":"bbd9e241-b441-40b7-b109-d71a90872c4a","shouldTerminate":false,"message":"Already billed (idempotent response)"},"duration_ms":14}
{"timestamp":"2025-09-22T09:59:19.477478","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_47f19ad4-7c03-472c-b7a8-60c2a31ce3d7_min4_1758535159483","correlation_token":"sim_7a998722dfc1bc948cd49b1398196e6d_1758534162849","conversation_id":"47f19ad4-7c03-472c-b7a8-60c2a31ce3d7","minute":4,"metrics_total_requests":57}
{"timestamp":"2025-09-22T09:59:19.483Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_47f19ad4-7c03-472c-b7a8-60c2a31ce3d7_min4_1758535159483","correlation_token":"sim_7a998722dfc1bc948cd49b1398196e6d_1758534162849"}
{"timestamp":"2025-09-22T09:59:19.497Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_47f19ad4-7c03-472c-b7a8-60c2a31ce3d7_min4_1758535159483","minute_requested":4,"minutes_already_billed":6,"attempt_id":"efde8c5f-80c0-41fd-a720-9cb297138a14"}
{"timestamp":"2025-09-22T09:59:19.497Z","level":"WARN","service":"BillingService","message":"Minute already billed - returning idempotent response","requestId":"bill_47f19ad4-7c03-472c-b7a8-60c2a31ce3d7_min4_1758535159483","minute_requested":4,"minutes_already_billed":6,"attempt_id":"efde8c5f-80c0-41fd-a720-9cb297138a14","total_duplicates":16}
{"timestamp":"2025-09-22T09:59:19.497Z","level":"INFO","service":"BillingService","message":"Returning idempotent response","requestId":"bill_47f19ad4-7c03-472c-b7a8-60c2a31ce3d7_min4_1758535159483","response":{"status":"continue","creditsRemaining":2,"minuteBilled":4,"totalMinutesBilled":6,"attemptId":"efde8c5f-80c0-41fd-a720-9cb297138a14","shouldTerminate":false,"message":"Already billed (idempotent response)"},"duration_ms":14}
{"timestamp":"2025-09-22T09:59:30.952641","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_ea789eb7-964a-4b81-b022-98e38c518bfc_min3_1758535170955","correlation_token":"sim_e9aedc4d957d191018c284479e1241a2_1758535025260","conversation_id":"ea789eb7-964a-4b81-b022-98e38c518bfc","minute":3,"metrics_total_requests":58}
{"timestamp":"2025-09-22T09:59:30.955Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_ea789eb7-964a-4b81-b022-98e38c518bfc_min3_1758535170955","correlation_token":"sim_e9aedc4d957d191018c284479e1241a2_1758535025260"}
{"timestamp":"2025-09-22T09:59:30.970Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_ea789eb7-964a-4b81-b022-98e38c518bfc_min3_1758535170955","minute_requested":3,"minutes_already_billed":2,"attempt_id":"bbd9e241-b441-40b7-b109-d71a90872c4a"}
{"timestamp":"2025-09-22T09:59:30.970Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_ea789eb7-964a-4b81-b022-98e38c518bfc_min3_1758535170955","attempt_id":"bbd9e241-b441-40b7-b109-d71a90872c4a","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":2,"minutes_already_billed":2,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-22T09:59:30.970Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_ea789eb7-964a-4b81-b022-98e38c518bfc_min3_1758535170955","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":2,"expected_balance_after":1,"minute_to_bill":3}
{"timestamp":"2025-09-22T09:59:30.976Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_ea789eb7-964a-4b81-b022-98e38c518bfc_min3_1758535170955","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-22T09:59:30.980Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_ea789eb7-964a-4b81-b022-98e38c518bfc_min3_1758535170955","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":2,"new_balance":1,"change":-1}
{"timestamp":"2025-09-22T09:59:30.980Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_ea789eb7-964a-4b81-b022-98e38c518bfc_min3_1758535170955","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":1,"minute":3}
{"timestamp":"2025-09-22T09:59:30.983Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_ea789eb7-964a-4b81-b022-98e38c518bfc_min3_1758535170955","transaction_id":"65cf25bf-3198-41ca-87e5-fc80fd810fa9","transaction_type":"DEBIT","balance_after":1}
{"timestamp":"2025-09-22T09:59:30.984Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_ea789eb7-964a-4b81-b022-98e38c518bfc_min3_1758535170955","attempt_id":"bbd9e241-b441-40b7-b109-d71a90872c4a","new_minutes_billed":3,"new_duration_seconds":180}
{"timestamp":"2025-09-22T09:59:30.987Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_ea789eb7-964a-4b81-b022-98e38c518bfc_min3_1758535170955","attempt_id":"bbd9e241-b441-40b7-b109-d71a90872c4a","minutes_billed":3}
{"timestamp":"2025-09-22T09:59:30.989Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_ea789eb7-964a-4b81-b022-98e38c518bfc_min3_1758535170955","transaction_duration_ms":19,"new_balance":1,"minute_billed":3,"total_minutes_billed_this_attempt":3,"total_successful":39,"total_minutes_billed_all_time":39,"avg_transaction_time":"17.59"}
{"timestamp":"2025-09-22T09:59:30.989Z","level":"WARN","service":"BillingService","message":"Low credits warning threshold reached","requestId":"bill_ea789eb7-964a-4b81-b022-98e38c518bfc_min3_1758535170955","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","credits_remaining":1,"minute_billed":3,"warning_threshold":2}
{"timestamp":"2025-09-22T09:59:30.989Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_ea789eb7-964a-4b81-b022-98e38c518bfc_min3_1758535170955","total_duration_ms":34,"transaction_duration_ms":19,"response":{"status":"warning","creditsRemaining":1,"minuteBilled":3,"totalMinutesBilled":3,"attemptId":"bbd9e241-b441-40b7-b109-d71a90872c4a","shouldTerminate":false,"message":"Low credits warning: 1 minute(s) remaining"}}
{"timestamp":"2025-09-22T10:00:05.661007","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_74bb6e03-1ae0-4290-8360-424df476e6d3_min3_1758535205665","correlation_token":"sim_e9aedc4d957d191018c284479e1241a2_1758535025260","conversation_id":"74bb6e03-1ae0-4290-8360-424df476e6d3","minute":3,"metrics_total_requests":59}
{"timestamp":"2025-09-22T10:00:05.666Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_74bb6e03-1ae0-4290-8360-424df476e6d3_min3_1758535205665","correlation_token":"sim_e9aedc4d957d191018c284479e1241a2_1758535025260"}
{"timestamp":"2025-09-22T10:00:05.676Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_74bb6e03-1ae0-4290-8360-424df476e6d3_min3_1758535205665","minute_requested":3,"minutes_already_billed":3,"attempt_id":"bbd9e241-b441-40b7-b109-d71a90872c4a"}
{"timestamp":"2025-09-22T10:00:05.676Z","level":"WARN","service":"BillingService","message":"Minute already billed - returning idempotent response","requestId":"bill_74bb6e03-1ae0-4290-8360-424df476e6d3_min3_1758535205665","minute_requested":3,"minutes_already_billed":3,"attempt_id":"bbd9e241-b441-40b7-b109-d71a90872c4a","total_duplicates":17}
{"timestamp":"2025-09-22T10:00:05.676Z","level":"INFO","service":"BillingService","message":"Returning idempotent response","requestId":"bill_74bb6e03-1ae0-4290-8360-424df476e6d3_min3_1758535205665","response":{"status":"continue","creditsRemaining":1,"minuteBilled":3,"totalMinutesBilled":3,"attemptId":"bbd9e241-b441-40b7-b109-d71a90872c4a","shouldTerminate":false,"message":"Already billed (idempotent response)"},"duration_ms":11}
{"timestamp":"2025-09-22T10:00:19.502427","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_47f19ad4-7c03-472c-b7a8-60c2a31ce3d7_min5_1758535219508","correlation_token":"sim_7a998722dfc1bc948cd49b1398196e6d_1758534162849","conversation_id":"47f19ad4-7c03-472c-b7a8-60c2a31ce3d7","minute":5,"metrics_total_requests":60}
{"timestamp":"2025-09-22T10:00:19.508Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_47f19ad4-7c03-472c-b7a8-60c2a31ce3d7_min5_1758535219508","correlation_token":"sim_7a998722dfc1bc948cd49b1398196e6d_1758534162849"}
{"timestamp":"2025-09-22T10:00:19.520Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_47f19ad4-7c03-472c-b7a8-60c2a31ce3d7_min5_1758535219508","minute_requested":5,"minutes_already_billed":6,"attempt_id":"efde8c5f-80c0-41fd-a720-9cb297138a14"}
{"timestamp":"2025-09-22T10:00:19.520Z","level":"WARN","service":"BillingService","message":"Minute already billed - returning idempotent response","requestId":"bill_47f19ad4-7c03-472c-b7a8-60c2a31ce3d7_min5_1758535219508","minute_requested":5,"minutes_already_billed":6,"attempt_id":"efde8c5f-80c0-41fd-a720-9cb297138a14","total_duplicates":18}
{"timestamp":"2025-09-22T10:00:19.520Z","level":"INFO","service":"BillingService","message":"Returning idempotent response","requestId":"bill_47f19ad4-7c03-472c-b7a8-60c2a31ce3d7_min5_1758535219508","response":{"status":"continue","creditsRemaining":1,"minuteBilled":5,"totalMinutesBilled":6,"attemptId":"efde8c5f-80c0-41fd-a720-9cb297138a14","shouldTerminate":false,"message":"Already billed (idempotent response)"},"duration_ms":12}
{"timestamp":"2025-09-22T10:00:30.993541","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_ea789eb7-964a-4b81-b022-98e38c518bfc_min4_1758535231000","correlation_token":"sim_e9aedc4d957d191018c284479e1241a2_1758535025260","conversation_id":"ea789eb7-964a-4b81-b022-98e38c518bfc","minute":4,"metrics_total_requests":61}
{"timestamp":"2025-09-22T10:00:31.000Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_ea789eb7-964a-4b81-b022-98e38c518bfc_min4_1758535231000","correlation_token":"sim_e9aedc4d957d191018c284479e1241a2_1758535025260"}
{"timestamp":"2025-09-22T10:00:31.013Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_ea789eb7-964a-4b81-b022-98e38c518bfc_min4_1758535231000","minute_requested":4,"minutes_already_billed":3,"attempt_id":"bbd9e241-b441-40b7-b109-d71a90872c4a"}
{"timestamp":"2025-09-22T10:00:31.013Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_ea789eb7-964a-4b81-b022-98e38c518bfc_min4_1758535231000","attempt_id":"bbd9e241-b441-40b7-b109-d71a90872c4a","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":1,"minutes_already_billed":3,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-22T10:00:31.013Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_ea789eb7-964a-4b81-b022-98e38c518bfc_min4_1758535231000","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":1,"expected_balance_after":0,"minute_to_bill":4}
{"timestamp":"2025-09-22T10:00:31.017Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_ea789eb7-964a-4b81-b022-98e38c518bfc_min4_1758535231000","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-22T10:00:31.019Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_ea789eb7-964a-4b81-b022-98e38c518bfc_min4_1758535231000","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":1,"new_balance":0,"change":-1}
{"timestamp":"2025-09-22T10:00:31.019Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_ea789eb7-964a-4b81-b022-98e38c518bfc_min4_1758535231000","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":0,"minute":4}
{"timestamp":"2025-09-22T10:00:31.022Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_ea789eb7-964a-4b81-b022-98e38c518bfc_min4_1758535231000","transaction_id":"0c5391a5-12d6-4024-8a0c-097b8e4c6160","transaction_type":"DEBIT","balance_after":0}
{"timestamp":"2025-09-22T10:00:31.022Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_ea789eb7-964a-4b81-b022-98e38c518bfc_min4_1758535231000","attempt_id":"bbd9e241-b441-40b7-b109-d71a90872c4a","new_minutes_billed":4,"new_duration_seconds":240}
{"timestamp":"2025-09-22T10:00:31.025Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_ea789eb7-964a-4b81-b022-98e38c518bfc_min4_1758535231000","attempt_id":"bbd9e241-b441-40b7-b109-d71a90872c4a","minutes_billed":4}
{"timestamp":"2025-09-22T10:00:31.027Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_ea789eb7-964a-4b81-b022-98e38c518bfc_min4_1758535231000","transaction_duration_ms":14,"new_balance":0,"minute_billed":4,"total_minutes_billed_this_attempt":4,"total_successful":40,"total_minutes_billed_all_time":40,"avg_transaction_time":"17.50"}
{"timestamp":"2025-09-22T10:00:31.027Z","level":"WARN","service":"BillingService","message":"Last credit used - will terminate conversation","requestId":"bill_ea789eb7-964a-4b81-b022-98e38c518bfc_min4_1758535231000","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","minute_billed":4,"total_minutes_this_session":4}
{"timestamp":"2025-09-22T10:00:31.027Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_ea789eb7-964a-4b81-b022-98e38c518bfc_min4_1758535231000","total_duration_ms":27,"transaction_duration_ms":14,"response":{"status":"terminate","creditsRemaining":0,"minuteBilled":4,"totalMinutesBilled":4,"attemptId":"bbd9e241-b441-40b7-b109-d71a90872c4a","shouldTerminate":true,"message":"Last credit used - conversation will end","gracePeriodSeconds":60}}
{"timestamp":"2025-09-22T10:01:05.680182","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_74bb6e03-1ae0-4290-8360-424df476e6d3_min4_1758535265685","correlation_token":"sim_e9aedc4d957d191018c284479e1241a2_1758535025260","conversation_id":"74bb6e03-1ae0-4290-8360-424df476e6d3","minute":4,"metrics_total_requests":62}
{"timestamp":"2025-09-22T10:01:05.686Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_74bb6e03-1ae0-4290-8360-424df476e6d3_min4_1758535265685","correlation_token":"sim_e9aedc4d957d191018c284479e1241a2_1758535025260"}
{"timestamp":"2025-09-22T10:01:05.698Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_74bb6e03-1ae0-4290-8360-424df476e6d3_min4_1758535265685","minute_requested":4,"minutes_already_billed":4,"attempt_id":"bbd9e241-b441-40b7-b109-d71a90872c4a"}
{"timestamp":"2025-09-22T10:01:05.698Z","level":"WARN","service":"BillingService","message":"Minute already billed - returning idempotent response","requestId":"bill_74bb6e03-1ae0-4290-8360-424df476e6d3_min4_1758535265685","minute_requested":4,"minutes_already_billed":4,"attempt_id":"bbd9e241-b441-40b7-b109-d71a90872c4a","total_duplicates":19}
{"timestamp":"2025-09-22T10:01:05.699Z","level":"INFO","service":"BillingService","message":"Returning idempotent response","requestId":"bill_74bb6e03-1ae0-4290-8360-424df476e6d3_min4_1758535265685","response":{"status":"continue","creditsRemaining":0,"minuteBilled":4,"totalMinutesBilled":4,"attemptId":"bbd9e241-b441-40b7-b109-d71a90872c4a","shouldTerminate":false,"message":"Already billed (idempotent response)"},"duration_ms":14}
{"timestamp":"2025-09-22T10:01:19.523377","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_47f19ad4-7c03-472c-b7a8-60c2a31ce3d7_min6_1758535279529","correlation_token":"sim_7a998722dfc1bc948cd49b1398196e6d_1758534162849","conversation_id":"47f19ad4-7c03-472c-b7a8-60c2a31ce3d7","minute":6,"metrics_total_requests":63}
{"timestamp":"2025-09-22T10:01:19.530Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_47f19ad4-7c03-472c-b7a8-60c2a31ce3d7_min6_1758535279529","correlation_token":"sim_7a998722dfc1bc948cd49b1398196e6d_1758534162849"}
{"timestamp":"2025-09-22T10:01:19.543Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_47f19ad4-7c03-472c-b7a8-60c2a31ce3d7_min6_1758535279529","minute_requested":6,"minutes_already_billed":6,"attempt_id":"efde8c5f-80c0-41fd-a720-9cb297138a14"}
{"timestamp":"2025-09-22T10:01:19.543Z","level":"WARN","service":"BillingService","message":"Minute already billed - returning idempotent response","requestId":"bill_47f19ad4-7c03-472c-b7a8-60c2a31ce3d7_min6_1758535279529","minute_requested":6,"minutes_already_billed":6,"attempt_id":"efde8c5f-80c0-41fd-a720-9cb297138a14","total_duplicates":20}
{"timestamp":"2025-09-22T10:01:19.543Z","level":"INFO","service":"BillingService","message":"Returning idempotent response","requestId":"bill_47f19ad4-7c03-472c-b7a8-60c2a31ce3d7_min6_1758535279529","response":{"status":"continue","creditsRemaining":0,"minuteBilled":6,"totalMinutesBilled":6,"attemptId":"efde8c5f-80c0-41fd-a720-9cb297138a14","shouldTerminate":false,"message":"Already billed (idempotent response)"},"duration_ms":14}
{"timestamp":"2025-09-22T10:01:31.033073","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_ea789eb7-964a-4b81-b022-98e38c518bfc_min5_1758535291037","correlation_token":"sim_e9aedc4d957d191018c284479e1241a2_1758535025260","conversation_id":"ea789eb7-964a-4b81-b022-98e38c518bfc","minute":5,"metrics_total_requests":64}
{"timestamp":"2025-09-22T10:01:31.037Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_ea789eb7-964a-4b81-b022-98e38c518bfc_min5_1758535291037","correlation_token":"sim_e9aedc4d957d191018c284479e1241a2_1758535025260"}
{"timestamp":"2025-09-22T10:01:31.050Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_ea789eb7-964a-4b81-b022-98e38c518bfc_min5_1758535291037","minute_requested":5,"minutes_already_billed":4,"attempt_id":"bbd9e241-b441-40b7-b109-d71a90872c4a"}
{"timestamp":"2025-09-22T10:01:31.050Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_ea789eb7-964a-4b81-b022-98e38c518bfc_min5_1758535291037","attempt_id":"bbd9e241-b441-40b7-b109-d71a90872c4a","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":0,"minutes_already_billed":4,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-22T10:01:31.050Z","level":"WARN","service":"BillingService","message":"Insufficient credits detected","requestId":"bill_ea789eb7-964a-4b81-b022-98e38c518bfc_min5_1758535291037","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_email":"john.doe@example.com","current_balance":0,"required":1,"minutes_billed":4,"total_insufficient_events":4}
{"timestamp":"2025-09-22T10:02:05.703206","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_74bb6e03-1ae0-4290-8360-424df476e6d3_min5_1758535325709","correlation_token":"sim_e9aedc4d957d191018c284479e1241a2_1758535025260","conversation_id":"74bb6e03-1ae0-4290-8360-424df476e6d3","minute":5,"metrics_total_requests":65}
{"timestamp":"2025-09-22T10:02:05.710Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_74bb6e03-1ae0-4290-8360-424df476e6d3_min5_1758535325709","correlation_token":"sim_e9aedc4d957d191018c284479e1241a2_1758535025260"}
{"timestamp":"2025-09-22T10:02:05.721Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_74bb6e03-1ae0-4290-8360-424df476e6d3_min5_1758535325709","minute_requested":5,"minutes_already_billed":4,"attempt_id":"bbd9e241-b441-40b7-b109-d71a90872c4a"}
{"timestamp":"2025-09-22T10:02:05.721Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_74bb6e03-1ae0-4290-8360-424df476e6d3_min5_1758535325709","attempt_id":"bbd9e241-b441-40b7-b109-d71a90872c4a","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":0,"minutes_already_billed":4,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-22T10:02:05.721Z","level":"WARN","service":"BillingService","message":"Insufficient credits detected","requestId":"bill_74bb6e03-1ae0-4290-8360-424df476e6d3_min5_1758535325709","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_email":"john.doe@example.com","current_balance":0,"required":1,"minutes_billed":4,"total_insufficient_events":5}
{"timestamp":"2025-09-22T11:21:32.587Z","level":"INFO","service":"BillingService","message":"BillingService initialized","environment":"development","database_url":"configured"}
{"timestamp":"2025-09-22T11:22:04.051Z","level":"INFO","service":"BillingService","message":"BillingService initialized","environment":"development","database_url":"configured"}
{"timestamp":"2025-09-22T11:32:43.253798","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_2f4ab2d2-724f-4a5a-824d-ca17c2e37561_min1_1758540763259","correlation_token":"sim_80aa5b3f44f5691f53187cc0955b2050_1758540761970","conversation_id":"2f4ab2d2-724f-4a5a-824d-ca17c2e37561","minute":1,"metrics_total_requests":1}
{"timestamp":"2025-09-22T11:32:43.259Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_2f4ab2d2-724f-4a5a-824d-ca17c2e37561_min1_1758540763259","correlation_token":"sim_80aa5b3f44f5691f53187cc0955b2050_1758540761970"}
{"timestamp":"2025-09-22T11:32:43.267Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_2f4ab2d2-724f-4a5a-824d-ca17c2e37561_min1_1758540763259","minute_requested":1,"minutes_already_billed":0,"attempt_id":"88493a8f-f908-47ae-97d8-06fe8ff912b1"}
{"timestamp":"2025-09-22T11:32:43.267Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_2f4ab2d2-724f-4a5a-824d-ca17c2e37561_min1_1758540763259","attempt_id":"88493a8f-f908-47ae-97d8-06fe8ff912b1","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":10,"minutes_already_billed":0,"simulation_id":"a1ca69e6-7d0b-4c29-a4fc-4d749d89c598","case_title":"demo case"}
{"timestamp":"2025-09-22T11:32:43.268Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_2f4ab2d2-724f-4a5a-824d-ca17c2e37561_min1_1758540763259","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":10,"expected_balance_after":9,"minute_to_bill":1}
{"timestamp":"2025-09-22T11:32:43.271Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_2f4ab2d2-724f-4a5a-824d-ca17c2e37561_min1_1758540763259","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-22T11:32:43.274Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_2f4ab2d2-724f-4a5a-824d-ca17c2e37561_min1_1758540763259","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":10,"new_balance":9,"change":-1}
{"timestamp":"2025-09-22T11:32:43.274Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_2f4ab2d2-724f-4a5a-824d-ca17c2e37561_min1_1758540763259","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":9,"minute":1}
{"timestamp":"2025-09-22T11:32:43.276Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_2f4ab2d2-724f-4a5a-824d-ca17c2e37561_min1_1758540763259","transaction_id":"17d2619c-f0da-4484-985c-c06d7abcf3a4","transaction_type":"DEBIT","balance_after":9}
{"timestamp":"2025-09-22T11:32:43.277Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_2f4ab2d2-724f-4a5a-824d-ca17c2e37561_min1_1758540763259","attempt_id":"88493a8f-f908-47ae-97d8-06fe8ff912b1","new_minutes_billed":1,"new_duration_seconds":60}
{"timestamp":"2025-09-22T11:32:43.278Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_2f4ab2d2-724f-4a5a-824d-ca17c2e37561_min1_1758540763259","attempt_id":"88493a8f-f908-47ae-97d8-06fe8ff912b1","minutes_billed":1}
{"timestamp":"2025-09-22T11:32:43.279Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_2f4ab2d2-724f-4a5a-824d-ca17c2e37561_min1_1758540763259","transaction_duration_ms":11,"new_balance":9,"minute_billed":1,"total_minutes_billed_this_attempt":1,"total_successful":1,"total_minutes_billed_all_time":1,"avg_transaction_time":"11.00"}
{"timestamp":"2025-09-22T11:32:43.280Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_2f4ab2d2-724f-4a5a-824d-ca17c2e37561_min1_1758540763259","total_duration_ms":21,"transaction_duration_ms":11,"response":{"status":"continue","creditsRemaining":9,"minuteBilled":1,"totalMinutesBilled":1,"attemptId":"88493a8f-f908-47ae-97d8-06fe8ff912b1","shouldTerminate":false}}
{"timestamp":"2025-09-22T11:33:43.285363","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_2f4ab2d2-724f-4a5a-824d-ca17c2e37561_min2_1758540823291","correlation_token":"sim_80aa5b3f44f5691f53187cc0955b2050_1758540761970","conversation_id":"2f4ab2d2-724f-4a5a-824d-ca17c2e37561","minute":2,"metrics_total_requests":2}
{"timestamp":"2025-09-22T11:33:43.291Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_2f4ab2d2-724f-4a5a-824d-ca17c2e37561_min2_1758540823291","correlation_token":"sim_80aa5b3f44f5691f53187cc0955b2050_1758540761970"}
{"timestamp":"2025-09-22T11:33:43.307Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_2f4ab2d2-724f-4a5a-824d-ca17c2e37561_min2_1758540823291","minute_requested":2,"minutes_already_billed":1,"attempt_id":"88493a8f-f908-47ae-97d8-06fe8ff912b1"}
{"timestamp":"2025-09-22T11:33:43.307Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_2f4ab2d2-724f-4a5a-824d-ca17c2e37561_min2_1758540823291","attempt_id":"88493a8f-f908-47ae-97d8-06fe8ff912b1","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":9,"minutes_already_billed":1,"simulation_id":"a1ca69e6-7d0b-4c29-a4fc-4d749d89c598","case_title":"demo case"}
{"timestamp":"2025-09-22T11:33:43.307Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_2f4ab2d2-724f-4a5a-824d-ca17c2e37561_min2_1758540823291","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":9,"expected_balance_after":8,"minute_to_bill":2}
{"timestamp":"2025-09-22T11:33:43.312Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_2f4ab2d2-724f-4a5a-824d-ca17c2e37561_min2_1758540823291","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-22T11:33:43.315Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_2f4ab2d2-724f-4a5a-824d-ca17c2e37561_min2_1758540823291","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":9,"new_balance":8,"change":-1}
{"timestamp":"2025-09-22T11:33:43.315Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_2f4ab2d2-724f-4a5a-824d-ca17c2e37561_min2_1758540823291","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":8,"minute":2}
{"timestamp":"2025-09-22T11:33:43.317Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_2f4ab2d2-724f-4a5a-824d-ca17c2e37561_min2_1758540823291","transaction_id":"542d5090-2086-42ba-ab80-1fdc64850bc9","transaction_type":"DEBIT","balance_after":8}
{"timestamp":"2025-09-22T11:33:43.317Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_2f4ab2d2-724f-4a5a-824d-ca17c2e37561_min2_1758540823291","attempt_id":"88493a8f-f908-47ae-97d8-06fe8ff912b1","new_minutes_billed":2,"new_duration_seconds":120}
{"timestamp":"2025-09-22T11:33:43.319Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_2f4ab2d2-724f-4a5a-824d-ca17c2e37561_min2_1758540823291","attempt_id":"88493a8f-f908-47ae-97d8-06fe8ff912b1","minutes_billed":2}
{"timestamp":"2025-09-22T11:33:43.321Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_2f4ab2d2-724f-4a5a-824d-ca17c2e37561_min2_1758540823291","transaction_duration_ms":14,"new_balance":8,"minute_billed":2,"total_minutes_billed_this_attempt":2,"total_successful":2,"total_minutes_billed_all_time":2,"avg_transaction_time":"12.50"}
{"timestamp":"2025-09-22T11:33:43.321Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_2f4ab2d2-724f-4a5a-824d-ca17c2e37561_min2_1758540823291","total_duration_ms":30,"transaction_duration_ms":14,"response":{"status":"continue","creditsRemaining":8,"minuteBilled":2,"totalMinutesBilled":2,"attemptId":"88493a8f-f908-47ae-97d8-06fe8ff912b1","shouldTerminate":false}}
{"timestamp":"2025-09-22T11:34:03.032823","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_d35fa990-20fb-4f2a-86bd-10b18852c24c_min1_1758540843034","correlation_token":"sim_f5c37d129a237f73db5c05827eb7b6d7_1758540842652","conversation_id":"d35fa990-20fb-4f2a-86bd-10b18852c24c","minute":1,"metrics_total_requests":3}
{"timestamp":"2025-09-22T11:34:03.034Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_d35fa990-20fb-4f2a-86bd-10b18852c24c_min1_1758540843034","correlation_token":"sim_f5c37d129a237f73db5c05827eb7b6d7_1758540842652"}
{"timestamp":"2025-09-22T11:34:03.042Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_d35fa990-20fb-4f2a-86bd-10b18852c24c_min1_1758540843034","minute_requested":1,"minutes_already_billed":0,"attempt_id":"91bb8001-4992-46e0-95ac-5833336188c6"}
{"timestamp":"2025-09-22T11:34:03.042Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_d35fa990-20fb-4f2a-86bd-10b18852c24c_min1_1758540843034","attempt_id":"91bb8001-4992-46e0-95ac-5833336188c6","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":8,"minutes_already_billed":0,"simulation_id":"a1ca69e6-7d0b-4c29-a4fc-4d749d89c598","case_title":"demo case"}
{"timestamp":"2025-09-22T11:34:03.042Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_d35fa990-20fb-4f2a-86bd-10b18852c24c_min1_1758540843034","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":8,"expected_balance_after":7,"minute_to_bill":1}
{"timestamp":"2025-09-22T11:34:03.044Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_d35fa990-20fb-4f2a-86bd-10b18852c24c_min1_1758540843034","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-22T11:34:03.046Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_d35fa990-20fb-4f2a-86bd-10b18852c24c_min1_1758540843034","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":8,"new_balance":7,"change":-1}
{"timestamp":"2025-09-22T11:34:03.046Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_d35fa990-20fb-4f2a-86bd-10b18852c24c_min1_1758540843034","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":7,"minute":1}
{"timestamp":"2025-09-22T11:34:03.048Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_d35fa990-20fb-4f2a-86bd-10b18852c24c_min1_1758540843034","transaction_id":"8cbdb80b-2a2f-45fd-88bd-9277602aca7d","transaction_type":"DEBIT","balance_after":7}
{"timestamp":"2025-09-22T11:34:03.048Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_d35fa990-20fb-4f2a-86bd-10b18852c24c_min1_1758540843034","attempt_id":"91bb8001-4992-46e0-95ac-5833336188c6","new_minutes_billed":1,"new_duration_seconds":60}
{"timestamp":"2025-09-22T11:34:03.050Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_d35fa990-20fb-4f2a-86bd-10b18852c24c_min1_1758540843034","attempt_id":"91bb8001-4992-46e0-95ac-5833336188c6","minutes_billed":1}
{"timestamp":"2025-09-22T11:34:03.051Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_d35fa990-20fb-4f2a-86bd-10b18852c24c_min1_1758540843034","transaction_duration_ms":9,"new_balance":7,"minute_billed":1,"total_minutes_billed_this_attempt":1,"total_successful":3,"total_minutes_billed_all_time":3,"avg_transaction_time":"11.33"}
{"timestamp":"2025-09-22T11:34:03.051Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_d35fa990-20fb-4f2a-86bd-10b18852c24c_min1_1758540843034","total_duration_ms":17,"transaction_duration_ms":9,"response":{"status":"continue","creditsRemaining":7,"minuteBilled":1,"totalMinutesBilled":1,"attemptId":"91bb8001-4992-46e0-95ac-5833336188c6","shouldTerminate":false}}
{"timestamp":"2025-09-22T11:34:43.325293","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_2f4ab2d2-724f-4a5a-824d-ca17c2e37561_min3_1758540883326","correlation_token":"sim_80aa5b3f44f5691f53187cc0955b2050_1758540761970","conversation_id":"2f4ab2d2-724f-4a5a-824d-ca17c2e37561","minute":3,"metrics_total_requests":4}
{"timestamp":"2025-09-22T11:34:43.326Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_2f4ab2d2-724f-4a5a-824d-ca17c2e37561_min3_1758540883326","correlation_token":"sim_80aa5b3f44f5691f53187cc0955b2050_1758540761970"}
{"timestamp":"2025-09-22T11:34:43.334Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_2f4ab2d2-724f-4a5a-824d-ca17c2e37561_min3_1758540883326","minute_requested":3,"minutes_already_billed":2,"attempt_id":"88493a8f-f908-47ae-97d8-06fe8ff912b1"}
{"timestamp":"2025-09-22T11:34:43.334Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_2f4ab2d2-724f-4a5a-824d-ca17c2e37561_min3_1758540883326","attempt_id":"88493a8f-f908-47ae-97d8-06fe8ff912b1","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":7,"minutes_already_billed":2,"simulation_id":"a1ca69e6-7d0b-4c29-a4fc-4d749d89c598","case_title":"demo case"}
{"timestamp":"2025-09-22T11:34:43.334Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_2f4ab2d2-724f-4a5a-824d-ca17c2e37561_min3_1758540883326","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":7,"expected_balance_after":6,"minute_to_bill":3}
{"timestamp":"2025-09-22T11:34:43.337Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_2f4ab2d2-724f-4a5a-824d-ca17c2e37561_min3_1758540883326","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-22T11:34:43.338Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_2f4ab2d2-724f-4a5a-824d-ca17c2e37561_min3_1758540883326","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":7,"new_balance":6,"change":-1}
{"timestamp":"2025-09-22T11:34:43.339Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_2f4ab2d2-724f-4a5a-824d-ca17c2e37561_min3_1758540883326","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":6,"minute":3}
{"timestamp":"2025-09-22T11:34:43.340Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_2f4ab2d2-724f-4a5a-824d-ca17c2e37561_min3_1758540883326","transaction_id":"68d1d55a-43fb-4359-ac8c-491f5929a4c5","transaction_type":"DEBIT","balance_after":6}
{"timestamp":"2025-09-22T11:34:43.340Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_2f4ab2d2-724f-4a5a-824d-ca17c2e37561_min3_1758540883326","attempt_id":"88493a8f-f908-47ae-97d8-06fe8ff912b1","new_minutes_billed":3,"new_duration_seconds":180}
{"timestamp":"2025-09-22T11:34:43.342Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_2f4ab2d2-724f-4a5a-824d-ca17c2e37561_min3_1758540883326","attempt_id":"88493a8f-f908-47ae-97d8-06fe8ff912b1","minutes_billed":3}
{"timestamp":"2025-09-22T11:34:43.343Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_2f4ab2d2-724f-4a5a-824d-ca17c2e37561_min3_1758540883326","transaction_duration_ms":9,"new_balance":6,"minute_billed":3,"total_minutes_billed_this_attempt":3,"total_successful":4,"total_minutes_billed_all_time":4,"avg_transaction_time":"10.75"}
{"timestamp":"2025-09-22T11:34:43.343Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_2f4ab2d2-724f-4a5a-824d-ca17c2e37561_min3_1758540883326","total_duration_ms":17,"transaction_duration_ms":9,"response":{"status":"continue","creditsRemaining":6,"minuteBilled":3,"totalMinutesBilled":3,"attemptId":"88493a8f-f908-47ae-97d8-06fe8ff912b1","shouldTerminate":false}}
{"timestamp":"2025-09-22T11:35:03.055511","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_d35fa990-20fb-4f2a-86bd-10b18852c24c_min2_1758540903058","correlation_token":"sim_f5c37d129a237f73db5c05827eb7b6d7_1758540842652","conversation_id":"d35fa990-20fb-4f2a-86bd-10b18852c24c","minute":2,"metrics_total_requests":5}
{"timestamp":"2025-09-22T11:35:03.058Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_d35fa990-20fb-4f2a-86bd-10b18852c24c_min2_1758540903058","correlation_token":"sim_f5c37d129a237f73db5c05827eb7b6d7_1758540842652"}
{"timestamp":"2025-09-22T11:35:03.071Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_d35fa990-20fb-4f2a-86bd-10b18852c24c_min2_1758540903058","minute_requested":2,"minutes_already_billed":1,"attempt_id":"91bb8001-4992-46e0-95ac-5833336188c6"}
{"timestamp":"2025-09-22T11:35:03.071Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_d35fa990-20fb-4f2a-86bd-10b18852c24c_min2_1758540903058","attempt_id":"91bb8001-4992-46e0-95ac-5833336188c6","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":6,"minutes_already_billed":1,"simulation_id":"a1ca69e6-7d0b-4c29-a4fc-4d749d89c598","case_title":"demo case"}
{"timestamp":"2025-09-22T11:35:03.071Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_d35fa990-20fb-4f2a-86bd-10b18852c24c_min2_1758540903058","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":6,"expected_balance_after":5,"minute_to_bill":2}
{"timestamp":"2025-09-22T11:35:03.076Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_d35fa990-20fb-4f2a-86bd-10b18852c24c_min2_1758540903058","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-22T11:35:03.080Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_d35fa990-20fb-4f2a-86bd-10b18852c24c_min2_1758540903058","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":6,"new_balance":5,"change":-1}
{"timestamp":"2025-09-22T11:35:03.080Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_d35fa990-20fb-4f2a-86bd-10b18852c24c_min2_1758540903058","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":5,"minute":2}
{"timestamp":"2025-09-22T11:35:03.084Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_d35fa990-20fb-4f2a-86bd-10b18852c24c_min2_1758540903058","transaction_id":"a171b64f-ed3d-421d-bb27-6929055d7f5a","transaction_type":"DEBIT","balance_after":5}
{"timestamp":"2025-09-22T11:35:03.084Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_d35fa990-20fb-4f2a-86bd-10b18852c24c_min2_1758540903058","attempt_id":"91bb8001-4992-46e0-95ac-5833336188c6","new_minutes_billed":2,"new_duration_seconds":120}
{"timestamp":"2025-09-22T11:35:03.086Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_d35fa990-20fb-4f2a-86bd-10b18852c24c_min2_1758540903058","attempt_id":"91bb8001-4992-46e0-95ac-5833336188c6","minutes_billed":2}
{"timestamp":"2025-09-22T11:35:03.088Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_d35fa990-20fb-4f2a-86bd-10b18852c24c_min2_1758540903058","transaction_duration_ms":17,"new_balance":5,"minute_billed":2,"total_minutes_billed_this_attempt":2,"total_successful":5,"total_minutes_billed_all_time":5,"avg_transaction_time":"12.00"}
{"timestamp":"2025-09-22T11:35:03.088Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_d35fa990-20fb-4f2a-86bd-10b18852c24c_min2_1758540903058","total_duration_ms":30,"transaction_duration_ms":17,"response":{"status":"continue","creditsRemaining":5,"minuteBilled":2,"totalMinutesBilled":2,"attemptId":"91bb8001-4992-46e0-95ac-5833336188c6","shouldTerminate":false}}
{"timestamp":"2025-09-22T11:35:06.512365","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_2fbe5c29-45ba-4913-8d6f-6d83d9cd7649_min1_1758540906513","correlation_token":"sim_c1252c275bfeffd01d758a66404304b2_1758540906220","conversation_id":"2fbe5c29-45ba-4913-8d6f-6d83d9cd7649","minute":1,"metrics_total_requests":6}
{"timestamp":"2025-09-22T11:35:06.513Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_2fbe5c29-45ba-4913-8d6f-6d83d9cd7649_min1_1758540906513","correlation_token":"sim_c1252c275bfeffd01d758a66404304b2_1758540906220"}
{"timestamp":"2025-09-22T11:35:06.520Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_2fbe5c29-45ba-4913-8d6f-6d83d9cd7649_min1_1758540906513","minute_requested":1,"minutes_already_billed":0,"attempt_id":"db718599-4168-4508-9b9d-813ca61966bd"}
{"timestamp":"2025-09-22T11:35:06.520Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_2fbe5c29-45ba-4913-8d6f-6d83d9cd7649_min1_1758540906513","attempt_id":"db718599-4168-4508-9b9d-813ca61966bd","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":5,"minutes_already_billed":0,"simulation_id":"a1ca69e6-7d0b-4c29-a4fc-4d749d89c598","case_title":"demo case"}
{"timestamp":"2025-09-22T11:35:06.520Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_2fbe5c29-45ba-4913-8d6f-6d83d9cd7649_min1_1758540906513","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":5,"expected_balance_after":4,"minute_to_bill":1}
{"timestamp":"2025-09-22T11:35:06.524Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_2fbe5c29-45ba-4913-8d6f-6d83d9cd7649_min1_1758540906513","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-22T11:35:06.526Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_2fbe5c29-45ba-4913-8d6f-6d83d9cd7649_min1_1758540906513","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":5,"new_balance":4,"change":-1}
{"timestamp":"2025-09-22T11:35:06.526Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_2fbe5c29-45ba-4913-8d6f-6d83d9cd7649_min1_1758540906513","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":4,"minute":1}
{"timestamp":"2025-09-22T11:35:06.528Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_2fbe5c29-45ba-4913-8d6f-6d83d9cd7649_min1_1758540906513","transaction_id":"13ff8a61-f26d-47c6-9976-232002ee8ec2","transaction_type":"DEBIT","balance_after":4}
{"timestamp":"2025-09-22T11:35:06.528Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_2fbe5c29-45ba-4913-8d6f-6d83d9cd7649_min1_1758540906513","attempt_id":"db718599-4168-4508-9b9d-813ca61966bd","new_minutes_billed":1,"new_duration_seconds":60}
{"timestamp":"2025-09-22T11:35:06.530Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_2fbe5c29-45ba-4913-8d6f-6d83d9cd7649_min1_1758540906513","attempt_id":"db718599-4168-4508-9b9d-813ca61966bd","minutes_billed":1}
{"timestamp":"2025-09-22T11:35:06.531Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_2fbe5c29-45ba-4913-8d6f-6d83d9cd7649_min1_1758540906513","transaction_duration_ms":11,"new_balance":4,"minute_billed":1,"total_minutes_billed_this_attempt":1,"total_successful":6,"total_minutes_billed_all_time":6,"avg_transaction_time":"11.83"}
{"timestamp":"2025-09-22T11:35:06.531Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_2fbe5c29-45ba-4913-8d6f-6d83d9cd7649_min1_1758540906513","total_duration_ms":18,"transaction_duration_ms":11,"response":{"status":"continue","creditsRemaining":4,"minuteBilled":1,"totalMinutesBilled":1,"attemptId":"db718599-4168-4508-9b9d-813ca61966bd","shouldTerminate":false}}
{"timestamp":"2025-09-22T11:35:43.346158","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_2f4ab2d2-724f-4a5a-824d-ca17c2e37561_min4_1758540943357","correlation_token":"sim_80aa5b3f44f5691f53187cc0955b2050_1758540761970","conversation_id":"2f4ab2d2-724f-4a5a-824d-ca17c2e37561","minute":4,"metrics_total_requests":7}
{"timestamp":"2025-09-22T11:35:43.357Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_2f4ab2d2-724f-4a5a-824d-ca17c2e37561_min4_1758540943357","correlation_token":"sim_80aa5b3f44f5691f53187cc0955b2050_1758540761970"}
{"timestamp":"2025-09-22T11:35:43.373Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_2f4ab2d2-724f-4a5a-824d-ca17c2e37561_min4_1758540943357","minute_requested":4,"minutes_already_billed":3,"attempt_id":"88493a8f-f908-47ae-97d8-06fe8ff912b1"}
{"timestamp":"2025-09-22T11:35:43.373Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_2f4ab2d2-724f-4a5a-824d-ca17c2e37561_min4_1758540943357","attempt_id":"88493a8f-f908-47ae-97d8-06fe8ff912b1","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":4,"minutes_already_billed":3,"simulation_id":"a1ca69e6-7d0b-4c29-a4fc-4d749d89c598","case_title":"demo case"}
{"timestamp":"2025-09-22T11:35:43.373Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_2f4ab2d2-724f-4a5a-824d-ca17c2e37561_min4_1758540943357","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":4,"expected_balance_after":3,"minute_to_bill":4}
{"timestamp":"2025-09-22T11:35:43.379Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_2f4ab2d2-724f-4a5a-824d-ca17c2e37561_min4_1758540943357","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-22T11:35:43.383Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_2f4ab2d2-724f-4a5a-824d-ca17c2e37561_min4_1758540943357","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":4,"new_balance":3,"change":-1}
{"timestamp":"2025-09-22T11:35:43.383Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_2f4ab2d2-724f-4a5a-824d-ca17c2e37561_min4_1758540943357","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":3,"minute":4}
{"timestamp":"2025-09-22T11:35:43.386Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_2f4ab2d2-724f-4a5a-824d-ca17c2e37561_min4_1758540943357","transaction_id":"82f13c97-b90e-4102-b1ba-1fb8acc424b4","transaction_type":"DEBIT","balance_after":3}
{"timestamp":"2025-09-22T11:35:43.386Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_2f4ab2d2-724f-4a5a-824d-ca17c2e37561_min4_1758540943357","attempt_id":"88493a8f-f908-47ae-97d8-06fe8ff912b1","new_minutes_billed":4,"new_duration_seconds":240}
{"timestamp":"2025-09-22T11:35:43.390Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_2f4ab2d2-724f-4a5a-824d-ca17c2e37561_min4_1758540943357","attempt_id":"88493a8f-f908-47ae-97d8-06fe8ff912b1","minutes_billed":4}
{"timestamp":"2025-09-22T11:35:43.391Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_2f4ab2d2-724f-4a5a-824d-ca17c2e37561_min4_1758540943357","transaction_duration_ms":18,"new_balance":3,"minute_billed":4,"total_minutes_billed_this_attempt":4,"total_successful":7,"total_minutes_billed_all_time":7,"avg_transaction_time":"12.71"}
{"timestamp":"2025-09-22T11:35:43.392Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_2f4ab2d2-724f-4a5a-824d-ca17c2e37561_min4_1758540943357","total_duration_ms":35,"transaction_duration_ms":18,"response":{"status":"continue","creditsRemaining":3,"minuteBilled":4,"totalMinutesBilled":4,"attemptId":"88493a8f-f908-47ae-97d8-06fe8ff912b1","shouldTerminate":false}}
{"timestamp":"2025-09-22T11:36:03.093054","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_d35fa990-20fb-4f2a-86bd-10b18852c24c_min3_1758540963097","correlation_token":"sim_f5c37d129a237f73db5c05827eb7b6d7_1758540842652","conversation_id":"d35fa990-20fb-4f2a-86bd-10b18852c24c","minute":3,"metrics_total_requests":8}
{"timestamp":"2025-09-22T11:36:03.097Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_d35fa990-20fb-4f2a-86bd-10b18852c24c_min3_1758540963097","correlation_token":"sim_f5c37d129a237f73db5c05827eb7b6d7_1758540842652"}
{"timestamp":"2025-09-22T11:36:03.110Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_d35fa990-20fb-4f2a-86bd-10b18852c24c_min3_1758540963097","minute_requested":3,"minutes_already_billed":2,"attempt_id":"91bb8001-4992-46e0-95ac-5833336188c6"}
{"timestamp":"2025-09-22T11:36:03.110Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_d35fa990-20fb-4f2a-86bd-10b18852c24c_min3_1758540963097","attempt_id":"91bb8001-4992-46e0-95ac-5833336188c6","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":3,"minutes_already_billed":2,"simulation_id":"a1ca69e6-7d0b-4c29-a4fc-4d749d89c598","case_title":"demo case"}
{"timestamp":"2025-09-22T11:36:03.110Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_d35fa990-20fb-4f2a-86bd-10b18852c24c_min3_1758540963097","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":3,"expected_balance_after":2,"minute_to_bill":3}
{"timestamp":"2025-09-22T11:36:03.114Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_d35fa990-20fb-4f2a-86bd-10b18852c24c_min3_1758540963097","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-22T11:36:03.117Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_d35fa990-20fb-4f2a-86bd-10b18852c24c_min3_1758540963097","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":3,"new_balance":2,"change":-1}
{"timestamp":"2025-09-22T11:36:03.117Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_d35fa990-20fb-4f2a-86bd-10b18852c24c_min3_1758540963097","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":2,"minute":3}
{"timestamp":"2025-09-22T11:36:03.120Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_d35fa990-20fb-4f2a-86bd-10b18852c24c_min3_1758540963097","transaction_id":"4ae38bcc-8af8-483d-814d-e13875b90c28","transaction_type":"DEBIT","balance_after":2}
{"timestamp":"2025-09-22T11:36:03.120Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_d35fa990-20fb-4f2a-86bd-10b18852c24c_min3_1758540963097","attempt_id":"91bb8001-4992-46e0-95ac-5833336188c6","new_minutes_billed":3,"new_duration_seconds":180}
{"timestamp":"2025-09-22T11:36:03.123Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_d35fa990-20fb-4f2a-86bd-10b18852c24c_min3_1758540963097","attempt_id":"91bb8001-4992-46e0-95ac-5833336188c6","minutes_billed":3}
{"timestamp":"2025-09-22T11:36:03.124Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_d35fa990-20fb-4f2a-86bd-10b18852c24c_min3_1758540963097","transaction_duration_ms":14,"new_balance":2,"minute_billed":3,"total_minutes_billed_this_attempt":3,"total_successful":8,"total_minutes_billed_all_time":8,"avg_transaction_time":"12.88"}
{"timestamp":"2025-09-22T11:36:03.124Z","level":"WARN","service":"BillingService","message":"Low credits warning threshold reached","requestId":"bill_d35fa990-20fb-4f2a-86bd-10b18852c24c_min3_1758540963097","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","credits_remaining":2,"minute_billed":3,"warning_threshold":2}
{"timestamp":"2025-09-22T11:36:03.124Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_d35fa990-20fb-4f2a-86bd-10b18852c24c_min3_1758540963097","total_duration_ms":27,"transaction_duration_ms":14,"response":{"status":"warning","creditsRemaining":2,"minuteBilled":3,"totalMinutesBilled":3,"attemptId":"91bb8001-4992-46e0-95ac-5833336188c6","shouldTerminate":false,"message":"Low credits warning: 2 minute(s) remaining"}}
{"timestamp":"2025-09-22T11:36:06.536742","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_2fbe5c29-45ba-4913-8d6f-6d83d9cd7649_min2_1758540966541","correlation_token":"sim_c1252c275bfeffd01d758a66404304b2_1758540906220","conversation_id":"2fbe5c29-45ba-4913-8d6f-6d83d9cd7649","minute":2,"metrics_total_requests":9}
{"timestamp":"2025-09-22T11:36:06.542Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_2fbe5c29-45ba-4913-8d6f-6d83d9cd7649_min2_1758540966541","correlation_token":"sim_c1252c275bfeffd01d758a66404304b2_1758540906220"}
{"timestamp":"2025-09-22T11:36:06.554Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_2fbe5c29-45ba-4913-8d6f-6d83d9cd7649_min2_1758540966541","minute_requested":2,"minutes_already_billed":1,"attempt_id":"db718599-4168-4508-9b9d-813ca61966bd"}
{"timestamp":"2025-09-22T11:36:06.554Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_2fbe5c29-45ba-4913-8d6f-6d83d9cd7649_min2_1758540966541","attempt_id":"db718599-4168-4508-9b9d-813ca61966bd","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":2,"minutes_already_billed":1,"simulation_id":"a1ca69e6-7d0b-4c29-a4fc-4d749d89c598","case_title":"demo case"}
{"timestamp":"2025-09-22T11:36:06.554Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_2fbe5c29-45ba-4913-8d6f-6d83d9cd7649_min2_1758540966541","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":2,"expected_balance_after":1,"minute_to_bill":2}
{"timestamp":"2025-09-22T11:36:06.560Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_2fbe5c29-45ba-4913-8d6f-6d83d9cd7649_min2_1758540966541","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-22T11:36:06.563Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_2fbe5c29-45ba-4913-8d6f-6d83d9cd7649_min2_1758540966541","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":2,"new_balance":1,"change":-1}
{"timestamp":"2025-09-22T11:36:06.563Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_2fbe5c29-45ba-4913-8d6f-6d83d9cd7649_min2_1758540966541","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":1,"minute":2}
{"timestamp":"2025-09-22T11:36:06.565Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_2fbe5c29-45ba-4913-8d6f-6d83d9cd7649_min2_1758540966541","transaction_id":"dac0b82c-92b6-4875-9738-472805679d00","transaction_type":"DEBIT","balance_after":1}
{"timestamp":"2025-09-22T11:36:06.565Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_2fbe5c29-45ba-4913-8d6f-6d83d9cd7649_min2_1758540966541","attempt_id":"db718599-4168-4508-9b9d-813ca61966bd","new_minutes_billed":2,"new_duration_seconds":120}
{"timestamp":"2025-09-22T11:36:06.567Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_2fbe5c29-45ba-4913-8d6f-6d83d9cd7649_min2_1758540966541","attempt_id":"db718599-4168-4508-9b9d-813ca61966bd","minutes_billed":2}
{"timestamp":"2025-09-22T11:36:06.569Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_2fbe5c29-45ba-4913-8d6f-6d83d9cd7649_min2_1758540966541","transaction_duration_ms":15,"new_balance":1,"minute_billed":2,"total_minutes_billed_this_attempt":2,"total_successful":9,"total_minutes_billed_all_time":9,"avg_transaction_time":"13.11"}
{"timestamp":"2025-09-22T11:36:06.569Z","level":"WARN","service":"BillingService","message":"Low credits warning threshold reached","requestId":"bill_2fbe5c29-45ba-4913-8d6f-6d83d9cd7649_min2_1758540966541","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","credits_remaining":1,"minute_billed":2,"warning_threshold":2}
{"timestamp":"2025-09-22T11:36:06.569Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_2fbe5c29-45ba-4913-8d6f-6d83d9cd7649_min2_1758540966541","total_duration_ms":28,"transaction_duration_ms":15,"response":{"status":"warning","creditsRemaining":1,"minuteBilled":2,"totalMinutesBilled":2,"attemptId":"db718599-4168-4508-9b9d-813ca61966bd","shouldTerminate":false,"message":"Low credits warning: 1 minute(s) remaining"}}
{"timestamp":"2025-09-22T11:36:42.597860","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_c0a3de0b-b6c0-4e24-8101-5544c57d70b3_min1_1758541002599","correlation_token":"sim_8079dc3143f03904453c62f15ff15871_1758541002299","conversation_id":"c0a3de0b-b6c0-4e24-8101-5544c57d70b3","minute":1,"metrics_total_requests":10}
{"timestamp":"2025-09-22T11:36:42.599Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_c0a3de0b-b6c0-4e24-8101-5544c57d70b3_min1_1758541002599","correlation_token":"sim_8079dc3143f03904453c62f15ff15871_1758541002299"}
{"timestamp":"2025-09-22T11:36:42.605Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_c0a3de0b-b6c0-4e24-8101-5544c57d70b3_min1_1758541002599","minute_requested":1,"minutes_already_billed":0,"attempt_id":"9501a976-fcb8-416e-b0fb-bc609227cc27"}
{"timestamp":"2025-09-22T11:36:42.605Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_c0a3de0b-b6c0-4e24-8101-5544c57d70b3_min1_1758541002599","attempt_id":"9501a976-fcb8-416e-b0fb-bc609227cc27","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":1,"minutes_already_billed":0,"simulation_id":"a1ca69e6-7d0b-4c29-a4fc-4d749d89c598","case_title":"demo case"}
{"timestamp":"2025-09-22T11:36:42.605Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_c0a3de0b-b6c0-4e24-8101-5544c57d70b3_min1_1758541002599","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":1,"expected_balance_after":0,"minute_to_bill":1}
{"timestamp":"2025-09-22T11:36:42.608Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_c0a3de0b-b6c0-4e24-8101-5544c57d70b3_min1_1758541002599","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-22T11:36:42.611Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_c0a3de0b-b6c0-4e24-8101-5544c57d70b3_min1_1758541002599","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":1,"new_balance":0,"change":-1}
{"timestamp":"2025-09-22T11:36:42.611Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_c0a3de0b-b6c0-4e24-8101-5544c57d70b3_min1_1758541002599","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":0,"minute":1}
{"timestamp":"2025-09-22T11:36:42.614Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_c0a3de0b-b6c0-4e24-8101-5544c57d70b3_min1_1758541002599","transaction_id":"e9c67023-2784-4d57-9497-1596a6a9e758","transaction_type":"DEBIT","balance_after":0}
{"timestamp":"2025-09-22T11:36:42.614Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_c0a3de0b-b6c0-4e24-8101-5544c57d70b3_min1_1758541002599","attempt_id":"9501a976-fcb8-416e-b0fb-bc609227cc27","new_minutes_billed":1,"new_duration_seconds":60}
{"timestamp":"2025-09-22T11:36:42.617Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_c0a3de0b-b6c0-4e24-8101-5544c57d70b3_min1_1758541002599","attempt_id":"9501a976-fcb8-416e-b0fb-bc609227cc27","minutes_billed":1}
{"timestamp":"2025-09-22T11:36:42.619Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_c0a3de0b-b6c0-4e24-8101-5544c57d70b3_min1_1758541002599","transaction_duration_ms":14,"new_balance":0,"minute_billed":1,"total_minutes_billed_this_attempt":1,"total_successful":10,"total_minutes_billed_all_time":10,"avg_transaction_time":"13.20"}
{"timestamp":"2025-09-22T11:36:42.619Z","level":"WARN","service":"BillingService","message":"Last credit used - will terminate conversation","requestId":"bill_c0a3de0b-b6c0-4e24-8101-5544c57d70b3_min1_1758541002599","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","minute_billed":1,"total_minutes_this_session":1}
{"timestamp":"2025-09-22T11:36:42.619Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_c0a3de0b-b6c0-4e24-8101-5544c57d70b3_min1_1758541002599","total_duration_ms":20,"transaction_duration_ms":14,"response":{"status":"terminate","creditsRemaining":0,"minuteBilled":1,"totalMinutesBilled":1,"attemptId":"9501a976-fcb8-416e-b0fb-bc609227cc27","shouldTerminate":true,"message":"Last credit used - conversation will end","gracePeriodSeconds":60}}
{"timestamp":"2025-09-22T11:36:43.394671","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_2f4ab2d2-724f-4a5a-824d-ca17c2e37561_min5_1758541003398","correlation_token":"sim_80aa5b3f44f5691f53187cc0955b2050_1758540761970","conversation_id":"2f4ab2d2-724f-4a5a-824d-ca17c2e37561","minute":5,"metrics_total_requests":11}
{"timestamp":"2025-09-22T11:36:43.398Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_2f4ab2d2-724f-4a5a-824d-ca17c2e37561_min5_1758541003398","correlation_token":"sim_80aa5b3f44f5691f53187cc0955b2050_1758540761970"}
{"timestamp":"2025-09-22T11:36:43.409Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_2f4ab2d2-724f-4a5a-824d-ca17c2e37561_min5_1758541003398","minute_requested":5,"minutes_already_billed":4,"attempt_id":"88493a8f-f908-47ae-97d8-06fe8ff912b1"}
{"timestamp":"2025-09-22T11:36:43.409Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_2f4ab2d2-724f-4a5a-824d-ca17c2e37561_min5_1758541003398","attempt_id":"88493a8f-f908-47ae-97d8-06fe8ff912b1","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":0,"minutes_already_billed":4,"simulation_id":"a1ca69e6-7d0b-4c29-a4fc-4d749d89c598","case_title":"demo case"}
{"timestamp":"2025-09-22T11:36:43.409Z","level":"WARN","service":"BillingService","message":"Insufficient credits detected","requestId":"bill_2f4ab2d2-724f-4a5a-824d-ca17c2e37561_min5_1758541003398","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_email":"john.doe@example.com","current_balance":0,"required":1,"minutes_billed":4,"total_insufficient_events":1}
{"timestamp":"2025-09-22T11:37:03.128832","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_d35fa990-20fb-4f2a-86bd-10b18852c24c_min4_1758541023132","correlation_token":"sim_f5c37d129a237f73db5c05827eb7b6d7_1758540842652","conversation_id":"d35fa990-20fb-4f2a-86bd-10b18852c24c","minute":4,"metrics_total_requests":12}
{"timestamp":"2025-09-22T11:37:03.132Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_d35fa990-20fb-4f2a-86bd-10b18852c24c_min4_1758541023132","correlation_token":"sim_f5c37d129a237f73db5c05827eb7b6d7_1758540842652"}
{"timestamp":"2025-09-22T11:37:03.150Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_d35fa990-20fb-4f2a-86bd-10b18852c24c_min4_1758541023132","minute_requested":4,"minutes_already_billed":3,"attempt_id":"91bb8001-4992-46e0-95ac-5833336188c6"}
{"timestamp":"2025-09-22T11:37:03.150Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_d35fa990-20fb-4f2a-86bd-10b18852c24c_min4_1758541023132","attempt_id":"91bb8001-4992-46e0-95ac-5833336188c6","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":0,"minutes_already_billed":3,"simulation_id":"a1ca69e6-7d0b-4c29-a4fc-4d749d89c598","case_title":"demo case"}
{"timestamp":"2025-09-22T11:37:03.151Z","level":"WARN","service":"BillingService","message":"Insufficient credits detected","requestId":"bill_d35fa990-20fb-4f2a-86bd-10b18852c24c_min4_1758541023132","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_email":"john.doe@example.com","current_balance":0,"required":1,"minutes_billed":3,"total_insufficient_events":2}
{"timestamp":"2025-09-22T11:37:06.572544","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_2fbe5c29-45ba-4913-8d6f-6d83d9cd7649_min3_1758541026574","correlation_token":"sim_c1252c275bfeffd01d758a66404304b2_1758540906220","conversation_id":"2fbe5c29-45ba-4913-8d6f-6d83d9cd7649","minute":3,"metrics_total_requests":13}
{"timestamp":"2025-09-22T11:37:06.574Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_2fbe5c29-45ba-4913-8d6f-6d83d9cd7649_min3_1758541026574","correlation_token":"sim_c1252c275bfeffd01d758a66404304b2_1758540906220"}
{"timestamp":"2025-09-22T11:37:06.585Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_2fbe5c29-45ba-4913-8d6f-6d83d9cd7649_min3_1758541026574","minute_requested":3,"minutes_already_billed":2,"attempt_id":"db718599-4168-4508-9b9d-813ca61966bd"}
{"timestamp":"2025-09-22T11:37:06.585Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_2fbe5c29-45ba-4913-8d6f-6d83d9cd7649_min3_1758541026574","attempt_id":"db718599-4168-4508-9b9d-813ca61966bd","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":0,"minutes_already_billed":2,"simulation_id":"a1ca69e6-7d0b-4c29-a4fc-4d749d89c598","case_title":"demo case"}
{"timestamp":"2025-09-22T11:37:06.585Z","level":"WARN","service":"BillingService","message":"Insufficient credits detected","requestId":"bill_2fbe5c29-45ba-4913-8d6f-6d83d9cd7649_min3_1758541026574","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_email":"john.doe@example.com","current_balance":0,"required":1,"minutes_billed":2,"total_insufficient_events":3}
{"timestamp":"2025-09-22T11:37:42.625947","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_c0a3de0b-b6c0-4e24-8101-5544c57d70b3_min2_1758541062629","correlation_token":"sim_8079dc3143f03904453c62f15ff15871_1758541002299","conversation_id":"c0a3de0b-b6c0-4e24-8101-5544c57d70b3","minute":2,"metrics_total_requests":14}
{"timestamp":"2025-09-22T11:37:42.629Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_c0a3de0b-b6c0-4e24-8101-5544c57d70b3_min2_1758541062629","correlation_token":"sim_8079dc3143f03904453c62f15ff15871_1758541002299"}
{"timestamp":"2025-09-22T11:37:42.643Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_c0a3de0b-b6c0-4e24-8101-5544c57d70b3_min2_1758541062629","minute_requested":2,"minutes_already_billed":1,"attempt_id":"9501a976-fcb8-416e-b0fb-bc609227cc27"}
{"timestamp":"2025-09-22T11:37:42.643Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_c0a3de0b-b6c0-4e24-8101-5544c57d70b3_min2_1758541062629","attempt_id":"9501a976-fcb8-416e-b0fb-bc609227cc27","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":0,"minutes_already_billed":1,"simulation_id":"a1ca69e6-7d0b-4c29-a4fc-4d749d89c598","case_title":"demo case"}
{"timestamp":"2025-09-22T11:37:42.643Z","level":"WARN","service":"BillingService","message":"Insufficient credits detected","requestId":"bill_c0a3de0b-b6c0-4e24-8101-5544c57d70b3_min2_1758541062629","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_email":"john.doe@example.com","current_balance":0,"required":1,"minutes_billed":1,"total_insufficient_events":4}
{"timestamp":"2025-09-22T11:45:57.307329","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min1_1758541557309","correlation_token":"sim_eb870e0dbbbbbe10f35a91436804eaaf_1758541557017","conversation_id":"6db91322-c458-4310-a4c3-6e8b808c928a","minute":1,"metrics_total_requests":15}
{"timestamp":"2025-09-22T11:45:57.309Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min1_1758541557309","correlation_token":"sim_eb870e0dbbbbbe10f35a91436804eaaf_1758541557017"}
{"timestamp":"2025-09-22T11:45:57.315Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min1_1758541557309","minute_requested":1,"minutes_already_billed":0,"attempt_id":"cf1a8587-a916-4109-a2a9-85ddcb5dde7b"}
{"timestamp":"2025-09-22T11:45:57.315Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min1_1758541557309","attempt_id":"cf1a8587-a916-4109-a2a9-85ddcb5dde7b","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":10,"minutes_already_billed":0,"simulation_id":"a1ca69e6-7d0b-4c29-a4fc-4d749d89c598","case_title":"demo case"}
{"timestamp":"2025-09-22T11:45:57.315Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min1_1758541557309","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":10,"expected_balance_after":9,"minute_to_bill":1}
{"timestamp":"2025-09-22T11:45:57.317Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min1_1758541557309","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-22T11:45:57.320Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min1_1758541557309","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":10,"new_balance":9,"change":-1}
{"timestamp":"2025-09-22T11:45:57.320Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min1_1758541557309","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":9,"minute":1}
{"timestamp":"2025-09-22T11:45:57.322Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min1_1758541557309","transaction_id":"61f1726b-5d96-4b85-bec8-58e92745f16b","transaction_type":"DEBIT","balance_after":9}
{"timestamp":"2025-09-22T11:45:57.322Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min1_1758541557309","attempt_id":"cf1a8587-a916-4109-a2a9-85ddcb5dde7b","new_minutes_billed":1,"new_duration_seconds":60}
{"timestamp":"2025-09-22T11:45:57.324Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min1_1758541557309","attempt_id":"cf1a8587-a916-4109-a2a9-85ddcb5dde7b","minutes_billed":1}
{"timestamp":"2025-09-22T11:45:57.325Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min1_1758541557309","transaction_duration_ms":10,"new_balance":9,"minute_billed":1,"total_minutes_billed_this_attempt":1,"total_successful":11,"total_minutes_billed_all_time":11,"avg_transaction_time":"12.91"}
{"timestamp":"2025-09-22T11:45:57.325Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min1_1758541557309","total_duration_ms":16,"transaction_duration_ms":10,"response":{"status":"continue","creditsRemaining":9,"minuteBilled":1,"totalMinutesBilled":1,"attemptId":"cf1a8587-a916-4109-a2a9-85ddcb5dde7b","shouldTerminate":false}}
{"timestamp":"2025-09-22T11:46:57.312305","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min2_1758541617313","correlation_token":"sim_eb870e0dbbbbbe10f35a91436804eaaf_1758541557017","conversation_id":"6db91322-c458-4310-a4c3-6e8b808c928a","minute":2,"metrics_total_requests":16}
{"timestamp":"2025-09-22T11:46:57.313Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min2_1758541617313","correlation_token":"sim_eb870e0dbbbbbe10f35a91436804eaaf_1758541557017"}
{"timestamp":"2025-09-22T11:46:57.320Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min2_1758541617313","minute_requested":2,"minutes_already_billed":1,"attempt_id":"cf1a8587-a916-4109-a2a9-85ddcb5dde7b"}
{"timestamp":"2025-09-22T11:46:57.320Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min2_1758541617313","attempt_id":"cf1a8587-a916-4109-a2a9-85ddcb5dde7b","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":9,"minutes_already_billed":1,"simulation_id":"a1ca69e6-7d0b-4c29-a4fc-4d749d89c598","case_title":"demo case"}
{"timestamp":"2025-09-22T11:46:57.320Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min2_1758541617313","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":9,"expected_balance_after":8,"minute_to_bill":2}
{"timestamp":"2025-09-22T11:46:57.323Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min2_1758541617313","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-22T11:46:57.325Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min2_1758541617313","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":9,"new_balance":8,"change":-1}
{"timestamp":"2025-09-22T11:46:57.325Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min2_1758541617313","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":8,"minute":2}
{"timestamp":"2025-09-22T11:46:57.327Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min2_1758541617313","transaction_id":"1bb83acd-3966-4d7d-be10-63e9f0757a01","transaction_type":"DEBIT","balance_after":8}
{"timestamp":"2025-09-22T11:46:57.327Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min2_1758541617313","attempt_id":"cf1a8587-a916-4109-a2a9-85ddcb5dde7b","new_minutes_billed":2,"new_duration_seconds":120}
{"timestamp":"2025-09-22T11:46:57.328Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min2_1758541617313","attempt_id":"cf1a8587-a916-4109-a2a9-85ddcb5dde7b","minutes_billed":2}
{"timestamp":"2025-09-22T11:46:57.329Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min2_1758541617313","transaction_duration_ms":9,"new_balance":8,"minute_billed":2,"total_minutes_billed_this_attempt":2,"total_successful":12,"total_minutes_billed_all_time":12,"avg_transaction_time":"12.58"}
{"timestamp":"2025-09-22T11:46:57.329Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min2_1758541617313","total_duration_ms":16,"transaction_duration_ms":9,"response":{"status":"continue","creditsRemaining":8,"minuteBilled":2,"totalMinutesBilled":2,"attemptId":"cf1a8587-a916-4109-a2a9-85ddcb5dde7b","shouldTerminate":false}}
{"timestamp":"2025-09-22T11:47:08.724238","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_e1179ddf-4f45-451b-91bc-4aab871e371b_min1_1758541628725","correlation_token":"sim_7ebe473739be17b8ea3cc0b38285f28f_1758541628423","conversation_id":"e1179ddf-4f45-451b-91bc-4aab871e371b","minute":1,"metrics_total_requests":17}
{"timestamp":"2025-09-22T11:47:08.725Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_e1179ddf-4f45-451b-91bc-4aab871e371b_min1_1758541628725","correlation_token":"sim_7ebe473739be17b8ea3cc0b38285f28f_1758541628423"}
{"timestamp":"2025-09-22T11:47:08.731Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_e1179ddf-4f45-451b-91bc-4aab871e371b_min1_1758541628725","minute_requested":1,"minutes_already_billed":0,"attempt_id":"08c2c446-fdf4-49c4-91a4-6c0c528e0baf"}
{"timestamp":"2025-09-22T11:47:08.731Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_e1179ddf-4f45-451b-91bc-4aab871e371b_min1_1758541628725","attempt_id":"08c2c446-fdf4-49c4-91a4-6c0c528e0baf","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":8,"minutes_already_billed":0,"simulation_id":"a1ca69e6-7d0b-4c29-a4fc-4d749d89c598","case_title":"demo case"}
{"timestamp":"2025-09-22T11:47:08.731Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_e1179ddf-4f45-451b-91bc-4aab871e371b_min1_1758541628725","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":8,"expected_balance_after":7,"minute_to_bill":1}
{"timestamp":"2025-09-22T11:47:08.734Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_e1179ddf-4f45-451b-91bc-4aab871e371b_min1_1758541628725","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-22T11:47:08.736Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_e1179ddf-4f45-451b-91bc-4aab871e371b_min1_1758541628725","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":8,"new_balance":7,"change":-1}
{"timestamp":"2025-09-22T11:47:08.736Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_e1179ddf-4f45-451b-91bc-4aab871e371b_min1_1758541628725","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":7,"minute":1}
{"timestamp":"2025-09-22T11:47:08.738Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_e1179ddf-4f45-451b-91bc-4aab871e371b_min1_1758541628725","transaction_id":"b2690c3a-7e8a-4d34-927f-2c50629c9fec","transaction_type":"DEBIT","balance_after":7}
{"timestamp":"2025-09-22T11:47:08.738Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_e1179ddf-4f45-451b-91bc-4aab871e371b_min1_1758541628725","attempt_id":"08c2c446-fdf4-49c4-91a4-6c0c528e0baf","new_minutes_billed":1,"new_duration_seconds":60}
{"timestamp":"2025-09-22T11:47:08.741Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_e1179ddf-4f45-451b-91bc-4aab871e371b_min1_1758541628725","attempt_id":"08c2c446-fdf4-49c4-91a4-6c0c528e0baf","minutes_billed":1}
{"timestamp":"2025-09-22T11:47:08.742Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_e1179ddf-4f45-451b-91bc-4aab871e371b_min1_1758541628725","transaction_duration_ms":11,"new_balance":7,"minute_billed":1,"total_minutes_billed_this_attempt":1,"total_successful":13,"total_minutes_billed_all_time":13,"avg_transaction_time":"12.46"}
{"timestamp":"2025-09-22T11:47:08.742Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_e1179ddf-4f45-451b-91bc-4aab871e371b_min1_1758541628725","total_duration_ms":17,"transaction_duration_ms":11,"response":{"status":"continue","creditsRemaining":7,"minuteBilled":1,"totalMinutesBilled":1,"attemptId":"08c2c446-fdf4-49c4-91a4-6c0c528e0baf","shouldTerminate":false}}
{"timestamp":"2025-09-22T11:47:57.334045","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min3_1758541677341","correlation_token":"sim_eb870e0dbbbbbe10f35a91436804eaaf_1758541557017","conversation_id":"6db91322-c458-4310-a4c3-6e8b808c928a","minute":3,"metrics_total_requests":18}
{"timestamp":"2025-09-22T11:47:57.341Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min3_1758541677341","correlation_token":"sim_eb870e0dbbbbbe10f35a91436804eaaf_1758541557017"}
{"timestamp":"2025-09-22T11:47:57.355Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min3_1758541677341","minute_requested":3,"minutes_already_billed":2,"attempt_id":"cf1a8587-a916-4109-a2a9-85ddcb5dde7b"}
{"timestamp":"2025-09-22T11:47:57.355Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min3_1758541677341","attempt_id":"cf1a8587-a916-4109-a2a9-85ddcb5dde7b","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":7,"minutes_already_billed":2,"simulation_id":"a1ca69e6-7d0b-4c29-a4fc-4d749d89c598","case_title":"demo case"}
{"timestamp":"2025-09-22T11:47:57.355Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min3_1758541677341","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":7,"expected_balance_after":6,"minute_to_bill":3}
{"timestamp":"2025-09-22T11:47:57.359Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min3_1758541677341","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-22T11:47:57.362Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min3_1758541677341","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":7,"new_balance":6,"change":-1}
{"timestamp":"2025-09-22T11:47:57.362Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min3_1758541677341","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":6,"minute":3}
{"timestamp":"2025-09-22T11:47:57.364Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min3_1758541677341","transaction_id":"db6f7944-f1d0-4bd6-91ee-c89f0798ccc2","transaction_type":"DEBIT","balance_after":6}
{"timestamp":"2025-09-22T11:47:57.364Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min3_1758541677341","attempt_id":"cf1a8587-a916-4109-a2a9-85ddcb5dde7b","new_minutes_billed":3,"new_duration_seconds":180}
{"timestamp":"2025-09-22T11:47:57.367Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min3_1758541677341","attempt_id":"cf1a8587-a916-4109-a2a9-85ddcb5dde7b","minutes_billed":3}
{"timestamp":"2025-09-22T11:47:57.368Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min3_1758541677341","transaction_duration_ms":13,"new_balance":6,"minute_billed":3,"total_minutes_billed_this_attempt":3,"total_successful":14,"total_minutes_billed_all_time":14,"avg_transaction_time":"12.50"}
{"timestamp":"2025-09-22T11:47:57.368Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min3_1758541677341","total_duration_ms":27,"transaction_duration_ms":13,"response":{"status":"continue","creditsRemaining":6,"minuteBilled":3,"totalMinutesBilled":3,"attemptId":"cf1a8587-a916-4109-a2a9-85ddcb5dde7b","shouldTerminate":false}}
{"timestamp":"2025-09-22T11:48:08.743823","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_e1179ddf-4f45-451b-91bc-4aab871e371b_min2_1758541688745","correlation_token":"sim_7ebe473739be17b8ea3cc0b38285f28f_1758541628423","conversation_id":"e1179ddf-4f45-451b-91bc-4aab871e371b","minute":2,"metrics_total_requests":19}
{"timestamp":"2025-09-22T11:48:08.745Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_e1179ddf-4f45-451b-91bc-4aab871e371b_min2_1758541688745","correlation_token":"sim_7ebe473739be17b8ea3cc0b38285f28f_1758541628423"}
{"timestamp":"2025-09-22T11:48:08.752Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_e1179ddf-4f45-451b-91bc-4aab871e371b_min2_1758541688745","minute_requested":2,"minutes_already_billed":1,"attempt_id":"08c2c446-fdf4-49c4-91a4-6c0c528e0baf"}
{"timestamp":"2025-09-22T11:48:08.752Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_e1179ddf-4f45-451b-91bc-4aab871e371b_min2_1758541688745","attempt_id":"08c2c446-fdf4-49c4-91a4-6c0c528e0baf","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":6,"minutes_already_billed":1,"simulation_id":"a1ca69e6-7d0b-4c29-a4fc-4d749d89c598","case_title":"demo case"}
{"timestamp":"2025-09-22T11:48:08.752Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_e1179ddf-4f45-451b-91bc-4aab871e371b_min2_1758541688745","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":6,"expected_balance_after":5,"minute_to_bill":2}
{"timestamp":"2025-09-22T11:48:08.754Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_e1179ddf-4f45-451b-91bc-4aab871e371b_min2_1758541688745","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-22T11:48:08.757Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_e1179ddf-4f45-451b-91bc-4aab871e371b_min2_1758541688745","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":6,"new_balance":5,"change":-1}
{"timestamp":"2025-09-22T11:48:08.757Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_e1179ddf-4f45-451b-91bc-4aab871e371b_min2_1758541688745","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":5,"minute":2}
{"timestamp":"2025-09-22T11:48:08.759Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_e1179ddf-4f45-451b-91bc-4aab871e371b_min2_1758541688745","transaction_id":"106c3059-29ce-49e0-808a-29e5817e9a48","transaction_type":"DEBIT","balance_after":5}
{"timestamp":"2025-09-22T11:48:08.759Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_e1179ddf-4f45-451b-91bc-4aab871e371b_min2_1758541688745","attempt_id":"08c2c446-fdf4-49c4-91a4-6c0c528e0baf","new_minutes_billed":2,"new_duration_seconds":120}
{"timestamp":"2025-09-22T11:48:08.761Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_e1179ddf-4f45-451b-91bc-4aab871e371b_min2_1758541688745","attempt_id":"08c2c446-fdf4-49c4-91a4-6c0c528e0baf","minutes_billed":2}
{"timestamp":"2025-09-22T11:48:08.762Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_e1179ddf-4f45-451b-91bc-4aab871e371b_min2_1758541688745","transaction_duration_ms":10,"new_balance":5,"minute_billed":2,"total_minutes_billed_this_attempt":2,"total_successful":15,"total_minutes_billed_all_time":15,"avg_transaction_time":"12.33"}
{"timestamp":"2025-09-22T11:48:08.762Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_e1179ddf-4f45-451b-91bc-4aab871e371b_min2_1758541688745","total_duration_ms":17,"transaction_duration_ms":10,"response":{"status":"continue","creditsRemaining":5,"minuteBilled":2,"totalMinutesBilled":2,"attemptId":"08c2c446-fdf4-49c4-91a4-6c0c528e0baf","shouldTerminate":false}}
{"timestamp":"2025-09-22T11:48:57.375005","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min4_1758541737383","correlation_token":"sim_eb870e0dbbbbbe10f35a91436804eaaf_1758541557017","conversation_id":"6db91322-c458-4310-a4c3-6e8b808c928a","minute":4,"metrics_total_requests":20}
{"timestamp":"2025-09-22T11:48:57.384Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min4_1758541737383","correlation_token":"sim_eb870e0dbbbbbe10f35a91436804eaaf_1758541557017"}
{"timestamp":"2025-09-22T11:48:57.397Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min4_1758541737383","minute_requested":4,"minutes_already_billed":3,"attempt_id":"cf1a8587-a916-4109-a2a9-85ddcb5dde7b"}
{"timestamp":"2025-09-22T11:48:57.397Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min4_1758541737383","attempt_id":"cf1a8587-a916-4109-a2a9-85ddcb5dde7b","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":5,"minutes_already_billed":3,"simulation_id":"a1ca69e6-7d0b-4c29-a4fc-4d749d89c598","case_title":"demo case"}
{"timestamp":"2025-09-22T11:48:57.397Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min4_1758541737383","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":5,"expected_balance_after":4,"minute_to_bill":4}
{"timestamp":"2025-09-22T11:48:57.402Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min4_1758541737383","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-22T11:48:57.405Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min4_1758541737383","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":5,"new_balance":4,"change":-1}
{"timestamp":"2025-09-22T11:48:57.405Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min4_1758541737383","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":4,"minute":4}
{"timestamp":"2025-09-22T11:48:57.408Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min4_1758541737383","transaction_id":"66ef0b70-99ba-47ff-af42-4289e0aa838f","transaction_type":"DEBIT","balance_after":4}
{"timestamp":"2025-09-22T11:48:57.408Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min4_1758541737383","attempt_id":"cf1a8587-a916-4109-a2a9-85ddcb5dde7b","new_minutes_billed":4,"new_duration_seconds":240}
{"timestamp":"2025-09-22T11:48:57.410Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min4_1758541737383","attempt_id":"cf1a8587-a916-4109-a2a9-85ddcb5dde7b","minutes_billed":4}
{"timestamp":"2025-09-22T11:48:57.412Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min4_1758541737383","transaction_duration_ms":15,"new_balance":4,"minute_billed":4,"total_minutes_billed_this_attempt":4,"total_successful":16,"total_minutes_billed_all_time":16,"avg_transaction_time":"12.50"}
{"timestamp":"2025-09-22T11:48:57.412Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min4_1758541737383","total_duration_ms":29,"transaction_duration_ms":15,"response":{"status":"continue","creditsRemaining":4,"minuteBilled":4,"totalMinutesBilled":4,"attemptId":"cf1a8587-a916-4109-a2a9-85ddcb5dde7b","shouldTerminate":false}}
{"timestamp":"2025-09-22T11:49:08.764948","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_e1179ddf-4f45-451b-91bc-4aab871e371b_min3_1758541748770","correlation_token":"sim_7ebe473739be17b8ea3cc0b38285f28f_1758541628423","conversation_id":"e1179ddf-4f45-451b-91bc-4aab871e371b","minute":3,"metrics_total_requests":21}
{"timestamp":"2025-09-22T11:49:08.770Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_e1179ddf-4f45-451b-91bc-4aab871e371b_min3_1758541748770","correlation_token":"sim_7ebe473739be17b8ea3cc0b38285f28f_1758541628423"}
{"timestamp":"2025-09-22T11:49:08.784Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_e1179ddf-4f45-451b-91bc-4aab871e371b_min3_1758541748770","minute_requested":3,"minutes_already_billed":2,"attempt_id":"08c2c446-fdf4-49c4-91a4-6c0c528e0baf"}
{"timestamp":"2025-09-22T11:49:08.784Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_e1179ddf-4f45-451b-91bc-4aab871e371b_min3_1758541748770","attempt_id":"08c2c446-fdf4-49c4-91a4-6c0c528e0baf","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":4,"minutes_already_billed":2,"simulation_id":"a1ca69e6-7d0b-4c29-a4fc-4d749d89c598","case_title":"demo case"}
{"timestamp":"2025-09-22T11:49:08.784Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_e1179ddf-4f45-451b-91bc-4aab871e371b_min3_1758541748770","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":4,"expected_balance_after":3,"minute_to_bill":3}
{"timestamp":"2025-09-22T11:49:08.790Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_e1179ddf-4f45-451b-91bc-4aab871e371b_min3_1758541748770","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-22T11:49:08.792Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_e1179ddf-4f45-451b-91bc-4aab871e371b_min3_1758541748770","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":4,"new_balance":3,"change":-1}
{"timestamp":"2025-09-22T11:49:08.792Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_e1179ddf-4f45-451b-91bc-4aab871e371b_min3_1758541748770","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":3,"minute":3}
{"timestamp":"2025-09-22T11:49:08.795Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_e1179ddf-4f45-451b-91bc-4aab871e371b_min3_1758541748770","transaction_id":"19746a9f-36d9-444b-aa20-824dc02b06ec","transaction_type":"DEBIT","balance_after":3}
{"timestamp":"2025-09-22T11:49:08.795Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_e1179ddf-4f45-451b-91bc-4aab871e371b_min3_1758541748770","attempt_id":"08c2c446-fdf4-49c4-91a4-6c0c528e0baf","new_minutes_billed":3,"new_duration_seconds":180}
{"timestamp":"2025-09-22T11:49:08.797Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_e1179ddf-4f45-451b-91bc-4aab871e371b_min3_1758541748770","attempt_id":"08c2c446-fdf4-49c4-91a4-6c0c528e0baf","minutes_billed":3}
{"timestamp":"2025-09-22T11:49:08.798Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_e1179ddf-4f45-451b-91bc-4aab871e371b_min3_1758541748770","transaction_duration_ms":14,"new_balance":3,"minute_billed":3,"total_minutes_billed_this_attempt":3,"total_successful":17,"total_minutes_billed_all_time":17,"avg_transaction_time":"12.59"}
{"timestamp":"2025-09-22T11:49:08.798Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_e1179ddf-4f45-451b-91bc-4aab871e371b_min3_1758541748770","total_duration_ms":28,"transaction_duration_ms":14,"response":{"status":"continue","creditsRemaining":3,"minuteBilled":3,"totalMinutesBilled":3,"attemptId":"08c2c446-fdf4-49c4-91a4-6c0c528e0baf","shouldTerminate":false}}
{"timestamp":"2025-09-22T11:49:57.418592","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min5_1758541797423","correlation_token":"sim_eb870e0dbbbbbe10f35a91436804eaaf_1758541557017","conversation_id":"6db91322-c458-4310-a4c3-6e8b808c928a","minute":5,"metrics_total_requests":22}
{"timestamp":"2025-09-22T11:49:57.424Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min5_1758541797423","correlation_token":"sim_eb870e0dbbbbbe10f35a91436804eaaf_1758541557017"}
{"timestamp":"2025-09-22T11:49:57.441Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min5_1758541797423","minute_requested":5,"minutes_already_billed":4,"attempt_id":"cf1a8587-a916-4109-a2a9-85ddcb5dde7b"}
{"timestamp":"2025-09-22T11:49:57.441Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min5_1758541797423","attempt_id":"cf1a8587-a916-4109-a2a9-85ddcb5dde7b","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":3,"minutes_already_billed":4,"simulation_id":"a1ca69e6-7d0b-4c29-a4fc-4d749d89c598","case_title":"demo case"}
{"timestamp":"2025-09-22T11:49:57.441Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min5_1758541797423","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":3,"expected_balance_after":2,"minute_to_bill":5}
{"timestamp":"2025-09-22T11:49:57.445Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min5_1758541797423","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-22T11:49:57.450Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min5_1758541797423","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":3,"new_balance":2,"change":-1}
{"timestamp":"2025-09-22T11:49:57.450Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min5_1758541797423","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":2,"minute":5}
{"timestamp":"2025-09-22T11:49:57.452Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min5_1758541797423","transaction_id":"39a27e91-2168-4217-9429-29567d20fb81","transaction_type":"DEBIT","balance_after":2}
{"timestamp":"2025-09-22T11:49:57.452Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min5_1758541797423","attempt_id":"cf1a8587-a916-4109-a2a9-85ddcb5dde7b","new_minutes_billed":5,"new_duration_seconds":300}
{"timestamp":"2025-09-22T11:49:57.454Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min5_1758541797423","attempt_id":"cf1a8587-a916-4109-a2a9-85ddcb5dde7b","minutes_billed":5}
{"timestamp":"2025-09-22T11:49:57.456Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min5_1758541797423","transaction_duration_ms":15,"new_balance":2,"minute_billed":5,"total_minutes_billed_this_attempt":5,"total_successful":18,"total_minutes_billed_all_time":18,"avg_transaction_time":"12.72"}
{"timestamp":"2025-09-22T11:49:57.456Z","level":"WARN","service":"BillingService","message":"Low credits warning threshold reached","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min5_1758541797423","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","credits_remaining":2,"minute_billed":5,"warning_threshold":2}
{"timestamp":"2025-09-22T11:49:57.456Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min5_1758541797423","total_duration_ms":33,"transaction_duration_ms":15,"response":{"status":"warning","creditsRemaining":2,"minuteBilled":5,"totalMinutesBilled":5,"attemptId":"cf1a8587-a916-4109-a2a9-85ddcb5dde7b","shouldTerminate":false,"message":"Low credits warning: 2 minute(s) remaining"}}
{"timestamp":"2025-09-22T11:50:08.801824","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_e1179ddf-4f45-451b-91bc-4aab871e371b_min4_1758541808803","correlation_token":"sim_7ebe473739be17b8ea3cc0b38285f28f_1758541628423","conversation_id":"e1179ddf-4f45-451b-91bc-4aab871e371b","minute":4,"metrics_total_requests":23}
{"timestamp":"2025-09-22T11:50:08.803Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_e1179ddf-4f45-451b-91bc-4aab871e371b_min4_1758541808803","correlation_token":"sim_7ebe473739be17b8ea3cc0b38285f28f_1758541628423"}
{"timestamp":"2025-09-22T11:50:08.812Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_e1179ddf-4f45-451b-91bc-4aab871e371b_min4_1758541808803","minute_requested":4,"minutes_already_billed":3,"attempt_id":"08c2c446-fdf4-49c4-91a4-6c0c528e0baf"}
{"timestamp":"2025-09-22T11:50:08.812Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_e1179ddf-4f45-451b-91bc-4aab871e371b_min4_1758541808803","attempt_id":"08c2c446-fdf4-49c4-91a4-6c0c528e0baf","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":2,"minutes_already_billed":3,"simulation_id":"a1ca69e6-7d0b-4c29-a4fc-4d749d89c598","case_title":"demo case"}
{"timestamp":"2025-09-22T11:50:08.812Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_e1179ddf-4f45-451b-91bc-4aab871e371b_min4_1758541808803","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":2,"expected_balance_after":1,"minute_to_bill":4}
{"timestamp":"2025-09-22T11:50:08.816Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_e1179ddf-4f45-451b-91bc-4aab871e371b_min4_1758541808803","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-22T11:50:08.818Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_e1179ddf-4f45-451b-91bc-4aab871e371b_min4_1758541808803","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":2,"new_balance":1,"change":-1}
{"timestamp":"2025-09-22T11:50:08.818Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_e1179ddf-4f45-451b-91bc-4aab871e371b_min4_1758541808803","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":1,"minute":4}
{"timestamp":"2025-09-22T11:50:08.819Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_e1179ddf-4f45-451b-91bc-4aab871e371b_min4_1758541808803","transaction_id":"4b6a8706-9c61-42dd-a983-982fe5583141","transaction_type":"DEBIT","balance_after":1}
{"timestamp":"2025-09-22T11:50:08.819Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_e1179ddf-4f45-451b-91bc-4aab871e371b_min4_1758541808803","attempt_id":"08c2c446-fdf4-49c4-91a4-6c0c528e0baf","new_minutes_billed":4,"new_duration_seconds":240}
{"timestamp":"2025-09-22T11:50:08.821Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_e1179ddf-4f45-451b-91bc-4aab871e371b_min4_1758541808803","attempt_id":"08c2c446-fdf4-49c4-91a4-6c0c528e0baf","minutes_billed":4}
{"timestamp":"2025-09-22T11:50:08.822Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_e1179ddf-4f45-451b-91bc-4aab871e371b_min4_1758541808803","transaction_duration_ms":10,"new_balance":1,"minute_billed":4,"total_minutes_billed_this_attempt":4,"total_successful":19,"total_minutes_billed_all_time":19,"avg_transaction_time":"12.58"}
{"timestamp":"2025-09-22T11:50:08.822Z","level":"WARN","service":"BillingService","message":"Low credits warning threshold reached","requestId":"bill_e1179ddf-4f45-451b-91bc-4aab871e371b_min4_1758541808803","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","credits_remaining":1,"minute_billed":4,"warning_threshold":2}
{"timestamp":"2025-09-22T11:50:08.822Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_e1179ddf-4f45-451b-91bc-4aab871e371b_min4_1758541808803","total_duration_ms":19,"transaction_duration_ms":10,"response":{"status":"warning","creditsRemaining":1,"minuteBilled":4,"totalMinutesBilled":4,"attemptId":"08c2c446-fdf4-49c4-91a4-6c0c528e0baf","shouldTerminate":false,"message":"Low credits warning: 1 minute(s) remaining"}}
{"timestamp":"2025-09-22T11:50:57.460688","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min6_1758541857465","correlation_token":"sim_eb870e0dbbbbbe10f35a91436804eaaf_1758541557017","conversation_id":"6db91322-c458-4310-a4c3-6e8b808c928a","minute":6,"metrics_total_requests":24}
{"timestamp":"2025-09-22T11:50:57.465Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min6_1758541857465","correlation_token":"sim_eb870e0dbbbbbe10f35a91436804eaaf_1758541557017"}
{"timestamp":"2025-09-22T11:50:57.479Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min6_1758541857465","minute_requested":6,"minutes_already_billed":5,"attempt_id":"cf1a8587-a916-4109-a2a9-85ddcb5dde7b"}
{"timestamp":"2025-09-22T11:50:57.479Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min6_1758541857465","attempt_id":"cf1a8587-a916-4109-a2a9-85ddcb5dde7b","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":1,"minutes_already_billed":5,"simulation_id":"a1ca69e6-7d0b-4c29-a4fc-4d749d89c598","case_title":"demo case"}
{"timestamp":"2025-09-22T11:50:57.479Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min6_1758541857465","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":1,"expected_balance_after":0,"minute_to_bill":6}
{"timestamp":"2025-09-22T11:50:57.483Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min6_1758541857465","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-22T11:50:57.487Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min6_1758541857465","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":1,"new_balance":0,"change":-1}
{"timestamp":"2025-09-22T11:50:57.487Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min6_1758541857465","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":0,"minute":6}
{"timestamp":"2025-09-22T11:50:57.490Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min6_1758541857465","transaction_id":"56b0fc0c-6639-4797-8773-3b7234067f0f","transaction_type":"DEBIT","balance_after":0}
{"timestamp":"2025-09-22T11:50:57.490Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min6_1758541857465","attempt_id":"cf1a8587-a916-4109-a2a9-85ddcb5dde7b","new_minutes_billed":6,"new_duration_seconds":360}
{"timestamp":"2025-09-22T11:50:57.492Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min6_1758541857465","attempt_id":"cf1a8587-a916-4109-a2a9-85ddcb5dde7b","minutes_billed":6}
{"timestamp":"2025-09-22T11:50:57.494Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min6_1758541857465","transaction_duration_ms":15,"new_balance":0,"minute_billed":6,"total_minutes_billed_this_attempt":6,"total_successful":20,"total_minutes_billed_all_time":20,"avg_transaction_time":"12.70"}
{"timestamp":"2025-09-22T11:50:57.494Z","level":"WARN","service":"BillingService","message":"Last credit used - will terminate conversation","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min6_1758541857465","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","minute_billed":6,"total_minutes_this_session":6}
{"timestamp":"2025-09-22T11:50:57.494Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_6db91322-c458-4310-a4c3-6e8b808c928a_min6_1758541857465","total_duration_ms":29,"transaction_duration_ms":15,"response":{"status":"terminate","creditsRemaining":0,"minuteBilled":6,"totalMinutesBilled":6,"attemptId":"cf1a8587-a916-4109-a2a9-85ddcb5dde7b","shouldTerminate":true,"message":"Last credit used - conversation will end","gracePeriodSeconds":60}}
{"timestamp":"2025-09-22T11:51:08.825236","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_e1179ddf-4f45-451b-91bc-4aab871e371b_min5_1758541868828","correlation_token":"sim_7ebe473739be17b8ea3cc0b38285f28f_1758541628423","conversation_id":"e1179ddf-4f45-451b-91bc-4aab871e371b","minute":5,"metrics_total_requests":25}
{"timestamp":"2025-09-22T11:51:08.828Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_e1179ddf-4f45-451b-91bc-4aab871e371b_min5_1758541868828","correlation_token":"sim_7ebe473739be17b8ea3cc0b38285f28f_1758541628423"}
{"timestamp":"2025-09-22T11:51:08.837Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_e1179ddf-4f45-451b-91bc-4aab871e371b_min5_1758541868828","minute_requested":5,"minutes_already_billed":4,"attempt_id":"08c2c446-fdf4-49c4-91a4-6c0c528e0baf"}
{"timestamp":"2025-09-22T11:51:08.838Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_e1179ddf-4f45-451b-91bc-4aab871e371b_min5_1758541868828","attempt_id":"08c2c446-fdf4-49c4-91a4-6c0c528e0baf","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":0,"minutes_already_billed":4,"simulation_id":"a1ca69e6-7d0b-4c29-a4fc-4d749d89c598","case_title":"demo case"}
{"timestamp":"2025-09-22T11:51:08.838Z","level":"WARN","service":"BillingService","message":"Insufficient credits detected","requestId":"bill_e1179ddf-4f45-451b-91bc-4aab871e371b_min5_1758541868828","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_email":"john.doe@example.com","current_balance":0,"required":1,"minutes_billed":4,"total_insufficient_events":5}
{"timestamp":"2025-09-22T11:58:43.526Z","level":"INFO","service":"BillingService","message":"BillingService initialized","environment":"development","database_url":"configured"}
{"timestamp":"2025-09-22T11:59:49.307765","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_567117e1-b4b8-4594-a105-6e49383190a3_min1_1758542389311","correlation_token":"sim_90814388f9072c2c81b655288147913c_1758542388964","conversation_id":"567117e1-b4b8-4594-a105-6e49383190a3","minute":1,"metrics_total_requests":1}
{"timestamp":"2025-09-22T11:59:49.312Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_567117e1-b4b8-4594-a105-6e49383190a3_min1_1758542389311","correlation_token":"sim_90814388f9072c2c81b655288147913c_1758542388964"}
{"timestamp":"2025-09-22T11:59:49.318Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_567117e1-b4b8-4594-a105-6e49383190a3_min1_1758542389311","minute_requested":1,"minutes_already_billed":0,"attempt_id":"e019a1b5-e627-405e-89d1-ffdf9406875d"}
{"timestamp":"2025-09-22T11:59:49.318Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_567117e1-b4b8-4594-a105-6e49383190a3_min1_1758542389311","attempt_id":"e019a1b5-e627-405e-89d1-ffdf9406875d","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":10,"minutes_already_billed":0,"simulation_id":"a1ca69e6-7d0b-4c29-a4fc-4d749d89c598","case_title":"demo case"}
{"timestamp":"2025-09-22T11:59:49.318Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_567117e1-b4b8-4594-a105-6e49383190a3_min1_1758542389311","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":10,"expected_balance_after":9,"minute_to_bill":1}
{"timestamp":"2025-09-22T11:59:49.322Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_567117e1-b4b8-4594-a105-6e49383190a3_min1_1758542389311","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-22T11:59:49.324Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_567117e1-b4b8-4594-a105-6e49383190a3_min1_1758542389311","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":10,"new_balance":9,"change":-1}
{"timestamp":"2025-09-22T11:59:49.324Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_567117e1-b4b8-4594-a105-6e49383190a3_min1_1758542389311","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":9,"minute":1}
{"timestamp":"2025-09-22T11:59:49.326Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_567117e1-b4b8-4594-a105-6e49383190a3_min1_1758542389311","transaction_id":"d2304a6d-f458-4a3c-8bf5-2590ed924a84","transaction_type":"DEBIT","balance_after":9}
{"timestamp":"2025-09-22T11:59:49.326Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_567117e1-b4b8-4594-a105-6e49383190a3_min1_1758542389311","attempt_id":"e019a1b5-e627-405e-89d1-ffdf9406875d","new_minutes_billed":1,"new_duration_seconds":60}
{"timestamp":"2025-09-22T11:59:49.328Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_567117e1-b4b8-4594-a105-6e49383190a3_min1_1758542389311","attempt_id":"e019a1b5-e627-405e-89d1-ffdf9406875d","minutes_billed":1}
{"timestamp":"2025-09-22T11:59:49.330Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_567117e1-b4b8-4594-a105-6e49383190a3_min1_1758542389311","transaction_duration_ms":12,"new_balance":9,"minute_billed":1,"total_minutes_billed_this_attempt":1,"total_successful":1,"total_minutes_billed_all_time":1,"avg_transaction_time":"12.00"}
{"timestamp":"2025-09-22T11:59:49.330Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_567117e1-b4b8-4594-a105-6e49383190a3_min1_1758542389311","total_duration_ms":19,"transaction_duration_ms":12,"response":{"status":"continue","creditsRemaining":9,"minuteBilled":1,"totalMinutesBilled":1,"attemptId":"e019a1b5-e627-405e-89d1-ffdf9406875d","shouldTerminate":false}}
{"timestamp":"2025-09-22T12:00:49.333832","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_567117e1-b4b8-4594-a105-6e49383190a3_min2_1758542449335","correlation_token":"sim_90814388f9072c2c81b655288147913c_1758542388964","conversation_id":"567117e1-b4b8-4594-a105-6e49383190a3","minute":2,"metrics_total_requests":2}
{"timestamp":"2025-09-22T12:00:49.335Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_567117e1-b4b8-4594-a105-6e49383190a3_min2_1758542449335","correlation_token":"sim_90814388f9072c2c81b655288147913c_1758542388964"}
{"timestamp":"2025-09-22T12:00:49.344Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_567117e1-b4b8-4594-a105-6e49383190a3_min2_1758542449335","minute_requested":2,"minutes_already_billed":1,"attempt_id":"e019a1b5-e627-405e-89d1-ffdf9406875d"}
{"timestamp":"2025-09-22T12:00:49.344Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_567117e1-b4b8-4594-a105-6e49383190a3_min2_1758542449335","attempt_id":"e019a1b5-e627-405e-89d1-ffdf9406875d","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":9,"minutes_already_billed":1,"simulation_id":"a1ca69e6-7d0b-4c29-a4fc-4d749d89c598","case_title":"demo case"}
{"timestamp":"2025-09-22T12:00:49.344Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_567117e1-b4b8-4594-a105-6e49383190a3_min2_1758542449335","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":9,"expected_balance_after":8,"minute_to_bill":2}
{"timestamp":"2025-09-22T12:00:49.347Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_567117e1-b4b8-4594-a105-6e49383190a3_min2_1758542449335","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-22T12:00:49.351Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_567117e1-b4b8-4594-a105-6e49383190a3_min2_1758542449335","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":9,"new_balance":8,"change":-1}
{"timestamp":"2025-09-22T12:00:49.351Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_567117e1-b4b8-4594-a105-6e49383190a3_min2_1758542449335","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":8,"minute":2}
{"timestamp":"2025-09-22T12:00:49.358Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_567117e1-b4b8-4594-a105-6e49383190a3_min2_1758542449335","transaction_id":"6a1c1919-ca68-42f5-b7ca-1605d4a2ff89","transaction_type":"DEBIT","balance_after":8}
{"timestamp":"2025-09-22T12:00:49.358Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_567117e1-b4b8-4594-a105-6e49383190a3_min2_1758542449335","attempt_id":"e019a1b5-e627-405e-89d1-ffdf9406875d","new_minutes_billed":2,"new_duration_seconds":120}
{"timestamp":"2025-09-22T12:00:49.360Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_567117e1-b4b8-4594-a105-6e49383190a3_min2_1758542449335","attempt_id":"e019a1b5-e627-405e-89d1-ffdf9406875d","minutes_billed":2}
{"timestamp":"2025-09-22T12:00:49.361Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_567117e1-b4b8-4594-a105-6e49383190a3_min2_1758542449335","transaction_duration_ms":17,"new_balance":8,"minute_billed":2,"total_minutes_billed_this_attempt":2,"total_successful":2,"total_minutes_billed_all_time":2,"avg_transaction_time":"14.50"}
{"timestamp":"2025-09-22T12:00:49.361Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_567117e1-b4b8-4594-a105-6e49383190a3_min2_1758542449335","total_duration_ms":26,"transaction_duration_ms":17,"response":{"status":"continue","creditsRemaining":8,"minuteBilled":2,"totalMinutesBilled":2,"attemptId":"e019a1b5-e627-405e-89d1-ffdf9406875d","shouldTerminate":false}}
{"timestamp":"2025-09-22T12:01:41.295044","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_65c4e57d-1eab-433f-b66a-a72002471c15_min1_1758542501297","correlation_token":"sim_a151b4f4b98ba14c99ec9a7ba50fff94_1758542500950","conversation_id":"65c4e57d-1eab-433f-b66a-a72002471c15","minute":1,"metrics_total_requests":3}
{"timestamp":"2025-09-22T12:01:41.298Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_65c4e57d-1eab-433f-b66a-a72002471c15_min1_1758542501297","correlation_token":"sim_a151b4f4b98ba14c99ec9a7ba50fff94_1758542500950"}
{"timestamp":"2025-09-22T12:01:41.306Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_65c4e57d-1eab-433f-b66a-a72002471c15_min1_1758542501297","minute_requested":1,"minutes_already_billed":0,"attempt_id":"cb7bd7de-7940-42d4-9b93-64909724b7fa"}
{"timestamp":"2025-09-22T12:01:41.306Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_65c4e57d-1eab-433f-b66a-a72002471c15_min1_1758542501297","attempt_id":"cb7bd7de-7940-42d4-9b93-64909724b7fa","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":8,"minutes_already_billed":0,"simulation_id":"a1ca69e6-7d0b-4c29-a4fc-4d749d89c598","case_title":"demo case"}
{"timestamp":"2025-09-22T12:01:41.306Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_65c4e57d-1eab-433f-b66a-a72002471c15_min1_1758542501297","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":8,"expected_balance_after":7,"minute_to_bill":1}
{"timestamp":"2025-09-22T12:01:41.310Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_65c4e57d-1eab-433f-b66a-a72002471c15_min1_1758542501297","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-22T12:01:41.317Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_65c4e57d-1eab-433f-b66a-a72002471c15_min1_1758542501297","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":8,"new_balance":7,"change":-1}
{"timestamp":"2025-09-22T12:01:41.317Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_65c4e57d-1eab-433f-b66a-a72002471c15_min1_1758542501297","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":7,"minute":1}
{"timestamp":"2025-09-22T12:01:41.320Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_65c4e57d-1eab-433f-b66a-a72002471c15_min1_1758542501297","transaction_id":"239f9675-cab3-49b2-a7c2-3c5f308bd931","transaction_type":"DEBIT","balance_after":7}
{"timestamp":"2025-09-22T12:01:41.320Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_65c4e57d-1eab-433f-b66a-a72002471c15_min1_1758542501297","attempt_id":"cb7bd7de-7940-42d4-9b93-64909724b7fa","new_minutes_billed":1,"new_duration_seconds":60}
{"timestamp":"2025-09-22T12:01:41.323Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_65c4e57d-1eab-433f-b66a-a72002471c15_min1_1758542501297","attempt_id":"cb7bd7de-7940-42d4-9b93-64909724b7fa","minutes_billed":1}
{"timestamp":"2025-09-22T12:01:41.325Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_65c4e57d-1eab-433f-b66a-a72002471c15_min1_1758542501297","transaction_duration_ms":19,"new_balance":7,"minute_billed":1,"total_minutes_billed_this_attempt":1,"total_successful":3,"total_minutes_billed_all_time":3,"avg_transaction_time":"16.00"}
{"timestamp":"2025-09-22T12:01:41.325Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_65c4e57d-1eab-433f-b66a-a72002471c15_min1_1758542501297","total_duration_ms":28,"transaction_duration_ms":19,"response":{"status":"continue","creditsRemaining":7,"minuteBilled":1,"totalMinutesBilled":1,"attemptId":"cb7bd7de-7940-42d4-9b93-64909724b7fa","shouldTerminate":false}}
{"timestamp":"2025-09-22T12:02:41.328346","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_65c4e57d-1eab-433f-b66a-a72002471c15_min2_1758542561339","correlation_token":"sim_a151b4f4b98ba14c99ec9a7ba50fff94_1758542500950","conversation_id":"65c4e57d-1eab-433f-b66a-a72002471c15","minute":2,"metrics_total_requests":4}
{"timestamp":"2025-09-22T12:02:41.339Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_65c4e57d-1eab-433f-b66a-a72002471c15_min2_1758542561339","correlation_token":"sim_a151b4f4b98ba14c99ec9a7ba50fff94_1758542500950"}
{"timestamp":"2025-09-22T12:02:41.352Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_65c4e57d-1eab-433f-b66a-a72002471c15_min2_1758542561339","minute_requested":2,"minutes_already_billed":1,"attempt_id":"cb7bd7de-7940-42d4-9b93-64909724b7fa"}
{"timestamp":"2025-09-22T12:02:41.352Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_65c4e57d-1eab-433f-b66a-a72002471c15_min2_1758542561339","attempt_id":"cb7bd7de-7940-42d4-9b93-64909724b7fa","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":7,"minutes_already_billed":1,"simulation_id":"a1ca69e6-7d0b-4c29-a4fc-4d749d89c598","case_title":"demo case"}
{"timestamp":"2025-09-22T12:02:41.352Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_65c4e57d-1eab-433f-b66a-a72002471c15_min2_1758542561339","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":7,"expected_balance_after":6,"minute_to_bill":2}
{"timestamp":"2025-09-22T12:02:41.356Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_65c4e57d-1eab-433f-b66a-a72002471c15_min2_1758542561339","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-22T12:02:41.358Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_65c4e57d-1eab-433f-b66a-a72002471c15_min2_1758542561339","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":7,"new_balance":6,"change":-1}
{"timestamp":"2025-09-22T12:02:41.359Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_65c4e57d-1eab-433f-b66a-a72002471c15_min2_1758542561339","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":6,"minute":2}
{"timestamp":"2025-09-22T12:02:41.361Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_65c4e57d-1eab-433f-b66a-a72002471c15_min2_1758542561339","transaction_id":"e959cde0-66b3-410c-8156-64b09a9f1bb0","transaction_type":"DEBIT","balance_after":6}
{"timestamp":"2025-09-22T12:02:41.361Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_65c4e57d-1eab-433f-b66a-a72002471c15_min2_1758542561339","attempt_id":"cb7bd7de-7940-42d4-9b93-64909724b7fa","new_minutes_billed":2,"new_duration_seconds":120}
{"timestamp":"2025-09-22T12:02:41.363Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_65c4e57d-1eab-433f-b66a-a72002471c15_min2_1758542561339","attempt_id":"cb7bd7de-7940-42d4-9b93-64909724b7fa","minutes_billed":2}
{"timestamp":"2025-09-22T12:02:41.364Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_65c4e57d-1eab-433f-b66a-a72002471c15_min2_1758542561339","transaction_duration_ms":12,"new_balance":6,"minute_billed":2,"total_minutes_billed_this_attempt":2,"total_successful":4,"total_minutes_billed_all_time":4,"avg_transaction_time":"15.00"}
{"timestamp":"2025-09-22T12:02:41.365Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_65c4e57d-1eab-433f-b66a-a72002471c15_min2_1758542561339","total_duration_ms":26,"transaction_duration_ms":12,"response":{"status":"continue","creditsRemaining":6,"minuteBilled":2,"totalMinutesBilled":2,"attemptId":"cb7bd7de-7940-42d4-9b93-64909724b7fa","shouldTerminate":false}}
{"timestamp":"2025-09-22T12:03:41.367849","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_65c4e57d-1eab-433f-b66a-a72002471c15_min3_1758542621376","correlation_token":"sim_a151b4f4b98ba14c99ec9a7ba50fff94_1758542500950","conversation_id":"65c4e57d-1eab-433f-b66a-a72002471c15","minute":3,"metrics_total_requests":5}
{"timestamp":"2025-09-22T12:03:41.376Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_65c4e57d-1eab-433f-b66a-a72002471c15_min3_1758542621376","correlation_token":"sim_a151b4f4b98ba14c99ec9a7ba50fff94_1758542500950"}
{"timestamp":"2025-09-22T12:03:41.394Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_65c4e57d-1eab-433f-b66a-a72002471c15_min3_1758542621376","minute_requested":3,"minutes_already_billed":2,"attempt_id":"cb7bd7de-7940-42d4-9b93-64909724b7fa"}
{"timestamp":"2025-09-22T12:03:41.395Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_65c4e57d-1eab-433f-b66a-a72002471c15_min3_1758542621376","attempt_id":"cb7bd7de-7940-42d4-9b93-64909724b7fa","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":6,"minutes_already_billed":2,"simulation_id":"a1ca69e6-7d0b-4c29-a4fc-4d749d89c598","case_title":"demo case"}
{"timestamp":"2025-09-22T12:03:41.395Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_65c4e57d-1eab-433f-b66a-a72002471c15_min3_1758542621376","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":6,"expected_balance_after":5,"minute_to_bill":3}
{"timestamp":"2025-09-22T12:03:41.401Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_65c4e57d-1eab-433f-b66a-a72002471c15_min3_1758542621376","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-22T12:03:41.404Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_65c4e57d-1eab-433f-b66a-a72002471c15_min3_1758542621376","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":6,"new_balance":5,"change":-1}
{"timestamp":"2025-09-22T12:03:41.404Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_65c4e57d-1eab-433f-b66a-a72002471c15_min3_1758542621376","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":5,"minute":3}
{"timestamp":"2025-09-22T12:03:41.407Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_65c4e57d-1eab-433f-b66a-a72002471c15_min3_1758542621376","transaction_id":"b7c0f34c-0b6d-46ec-bf5c-285e876e4202","transaction_type":"DEBIT","balance_after":5}
{"timestamp":"2025-09-22T12:03:41.407Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_65c4e57d-1eab-433f-b66a-a72002471c15_min3_1758542621376","attempt_id":"cb7bd7de-7940-42d4-9b93-64909724b7fa","new_minutes_billed":3,"new_duration_seconds":180}
{"timestamp":"2025-09-22T12:03:41.409Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_65c4e57d-1eab-433f-b66a-a72002471c15_min3_1758542621376","attempt_id":"cb7bd7de-7940-42d4-9b93-64909724b7fa","minutes_billed":3}
{"timestamp":"2025-09-22T12:03:41.410Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_65c4e57d-1eab-433f-b66a-a72002471c15_min3_1758542621376","transaction_duration_ms":15,"new_balance":5,"minute_billed":3,"total_minutes_billed_this_attempt":3,"total_successful":5,"total_minutes_billed_all_time":5,"avg_transaction_time":"15.00"}
{"timestamp":"2025-09-22T12:03:41.410Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_65c4e57d-1eab-433f-b66a-a72002471c15_min3_1758542621376","total_duration_ms":34,"transaction_duration_ms":15,"response":{"status":"continue","creditsRemaining":5,"minuteBilled":3,"totalMinutesBilled":3,"attemptId":"cb7bd7de-7940-42d4-9b93-64909724b7fa","shouldTerminate":false}}
{"timestamp":"2025-09-22T12:04:41.413679","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_65c4e57d-1eab-433f-b66a-a72002471c15_min4_1758542681423","correlation_token":"sim_a151b4f4b98ba14c99ec9a7ba50fff94_1758542500950","conversation_id":"65c4e57d-1eab-433f-b66a-a72002471c15","minute":4,"metrics_total_requests":6}
{"timestamp":"2025-09-22T12:04:41.424Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_65c4e57d-1eab-433f-b66a-a72002471c15_min4_1758542681423","correlation_token":"sim_a151b4f4b98ba14c99ec9a7ba50fff94_1758542500950"}
{"timestamp":"2025-09-22T12:04:41.438Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_65c4e57d-1eab-433f-b66a-a72002471c15_min4_1758542681423","minute_requested":4,"minutes_already_billed":3,"attempt_id":"cb7bd7de-7940-42d4-9b93-64909724b7fa"}
{"timestamp":"2025-09-22T12:04:41.438Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_65c4e57d-1eab-433f-b66a-a72002471c15_min4_1758542681423","attempt_id":"cb7bd7de-7940-42d4-9b93-64909724b7fa","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":5,"minutes_already_billed":3,"simulation_id":"a1ca69e6-7d0b-4c29-a4fc-4d749d89c598","case_title":"demo case"}
{"timestamp":"2025-09-22T12:04:41.438Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_65c4e57d-1eab-433f-b66a-a72002471c15_min4_1758542681423","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":5,"expected_balance_after":4,"minute_to_bill":4}
{"timestamp":"2025-09-22T12:04:41.442Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_65c4e57d-1eab-433f-b66a-a72002471c15_min4_1758542681423","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-22T12:04:41.445Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_65c4e57d-1eab-433f-b66a-a72002471c15_min4_1758542681423","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":5,"new_balance":4,"change":-1}
{"timestamp":"2025-09-22T12:04:41.445Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_65c4e57d-1eab-433f-b66a-a72002471c15_min4_1758542681423","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":4,"minute":4}
{"timestamp":"2025-09-22T12:04:41.448Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_65c4e57d-1eab-433f-b66a-a72002471c15_min4_1758542681423","transaction_id":"530947a7-a448-49fb-aa3c-821165274290","transaction_type":"DEBIT","balance_after":4}
{"timestamp":"2025-09-22T12:04:41.448Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_65c4e57d-1eab-433f-b66a-a72002471c15_min4_1758542681423","attempt_id":"cb7bd7de-7940-42d4-9b93-64909724b7fa","new_minutes_billed":4,"new_duration_seconds":240}
{"timestamp":"2025-09-22T12:04:41.452Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_65c4e57d-1eab-433f-b66a-a72002471c15_min4_1758542681423","attempt_id":"cb7bd7de-7940-42d4-9b93-64909724b7fa","minutes_billed":4}
{"timestamp":"2025-09-22T12:04:41.453Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_65c4e57d-1eab-433f-b66a-a72002471c15_min4_1758542681423","transaction_duration_ms":15,"new_balance":4,"minute_billed":4,"total_minutes_billed_this_attempt":4,"total_successful":6,"total_minutes_billed_all_time":6,"avg_transaction_time":"15.00"}
{"timestamp":"2025-09-22T12:04:41.453Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_65c4e57d-1eab-433f-b66a-a72002471c15_min4_1758542681423","total_duration_ms":30,"transaction_duration_ms":15,"response":{"status":"continue","creditsRemaining":4,"minuteBilled":4,"totalMinutesBilled":4,"attemptId":"cb7bd7de-7940-42d4-9b93-64909724b7fa","shouldTerminate":false}}
{"timestamp":"2025-09-22T12:05:41.457055","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_65c4e57d-1eab-433f-b66a-a72002471c15_min5_1758542741464","correlation_token":"sim_a151b4f4b98ba14c99ec9a7ba50fff94_1758542500950","conversation_id":"65c4e57d-1eab-433f-b66a-a72002471c15","minute":5,"metrics_total_requests":7}
{"timestamp":"2025-09-22T12:05:41.464Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_65c4e57d-1eab-433f-b66a-a72002471c15_min5_1758542741464","correlation_token":"sim_a151b4f4b98ba14c99ec9a7ba50fff94_1758542500950"}
{"timestamp":"2025-09-22T12:05:41.476Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_65c4e57d-1eab-433f-b66a-a72002471c15_min5_1758542741464","minute_requested":5,"minutes_already_billed":4,"attempt_id":"cb7bd7de-7940-42d4-9b93-64909724b7fa"}
{"timestamp":"2025-09-22T12:05:41.477Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_65c4e57d-1eab-433f-b66a-a72002471c15_min5_1758542741464","attempt_id":"cb7bd7de-7940-42d4-9b93-64909724b7fa","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":4,"minutes_already_billed":4,"simulation_id":"a1ca69e6-7d0b-4c29-a4fc-4d749d89c598","case_title":"demo case"}
{"timestamp":"2025-09-22T12:05:41.477Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_65c4e57d-1eab-433f-b66a-a72002471c15_min5_1758542741464","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":4,"expected_balance_after":3,"minute_to_bill":5}
{"timestamp":"2025-09-22T12:05:41.481Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_65c4e57d-1eab-433f-b66a-a72002471c15_min5_1758542741464","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-22T12:05:41.483Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_65c4e57d-1eab-433f-b66a-a72002471c15_min5_1758542741464","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":4,"new_balance":3,"change":-1}
{"timestamp":"2025-09-22T12:05:41.484Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_65c4e57d-1eab-433f-b66a-a72002471c15_min5_1758542741464","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":3,"minute":5}
{"timestamp":"2025-09-22T12:05:41.486Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_65c4e57d-1eab-433f-b66a-a72002471c15_min5_1758542741464","transaction_id":"9f043dd5-4867-4b74-8901-60984d61f512","transaction_type":"DEBIT","balance_after":3}
{"timestamp":"2025-09-22T12:05:41.486Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_65c4e57d-1eab-433f-b66a-a72002471c15_min5_1758542741464","attempt_id":"cb7bd7de-7940-42d4-9b93-64909724b7fa","new_minutes_billed":5,"new_duration_seconds":300}
{"timestamp":"2025-09-22T12:05:41.488Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_65c4e57d-1eab-433f-b66a-a72002471c15_min5_1758542741464","attempt_id":"cb7bd7de-7940-42d4-9b93-64909724b7fa","minutes_billed":5}
{"timestamp":"2025-09-22T12:05:41.490Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_65c4e57d-1eab-433f-b66a-a72002471c15_min5_1758542741464","transaction_duration_ms":13,"new_balance":3,"minute_billed":5,"total_minutes_billed_this_attempt":5,"total_successful":7,"total_minutes_billed_all_time":7,"avg_transaction_time":"14.71"}
{"timestamp":"2025-09-22T12:05:41.490Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_65c4e57d-1eab-433f-b66a-a72002471c15_min5_1758542741464","total_duration_ms":26,"transaction_duration_ms":13,"response":{"status":"continue","creditsRemaining":3,"minuteBilled":5,"totalMinutesBilled":5,"attemptId":"cb7bd7de-7940-42d4-9b93-64909724b7fa","shouldTerminate":false}}
{"timestamp":"2025-09-22T12:06:26.757440","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_4308a778-692a-4a04-ae06-dc1997a462ea_min1_1758542786759","correlation_token":"sim_82a049f739ca83d788bb55f34c2e9393_1758542786394","conversation_id":"4308a778-692a-4a04-ae06-dc1997a462ea","minute":1,"metrics_total_requests":8}
{"timestamp":"2025-09-22T12:06:26.759Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_4308a778-692a-4a04-ae06-dc1997a462ea_min1_1758542786759","correlation_token":"sim_82a049f739ca83d788bb55f34c2e9393_1758542786394"}
{"timestamp":"2025-09-22T12:06:26.764Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_4308a778-692a-4a04-ae06-dc1997a462ea_min1_1758542786759","minute_requested":1,"minutes_already_billed":0,"attempt_id":"9b23c949-b71d-4e52-af9f-a7d23f4b4cf8"}
{"timestamp":"2025-09-22T12:06:26.764Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_4308a778-692a-4a04-ae06-dc1997a462ea_min1_1758542786759","attempt_id":"9b23c949-b71d-4e52-af9f-a7d23f4b4cf8","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":3,"minutes_already_billed":0,"simulation_id":"a1ca69e6-7d0b-4c29-a4fc-4d749d89c598","case_title":"demo case"}
{"timestamp":"2025-09-22T12:06:26.764Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_4308a778-692a-4a04-ae06-dc1997a462ea_min1_1758542786759","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":3,"expected_balance_after":2,"minute_to_bill":1}
{"timestamp":"2025-09-22T12:06:26.767Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_4308a778-692a-4a04-ae06-dc1997a462ea_min1_1758542786759","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-22T12:06:26.769Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_4308a778-692a-4a04-ae06-dc1997a462ea_min1_1758542786759","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":3,"new_balance":2,"change":-1}
{"timestamp":"2025-09-22T12:06:26.770Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_4308a778-692a-4a04-ae06-dc1997a462ea_min1_1758542786759","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":2,"minute":1}
{"timestamp":"2025-09-22T12:06:26.772Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_4308a778-692a-4a04-ae06-dc1997a462ea_min1_1758542786759","transaction_id":"ab3a3fec-a1cd-48b0-991e-e258d97fe6aa","transaction_type":"DEBIT","balance_after":2}
{"timestamp":"2025-09-22T12:06:26.772Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_4308a778-692a-4a04-ae06-dc1997a462ea_min1_1758542786759","attempt_id":"9b23c949-b71d-4e52-af9f-a7d23f4b4cf8","new_minutes_billed":1,"new_duration_seconds":60}
{"timestamp":"2025-09-22T12:06:26.774Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_4308a778-692a-4a04-ae06-dc1997a462ea_min1_1758542786759","attempt_id":"9b23c949-b71d-4e52-af9f-a7d23f4b4cf8","minutes_billed":1}
{"timestamp":"2025-09-22T12:06:26.775Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_4308a778-692a-4a04-ae06-dc1997a462ea_min1_1758542786759","transaction_duration_ms":11,"new_balance":2,"minute_billed":1,"total_minutes_billed_this_attempt":1,"total_successful":8,"total_minutes_billed_all_time":8,"avg_transaction_time":"14.25"}
{"timestamp":"2025-09-22T12:06:26.775Z","level":"WARN","service":"BillingService","message":"Low credits warning threshold reached","requestId":"bill_4308a778-692a-4a04-ae06-dc1997a462ea_min1_1758542786759","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","credits_remaining":2,"minute_billed":1,"warning_threshold":2}
{"timestamp":"2025-09-22T12:06:26.775Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_4308a778-692a-4a04-ae06-dc1997a462ea_min1_1758542786759","total_duration_ms":16,"transaction_duration_ms":11,"response":{"status":"warning","creditsRemaining":2,"minuteBilled":1,"totalMinutesBilled":1,"attemptId":"9b23c949-b71d-4e52-af9f-a7d23f4b4cf8","shouldTerminate":false,"message":"Low credits warning: 2 minute(s) remaining"}}
{"timestamp":"2025-09-22T13:56:53.415Z","level":"INFO","service":"BillingService","message":"BillingService initialized","environment":"development","database_url":"configured"}
{"timestamp":"2025-09-22T14:26:22.177658","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_eac026aa-7f14-4807-924d-1adcb65deca7_min1_1758551182197","correlation_token":"transcript-1758551179353-6fuluyk8z","conversation_id":"eac026aa-7f14-4807-924d-1adcb65deca7","minute":1,"metrics_total_requests":1}
{"timestamp":"2025-09-22T14:26:22.197Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_eac026aa-7f14-4807-924d-1adcb65deca7_min1_1758551182197","correlation_token":"transcript-1758551179353-6fuluyk8z"}
{"timestamp":"2025-09-22T14:26:22.290Z","level":"ERROR","service":"BillingService","message":"Invalid correlation token - no attempt found","requestId":"bill_eac026aa-7f14-4807-924d-1adcb65deca7_min1_1758551182197","correlation_token":"transcript-1758551179353-6fuluyk8z","conversation_id":"eac026aa-7f14-4807-924d-1adcb65deca7"}
{"timestamp":"2025-09-22T14:27:02.141592","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_813ec7e3-95f1-4012-8547-73dd5c664932_min1_1758551222151","correlation_token":"transcript-1758551221348-1e5o98lml","conversation_id":"813ec7e3-95f1-4012-8547-73dd5c664932","minute":1,"metrics_total_requests":2}
{"timestamp":"2025-09-22T14:27:02.152Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_813ec7e3-95f1-4012-8547-73dd5c664932_min1_1758551222151","correlation_token":"transcript-1758551221348-1e5o98lml"}
{"timestamp":"2025-09-22T14:27:02.161Z","level":"ERROR","service":"BillingService","message":"Invalid correlation token - no attempt found","requestId":"bill_813ec7e3-95f1-4012-8547-73dd5c664932_min1_1758551222151","correlation_token":"transcript-1758551221348-1e5o98lml","conversation_id":"813ec7e3-95f1-4012-8547-73dd5c664932"}
{"timestamp":"2025-09-22T14:28:08.516713","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_92bbc661-7f3e-4882-8e2f-9c7d94aa42d4_min1_1758551288524","correlation_token":"transcript-1758551288210-7c2x7hf5j","conversation_id":"92bbc661-7f3e-4882-8e2f-9c7d94aa42d4","minute":1,"metrics_total_requests":3}
{"timestamp":"2025-09-22T14:28:08.524Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_92bbc661-7f3e-4882-8e2f-9c7d94aa42d4_min1_1758551288524","correlation_token":"transcript-1758551288210-7c2x7hf5j"}
{"timestamp":"2025-09-22T14:28:08.543Z","level":"ERROR","service":"BillingService","message":"Invalid correlation token - no attempt found","requestId":"bill_92bbc661-7f3e-4882-8e2f-9c7d94aa42d4_min1_1758551288524","correlation_token":"transcript-1758551288210-7c2x7hf5j","conversation_id":"92bbc661-7f3e-4882-8e2f-9c7d94aa42d4"}
{"timestamp":"2025-09-22T14:29:05.837647","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_a5849a1a-ad04-4720-bd76-e4f05f74e132_min1_1758551345839","correlation_token":"transcript-1758551345528-6dkx0jygp","conversation_id":"a5849a1a-ad04-4720-bd76-e4f05f74e132","minute":1,"metrics_total_requests":4}
{"timestamp":"2025-09-22T14:29:05.839Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_a5849a1a-ad04-4720-bd76-e4f05f74e132_min1_1758551345839","correlation_token":"transcript-1758551345528-6dkx0jygp"}
{"timestamp":"2025-09-22T14:29:05.845Z","level":"ERROR","service":"BillingService","message":"Invalid correlation token - no attempt found","requestId":"bill_a5849a1a-ad04-4720-bd76-e4f05f74e132_min1_1758551345839","correlation_token":"transcript-1758551345528-6dkx0jygp","conversation_id":"a5849a1a-ad04-4720-bd76-e4f05f74e132"}
{"timestamp":"2025-09-22T14:29:43.455376","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_3ad6b800-8492-473a-b936-ccb4c933915b_min1_1758551383457","correlation_token":"transcript-1758551383159-jt51g0gi5","conversation_id":"3ad6b800-8492-473a-b936-ccb4c933915b","minute":1,"metrics_total_requests":5}
{"timestamp":"2025-09-22T14:29:43.457Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_3ad6b800-8492-473a-b936-ccb4c933915b_min1_1758551383457","correlation_token":"transcript-1758551383159-jt51g0gi5"}
{"timestamp":"2025-09-22T14:29:43.463Z","level":"ERROR","service":"BillingService","message":"Invalid correlation token - no attempt found","requestId":"bill_3ad6b800-8492-473a-b936-ccb4c933915b_min1_1758551383457","correlation_token":"transcript-1758551383159-jt51g0gi5","conversation_id":"3ad6b800-8492-473a-b936-ccb4c933915b"}
{"timestamp":"2025-09-22T14:30:16.478405","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_db5fa6e4-68d4-4c6b-84d8-852a9c644d79_min1_1758551416482","correlation_token":"transcript-1758551415720-6tog0wqsm","conversation_id":"db5fa6e4-68d4-4c6b-84d8-852a9c644d79","minute":1,"metrics_total_requests":6}
{"timestamp":"2025-09-22T14:30:16.482Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_db5fa6e4-68d4-4c6b-84d8-852a9c644d79_min1_1758551416482","correlation_token":"transcript-1758551415720-6tog0wqsm"}
{"timestamp":"2025-09-22T14:30:16.495Z","level":"ERROR","service":"BillingService","message":"Invalid correlation token - no attempt found","requestId":"bill_db5fa6e4-68d4-4c6b-84d8-852a9c644d79_min1_1758551416482","correlation_token":"transcript-1758551415720-6tog0wqsm","conversation_id":"db5fa6e4-68d4-4c6b-84d8-852a9c644d79"}
{"timestamp":"2025-09-22T15:33:49.402925","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_90421b88-e5b3-4391-ad11-5512dd97316a_min1_1758555229407","correlation_token":"transcript-1758555225603-jhkrxnioh","conversation_id":"90421b88-e5b3-4391-ad11-5512dd97316a","minute":1,"metrics_total_requests":7}
{"timestamp":"2025-09-22T15:33:49.407Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_90421b88-e5b3-4391-ad11-5512dd97316a_min1_1758555229407","correlation_token":"transcript-1758555225603-jhkrxnioh"}
{"timestamp":"2025-09-22T15:33:49.423Z","level":"ERROR","service":"BillingService","message":"Invalid correlation token - no attempt found","requestId":"bill_90421b88-e5b3-4391-ad11-5512dd97316a_min1_1758555229407","correlation_token":"transcript-1758555225603-jhkrxnioh","conversation_id":"90421b88-e5b3-4391-ad11-5512dd97316a"}
{"timestamp":"2025-09-22T15:33:58.308554","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_923d004c-9e42-4df2-8a73-ee09b8a0fc11_min1_1758555238310","correlation_token":"transcript-1758555238039-zdcc32wjy","conversation_id":"923d004c-9e42-4df2-8a73-ee09b8a0fc11","minute":1,"metrics_total_requests":8}
{"timestamp":"2025-09-22T15:33:58.310Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_923d004c-9e42-4df2-8a73-ee09b8a0fc11_min1_1758555238310","correlation_token":"transcript-1758555238039-zdcc32wjy"}
{"timestamp":"2025-09-22T15:33:58.321Z","level":"ERROR","service":"BillingService","message":"Invalid correlation token - no attempt found","requestId":"bill_923d004c-9e42-4df2-8a73-ee09b8a0fc11_min1_1758555238310","correlation_token":"transcript-1758555238039-zdcc32wjy","conversation_id":"923d004c-9e42-4df2-8a73-ee09b8a0fc11"}
{"timestamp":"2025-09-22T15:34:58.551182","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_6968997a-2fd7-4f63-94e4-6ad67431751b_min1_1758555298553","correlation_token":"sim_94e68a7753c1432a53b12477ee1ab672_1758555279689","conversation_id":"6968997a-2fd7-4f63-94e4-6ad67431751b","minute":1,"metrics_total_requests":9}
{"timestamp":"2025-09-22T15:34:58.553Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_6968997a-2fd7-4f63-94e4-6ad67431751b_min1_1758555298553","correlation_token":"sim_94e68a7753c1432a53b12477ee1ab672_1758555279689"}
{"timestamp":"2025-09-22T15:34:58.560Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_6968997a-2fd7-4f63-94e4-6ad67431751b_min1_1758555298553","minute_requested":1,"minutes_already_billed":0,"attempt_id":"caa77987-088e-4282-9c71-df05fb0d6a63"}
{"timestamp":"2025-09-22T15:34:58.560Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_6968997a-2fd7-4f63-94e4-6ad67431751b_min1_1758555298553","attempt_id":"caa77987-088e-4282-9c71-df05fb0d6a63","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":12,"minutes_already_billed":0,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-22T15:34:58.560Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_6968997a-2fd7-4f63-94e4-6ad67431751b_min1_1758555298553","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":12,"expected_balance_after":11,"minute_to_bill":1}
{"timestamp":"2025-09-22T15:34:58.568Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_6968997a-2fd7-4f63-94e4-6ad67431751b_min1_1758555298553","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-22T15:34:58.571Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_6968997a-2fd7-4f63-94e4-6ad67431751b_min1_1758555298553","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":12,"new_balance":11,"change":-1}
{"timestamp":"2025-09-22T15:34:58.571Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_6968997a-2fd7-4f63-94e4-6ad67431751b_min1_1758555298553","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":11,"minute":1}
{"timestamp":"2025-09-22T15:34:58.574Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_6968997a-2fd7-4f63-94e4-6ad67431751b_min1_1758555298553","transaction_id":"889d232b-653e-48f9-9efb-b027a52ba1d4","transaction_type":"DEBIT","balance_after":11}
{"timestamp":"2025-09-22T15:34:58.574Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_6968997a-2fd7-4f63-94e4-6ad67431751b_min1_1758555298553","attempt_id":"caa77987-088e-4282-9c71-df05fb0d6a63","new_minutes_billed":1,"new_duration_seconds":60}
{"timestamp":"2025-09-22T15:34:58.576Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_6968997a-2fd7-4f63-94e4-6ad67431751b_min1_1758555298553","attempt_id":"caa77987-088e-4282-9c71-df05fb0d6a63","minutes_billed":1}
{"timestamp":"2025-09-22T15:34:58.579Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_6968997a-2fd7-4f63-94e4-6ad67431751b_min1_1758555298553","transaction_duration_ms":19,"new_balance":11,"minute_billed":1,"total_minutes_billed_this_attempt":1,"total_successful":1,"total_minutes_billed_all_time":1,"avg_transaction_time":"19.00"}
{"timestamp":"2025-09-22T15:34:58.579Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_6968997a-2fd7-4f63-94e4-6ad67431751b_min1_1758555298553","total_duration_ms":26,"transaction_duration_ms":19,"response":{"status":"continue","creditsRemaining":11,"minuteBilled":1,"totalMinutesBilled":1,"attemptId":"caa77987-088e-4282-9c71-df05fb0d6a63","shouldTerminate":false}}
{"timestamp":"2025-09-22T15:35:52.352622","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_8318d371-68a1-45fe-a613-3edbad967602_min1_1758555352354","correlation_token":"sim_94e68a7753c1432a53b12477ee1ab672_1758555279689","conversation_id":"8318d371-68a1-45fe-a613-3edbad967602","minute":1,"metrics_total_requests":10}
{"timestamp":"2025-09-22T15:35:52.354Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_8318d371-68a1-45fe-a613-3edbad967602_min1_1758555352354","correlation_token":"sim_94e68a7753c1432a53b12477ee1ab672_1758555279689"}
{"timestamp":"2025-09-22T15:35:52.361Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_8318d371-68a1-45fe-a613-3edbad967602_min1_1758555352354","minute_requested":1,"minutes_already_billed":1,"attempt_id":"caa77987-088e-4282-9c71-df05fb0d6a63"}
{"timestamp":"2025-09-22T15:35:52.361Z","level":"WARN","service":"BillingService","message":"Minute already billed - returning idempotent response","requestId":"bill_8318d371-68a1-45fe-a613-3edbad967602_min1_1758555352354","minute_requested":1,"minutes_already_billed":1,"attempt_id":"caa77987-088e-4282-9c71-df05fb0d6a63","total_duplicates":1}
{"timestamp":"2025-09-22T15:35:52.361Z","level":"INFO","service":"BillingService","message":"Returning idempotent response","requestId":"bill_8318d371-68a1-45fe-a613-3edbad967602_min1_1758555352354","response":{"status":"continue","creditsRemaining":11,"minuteBilled":1,"totalMinutesBilled":1,"attemptId":"caa77987-088e-4282-9c71-df05fb0d6a63","shouldTerminate":false,"message":"Already billed (idempotent response)"},"duration_ms":7}
{"timestamp":"2025-09-22T15:36:15.039975","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_e9e92e75-7dc8-4f9f-bc75-c955086e3be0_min1_1758555375041","correlation_token":"sim_94e68a7753c1432a53b12477ee1ab672_1758555279689","conversation_id":"e9e92e75-7dc8-4f9f-bc75-c955086e3be0","minute":1,"metrics_total_requests":11}
{"timestamp":"2025-09-22T15:36:15.041Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_e9e92e75-7dc8-4f9f-bc75-c955086e3be0_min1_1758555375041","correlation_token":"sim_94e68a7753c1432a53b12477ee1ab672_1758555279689"}
{"timestamp":"2025-09-22T15:36:15.047Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_e9e92e75-7dc8-4f9f-bc75-c955086e3be0_min1_1758555375041","minute_requested":1,"minutes_already_billed":1,"attempt_id":"caa77987-088e-4282-9c71-df05fb0d6a63"}
{"timestamp":"2025-09-22T15:36:15.048Z","level":"WARN","service":"BillingService","message":"Minute already billed - returning idempotent response","requestId":"bill_e9e92e75-7dc8-4f9f-bc75-c955086e3be0_min1_1758555375041","minute_requested":1,"minutes_already_billed":1,"attempt_id":"caa77987-088e-4282-9c71-df05fb0d6a63","total_duplicates":2}
{"timestamp":"2025-09-22T15:36:15.048Z","level":"INFO","service":"BillingService","message":"Returning idempotent response","requestId":"bill_e9e92e75-7dc8-4f9f-bc75-c955086e3be0_min1_1758555375041","response":{"status":"continue","creditsRemaining":11,"minuteBilled":1,"totalMinutesBilled":1,"attemptId":"caa77987-088e-4282-9c71-df05fb0d6a63","shouldTerminate":false,"message":"Already billed (idempotent response)"},"duration_ms":7}
{"timestamp":"2025-09-22T15:36:52.363234","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_8318d371-68a1-45fe-a613-3edbad967602_min2_1758555412365","correlation_token":"sim_94e68a7753c1432a53b12477ee1ab672_1758555279689","conversation_id":"8318d371-68a1-45fe-a613-3edbad967602","minute":2,"metrics_total_requests":12}
{"timestamp":"2025-09-22T15:36:52.365Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_8318d371-68a1-45fe-a613-3edbad967602_min2_1758555412365","correlation_token":"sim_94e68a7753c1432a53b12477ee1ab672_1758555279689"}
{"timestamp":"2025-09-22T15:36:52.372Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_8318d371-68a1-45fe-a613-3edbad967602_min2_1758555412365","minute_requested":2,"minutes_already_billed":1,"attempt_id":"caa77987-088e-4282-9c71-df05fb0d6a63"}
{"timestamp":"2025-09-22T15:36:52.373Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_8318d371-68a1-45fe-a613-3edbad967602_min2_1758555412365","attempt_id":"caa77987-088e-4282-9c71-df05fb0d6a63","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":11,"minutes_already_billed":1,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-22T15:36:52.373Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_8318d371-68a1-45fe-a613-3edbad967602_min2_1758555412365","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":11,"expected_balance_after":10,"minute_to_bill":2}
{"timestamp":"2025-09-22T15:36:52.376Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_8318d371-68a1-45fe-a613-3edbad967602_min2_1758555412365","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-22T15:36:52.378Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_8318d371-68a1-45fe-a613-3edbad967602_min2_1758555412365","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":11,"new_balance":10,"change":-1}
{"timestamp":"2025-09-22T15:36:52.378Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_8318d371-68a1-45fe-a613-3edbad967602_min2_1758555412365","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":10,"minute":2}
{"timestamp":"2025-09-22T15:36:52.379Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_8318d371-68a1-45fe-a613-3edbad967602_min2_1758555412365","transaction_id":"791e672c-ef58-4906-93db-d1098dc46185","transaction_type":"DEBIT","balance_after":10}
{"timestamp":"2025-09-22T15:36:52.379Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_8318d371-68a1-45fe-a613-3edbad967602_min2_1758555412365","attempt_id":"caa77987-088e-4282-9c71-df05fb0d6a63","new_minutes_billed":2,"new_duration_seconds":120}
{"timestamp":"2025-09-22T15:36:52.382Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_8318d371-68a1-45fe-a613-3edbad967602_min2_1758555412365","attempt_id":"caa77987-088e-4282-9c71-df05fb0d6a63","minutes_billed":2}
{"timestamp":"2025-09-22T15:36:52.385Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_8318d371-68a1-45fe-a613-3edbad967602_min2_1758555412365","transaction_duration_ms":12,"new_balance":10,"minute_billed":2,"total_minutes_billed_this_attempt":2,"total_successful":2,"total_minutes_billed_all_time":2,"avg_transaction_time":"15.50"}
{"timestamp":"2025-09-22T15:36:52.385Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_8318d371-68a1-45fe-a613-3edbad967602_min2_1758555412365","total_duration_ms":20,"transaction_duration_ms":12,"response":{"status":"continue","creditsRemaining":10,"minuteBilled":2,"totalMinutesBilled":2,"attemptId":"caa77987-088e-4282-9c71-df05fb0d6a63","shouldTerminate":false}}
{"timestamp":"2025-09-22T15:37:15.050893","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_e9e92e75-7dc8-4f9f-bc75-c955086e3be0_min2_1758555435052","correlation_token":"sim_94e68a7753c1432a53b12477ee1ab672_1758555279689","conversation_id":"e9e92e75-7dc8-4f9f-bc75-c955086e3be0","minute":2,"metrics_total_requests":13}
{"timestamp":"2025-09-22T15:37:15.053Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_e9e92e75-7dc8-4f9f-bc75-c955086e3be0_min2_1758555435052","correlation_token":"sim_94e68a7753c1432a53b12477ee1ab672_1758555279689"}
{"timestamp":"2025-09-22T15:37:15.061Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_e9e92e75-7dc8-4f9f-bc75-c955086e3be0_min2_1758555435052","minute_requested":2,"minutes_already_billed":2,"attempt_id":"caa77987-088e-4282-9c71-df05fb0d6a63"}
{"timestamp":"2025-09-22T15:37:15.061Z","level":"WARN","service":"BillingService","message":"Minute already billed - returning idempotent response","requestId":"bill_e9e92e75-7dc8-4f9f-bc75-c955086e3be0_min2_1758555435052","minute_requested":2,"minutes_already_billed":2,"attempt_id":"caa77987-088e-4282-9c71-df05fb0d6a63","total_duplicates":3}
{"timestamp":"2025-09-22T15:37:15.061Z","level":"INFO","service":"BillingService","message":"Returning idempotent response","requestId":"bill_e9e92e75-7dc8-4f9f-bc75-c955086e3be0_min2_1758555435052","response":{"status":"continue","creditsRemaining":10,"minuteBilled":2,"totalMinutesBilled":2,"attemptId":"caa77987-088e-4282-9c71-df05fb0d6a63","shouldTerminate":false,"message":"Already billed (idempotent response)"},"duration_ms":9}
{"timestamp":"2025-09-22T15:37:52.389183","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_8318d371-68a1-45fe-a613-3edbad967602_min3_1758555472395","correlation_token":"sim_94e68a7753c1432a53b12477ee1ab672_1758555279689","conversation_id":"8318d371-68a1-45fe-a613-3edbad967602","minute":3,"metrics_total_requests":14}
{"timestamp":"2025-09-22T15:37:52.396Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_8318d371-68a1-45fe-a613-3edbad967602_min3_1758555472395","correlation_token":"sim_94e68a7753c1432a53b12477ee1ab672_1758555279689"}
{"timestamp":"2025-09-22T15:37:52.411Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_8318d371-68a1-45fe-a613-3edbad967602_min3_1758555472395","minute_requested":3,"minutes_already_billed":2,"attempt_id":"caa77987-088e-4282-9c71-df05fb0d6a63"}
{"timestamp":"2025-09-22T15:37:52.411Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_8318d371-68a1-45fe-a613-3edbad967602_min3_1758555472395","attempt_id":"caa77987-088e-4282-9c71-df05fb0d6a63","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":10,"minutes_already_billed":2,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-22T15:37:52.411Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_8318d371-68a1-45fe-a613-3edbad967602_min3_1758555472395","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":10,"expected_balance_after":9,"minute_to_bill":3}
{"timestamp":"2025-09-22T15:37:52.416Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_8318d371-68a1-45fe-a613-3edbad967602_min3_1758555472395","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-22T15:37:52.419Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_8318d371-68a1-45fe-a613-3edbad967602_min3_1758555472395","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":10,"new_balance":9,"change":-1}
{"timestamp":"2025-09-22T15:37:52.419Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_8318d371-68a1-45fe-a613-3edbad967602_min3_1758555472395","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":9,"minute":3}
{"timestamp":"2025-09-22T15:37:52.422Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_8318d371-68a1-45fe-a613-3edbad967602_min3_1758555472395","transaction_id":"501232e9-361b-4d85-b832-54a1fe559efc","transaction_type":"DEBIT","balance_after":9}
{"timestamp":"2025-09-22T15:37:52.422Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_8318d371-68a1-45fe-a613-3edbad967602_min3_1758555472395","attempt_id":"caa77987-088e-4282-9c71-df05fb0d6a63","new_minutes_billed":3,"new_duration_seconds":180}
{"timestamp":"2025-09-22T15:37:52.424Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_8318d371-68a1-45fe-a613-3edbad967602_min3_1758555472395","attempt_id":"caa77987-088e-4282-9c71-df05fb0d6a63","minutes_billed":3}
{"timestamp":"2025-09-22T15:37:52.426Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_8318d371-68a1-45fe-a613-3edbad967602_min3_1758555472395","transaction_duration_ms":15,"new_balance":9,"minute_billed":3,"total_minutes_billed_this_attempt":3,"total_successful":3,"total_minutes_billed_all_time":3,"avg_transaction_time":"15.33"}
{"timestamp":"2025-09-22T15:37:52.426Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_8318d371-68a1-45fe-a613-3edbad967602_min3_1758555472395","total_duration_ms":31,"transaction_duration_ms":15,"response":{"status":"continue","creditsRemaining":9,"minuteBilled":3,"totalMinutesBilled":3,"attemptId":"caa77987-088e-4282-9c71-df05fb0d6a63","shouldTerminate":false}}
{"timestamp":"2025-09-22T15:38:15.064432","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_e9e92e75-7dc8-4f9f-bc75-c955086e3be0_min3_1758555495071","correlation_token":"sim_94e68a7753c1432a53b12477ee1ab672_1758555279689","conversation_id":"e9e92e75-7dc8-4f9f-bc75-c955086e3be0","minute":3,"metrics_total_requests":15}
{"timestamp":"2025-09-22T15:38:15.071Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_e9e92e75-7dc8-4f9f-bc75-c955086e3be0_min3_1758555495071","correlation_token":"sim_94e68a7753c1432a53b12477ee1ab672_1758555279689"}
{"timestamp":"2025-09-22T15:38:15.083Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_e9e92e75-7dc8-4f9f-bc75-c955086e3be0_min3_1758555495071","minute_requested":3,"minutes_already_billed":3,"attempt_id":"caa77987-088e-4282-9c71-df05fb0d6a63"}
{"timestamp":"2025-09-22T15:38:15.083Z","level":"WARN","service":"BillingService","message":"Minute already billed - returning idempotent response","requestId":"bill_e9e92e75-7dc8-4f9f-bc75-c955086e3be0_min3_1758555495071","minute_requested":3,"minutes_already_billed":3,"attempt_id":"caa77987-088e-4282-9c71-df05fb0d6a63","total_duplicates":4}
{"timestamp":"2025-09-22T15:38:15.083Z","level":"INFO","service":"BillingService","message":"Returning idempotent response","requestId":"bill_e9e92e75-7dc8-4f9f-bc75-c955086e3be0_min3_1758555495071","response":{"status":"continue","creditsRemaining":9,"minuteBilled":3,"totalMinutesBilled":3,"attemptId":"caa77987-088e-4282-9c71-df05fb0d6a63","shouldTerminate":false,"message":"Already billed (idempotent response)"},"duration_ms":12}
{"timestamp":"2025-09-22T15:40:32.115913","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_6e45041b-79fd-407d-a865-e34af73e85ba_min1_1758555632119","correlation_token":"sim_94e68a7753c1432a53b12477ee1ab672_1758555279689","conversation_id":"6e45041b-79fd-407d-a865-e34af73e85ba","minute":1,"metrics_total_requests":16}
{"timestamp":"2025-09-22T15:40:32.119Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_6e45041b-79fd-407d-a865-e34af73e85ba_min1_1758555632119","correlation_token":"sim_94e68a7753c1432a53b12477ee1ab672_1758555279689"}
{"timestamp":"2025-09-22T15:40:32.138Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_6e45041b-79fd-407d-a865-e34af73e85ba_min1_1758555632119","minute_requested":1,"minutes_already_billed":3,"attempt_id":"caa77987-088e-4282-9c71-df05fb0d6a63"}
{"timestamp":"2025-09-22T15:40:32.138Z","level":"WARN","service":"BillingService","message":"Minute already billed - returning idempotent response","requestId":"bill_6e45041b-79fd-407d-a865-e34af73e85ba_min1_1758555632119","minute_requested":1,"minutes_already_billed":3,"attempt_id":"caa77987-088e-4282-9c71-df05fb0d6a63","total_duplicates":5}
{"timestamp":"2025-09-22T15:40:32.138Z","level":"INFO","service":"BillingService","message":"Returning idempotent response","requestId":"bill_6e45041b-79fd-407d-a865-e34af73e85ba_min1_1758555632119","response":{"status":"continue","creditsRemaining":9,"minuteBilled":1,"totalMinutesBilled":3,"attemptId":"caa77987-088e-4282-9c71-df05fb0d6a63","shouldTerminate":false,"message":"Already billed (idempotent response)"},"duration_ms":19}
{"timestamp":"2025-09-22T15:41:32.141711","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_6e45041b-79fd-407d-a865-e34af73e85ba_min2_1758555692149","correlation_token":"sim_94e68a7753c1432a53b12477ee1ab672_1758555279689","conversation_id":"6e45041b-79fd-407d-a865-e34af73e85ba","minute":2,"metrics_total_requests":17}
{"timestamp":"2025-09-22T15:41:32.149Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_6e45041b-79fd-407d-a865-e34af73e85ba_min2_1758555692149","correlation_token":"sim_94e68a7753c1432a53b12477ee1ab672_1758555279689"}
{"timestamp":"2025-09-22T15:41:32.166Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_6e45041b-79fd-407d-a865-e34af73e85ba_min2_1758555692149","minute_requested":2,"minutes_already_billed":3,"attempt_id":"caa77987-088e-4282-9c71-df05fb0d6a63"}
{"timestamp":"2025-09-22T15:41:32.166Z","level":"WARN","service":"BillingService","message":"Minute already billed - returning idempotent response","requestId":"bill_6e45041b-79fd-407d-a865-e34af73e85ba_min2_1758555692149","minute_requested":2,"minutes_already_billed":3,"attempt_id":"caa77987-088e-4282-9c71-df05fb0d6a63","total_duplicates":6}
{"timestamp":"2025-09-22T15:41:32.166Z","level":"INFO","service":"BillingService","message":"Returning idempotent response","requestId":"bill_6e45041b-79fd-407d-a865-e34af73e85ba_min2_1758555692149","response":{"status":"continue","creditsRemaining":9,"minuteBilled":2,"totalMinutesBilled":3,"attemptId":"caa77987-088e-4282-9c71-df05fb0d6a63","shouldTerminate":false,"message":"Already billed (idempotent response)"},"duration_ms":17}
{"timestamp":"2025-09-22T15:42:42.378640","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_26392864-1afc-4b3f-a78c-6fd0d708c645_min1_1758555762383","correlation_token":"sim_94e68a7753c1432a53b12477ee1ab672_1758555279689","conversation_id":"26392864-1afc-4b3f-a78c-6fd0d708c645","minute":1,"metrics_total_requests":18}
{"timestamp":"2025-09-22T15:42:42.383Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_26392864-1afc-4b3f-a78c-6fd0d708c645_min1_1758555762383","correlation_token":"sim_94e68a7753c1432a53b12477ee1ab672_1758555279689"}
{"timestamp":"2025-09-22T15:42:42.402Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_26392864-1afc-4b3f-a78c-6fd0d708c645_min1_1758555762383","minute_requested":1,"minutes_already_billed":3,"attempt_id":"caa77987-088e-4282-9c71-df05fb0d6a63"}
{"timestamp":"2025-09-22T15:42:42.402Z","level":"WARN","service":"BillingService","message":"Minute already billed - returning idempotent response","requestId":"bill_26392864-1afc-4b3f-a78c-6fd0d708c645_min1_1758555762383","minute_requested":1,"minutes_already_billed":3,"attempt_id":"caa77987-088e-4282-9c71-df05fb0d6a63","total_duplicates":7}
{"timestamp":"2025-09-22T15:42:42.402Z","level":"INFO","service":"BillingService","message":"Returning idempotent response","requestId":"bill_26392864-1afc-4b3f-a78c-6fd0d708c645_min1_1758555762383","response":{"status":"continue","creditsRemaining":9,"minuteBilled":1,"totalMinutesBilled":3,"attemptId":"caa77987-088e-4282-9c71-df05fb0d6a63","shouldTerminate":false,"message":"Already billed (idempotent response)"},"duration_ms":19}
{"timestamp":"2025-09-22T15:43:42.407144","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_26392864-1afc-4b3f-a78c-6fd0d708c645_min2_1758555822416","correlation_token":"sim_94e68a7753c1432a53b12477ee1ab672_1758555279689","conversation_id":"26392864-1afc-4b3f-a78c-6fd0d708c645","minute":2,"metrics_total_requests":19}
{"timestamp":"2025-09-22T15:43:42.416Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_26392864-1afc-4b3f-a78c-6fd0d708c645_min2_1758555822416","correlation_token":"sim_94e68a7753c1432a53b12477ee1ab672_1758555279689"}
{"timestamp":"2025-09-22T15:43:42.434Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_26392864-1afc-4b3f-a78c-6fd0d708c645_min2_1758555822416","minute_requested":2,"minutes_already_billed":3,"attempt_id":"caa77987-088e-4282-9c71-df05fb0d6a63"}
{"timestamp":"2025-09-22T15:43:42.434Z","level":"WARN","service":"BillingService","message":"Minute already billed - returning idempotent response","requestId":"bill_26392864-1afc-4b3f-a78c-6fd0d708c645_min2_1758555822416","minute_requested":2,"minutes_already_billed":3,"attempt_id":"caa77987-088e-4282-9c71-df05fb0d6a63","total_duplicates":8}
{"timestamp":"2025-09-22T15:43:42.434Z","level":"INFO","service":"BillingService","message":"Returning idempotent response","requestId":"bill_26392864-1afc-4b3f-a78c-6fd0d708c645_min2_1758555822416","response":{"status":"continue","creditsRemaining":9,"minuteBilled":2,"totalMinutesBilled":3,"attemptId":"caa77987-088e-4282-9c71-df05fb0d6a63","shouldTerminate":false,"message":"Already billed (idempotent response)"},"duration_ms":18}
{"timestamp":"2025-09-22T15:44:42.437970","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_26392864-1afc-4b3f-a78c-6fd0d708c645_min3_1758555882441","correlation_token":"sim_94e68a7753c1432a53b12477ee1ab672_1758555279689","conversation_id":"26392864-1afc-4b3f-a78c-6fd0d708c645","minute":3,"metrics_total_requests":20}
{"timestamp":"2025-09-22T15:44:42.441Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_26392864-1afc-4b3f-a78c-6fd0d708c645_min3_1758555882441","correlation_token":"sim_94e68a7753c1432a53b12477ee1ab672_1758555279689"}
{"timestamp":"2025-09-22T15:44:42.450Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_26392864-1afc-4b3f-a78c-6fd0d708c645_min3_1758555882441","minute_requested":3,"minutes_already_billed":3,"attempt_id":"caa77987-088e-4282-9c71-df05fb0d6a63"}
{"timestamp":"2025-09-22T15:44:42.450Z","level":"WARN","service":"BillingService","message":"Minute already billed - returning idempotent response","requestId":"bill_26392864-1afc-4b3f-a78c-6fd0d708c645_min3_1758555882441","minute_requested":3,"minutes_already_billed":3,"attempt_id":"caa77987-088e-4282-9c71-df05fb0d6a63","total_duplicates":9}
{"timestamp":"2025-09-22T15:44:42.450Z","level":"INFO","service":"BillingService","message":"Returning idempotent response","requestId":"bill_26392864-1afc-4b3f-a78c-6fd0d708c645_min3_1758555882441","response":{"status":"continue","creditsRemaining":9,"minuteBilled":3,"totalMinutesBilled":3,"attemptId":"caa77987-088e-4282-9c71-df05fb0d6a63","shouldTerminate":false,"message":"Already billed (idempotent response)"},"duration_ms":9}
{"timestamp":"2025-09-22T15:45:42.453269","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_26392864-1afc-4b3f-a78c-6fd0d708c645_min4_1758555942462","correlation_token":"sim_94e68a7753c1432a53b12477ee1ab672_1758555279689","conversation_id":"26392864-1afc-4b3f-a78c-6fd0d708c645","minute":4,"metrics_total_requests":21}
{"timestamp":"2025-09-22T15:45:42.463Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_26392864-1afc-4b3f-a78c-6fd0d708c645_min4_1758555942462","correlation_token":"sim_94e68a7753c1432a53b12477ee1ab672_1758555279689"}
{"timestamp":"2025-09-22T15:45:42.482Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_26392864-1afc-4b3f-a78c-6fd0d708c645_min4_1758555942462","minute_requested":4,"minutes_already_billed":3,"attempt_id":"caa77987-088e-4282-9c71-df05fb0d6a63"}
{"timestamp":"2025-09-22T15:45:42.482Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_26392864-1afc-4b3f-a78c-6fd0d708c645_min4_1758555942462","attempt_id":"caa77987-088e-4282-9c71-df05fb0d6a63","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":9,"minutes_already_billed":3,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-22T15:45:42.482Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_26392864-1afc-4b3f-a78c-6fd0d708c645_min4_1758555942462","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":9,"expected_balance_after":8,"minute_to_bill":4}
{"timestamp":"2025-09-22T15:45:42.487Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_26392864-1afc-4b3f-a78c-6fd0d708c645_min4_1758555942462","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-22T15:45:42.491Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_26392864-1afc-4b3f-a78c-6fd0d708c645_min4_1758555942462","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":9,"new_balance":8,"change":-1}
{"timestamp":"2025-09-22T15:45:42.491Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_26392864-1afc-4b3f-a78c-6fd0d708c645_min4_1758555942462","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":8,"minute":4}
{"timestamp":"2025-09-22T15:45:42.493Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_26392864-1afc-4b3f-a78c-6fd0d708c645_min4_1758555942462","transaction_id":"13fa610c-e1bb-461d-8e98-a2d8fba3105f","transaction_type":"DEBIT","balance_after":8}
{"timestamp":"2025-09-22T15:45:42.493Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_26392864-1afc-4b3f-a78c-6fd0d708c645_min4_1758555942462","attempt_id":"caa77987-088e-4282-9c71-df05fb0d6a63","new_minutes_billed":4,"new_duration_seconds":240}
{"timestamp":"2025-09-22T15:45:42.496Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_26392864-1afc-4b3f-a78c-6fd0d708c645_min4_1758555942462","attempt_id":"caa77987-088e-4282-9c71-df05fb0d6a63","minutes_billed":4}
{"timestamp":"2025-09-22T15:45:42.499Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_26392864-1afc-4b3f-a78c-6fd0d708c645_min4_1758555942462","transaction_duration_ms":17,"new_balance":8,"minute_billed":4,"total_minutes_billed_this_attempt":4,"total_successful":4,"total_minutes_billed_all_time":4,"avg_transaction_time":"15.75"}
{"timestamp":"2025-09-22T15:45:42.499Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_26392864-1afc-4b3f-a78c-6fd0d708c645_min4_1758555942462","total_duration_ms":37,"transaction_duration_ms":17,"response":{"status":"continue","creditsRemaining":8,"minuteBilled":4,"totalMinutesBilled":4,"attemptId":"caa77987-088e-4282-9c71-df05fb0d6a63","shouldTerminate":false}}
{"timestamp":"2025-09-22T15:46:42.503652","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_26392864-1afc-4b3f-a78c-6fd0d708c645_min5_1758556002506","correlation_token":"sim_94e68a7753c1432a53b12477ee1ab672_1758555279689","conversation_id":"26392864-1afc-4b3f-a78c-6fd0d708c645","minute":5,"metrics_total_requests":22}
{"timestamp":"2025-09-22T15:46:42.506Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_26392864-1afc-4b3f-a78c-6fd0d708c645_min5_1758556002506","correlation_token":"sim_94e68a7753c1432a53b12477ee1ab672_1758555279689"}
{"timestamp":"2025-09-22T15:46:42.519Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_26392864-1afc-4b3f-a78c-6fd0d708c645_min5_1758556002506","minute_requested":5,"minutes_already_billed":4,"attempt_id":"caa77987-088e-4282-9c71-df05fb0d6a63"}
{"timestamp":"2025-09-22T15:46:42.519Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_26392864-1afc-4b3f-a78c-6fd0d708c645_min5_1758556002506","attempt_id":"caa77987-088e-4282-9c71-df05fb0d6a63","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":8,"minutes_already_billed":4,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-22T15:46:42.519Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_26392864-1afc-4b3f-a78c-6fd0d708c645_min5_1758556002506","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":8,"expected_balance_after":7,"minute_to_bill":5}
{"timestamp":"2025-09-22T15:46:42.523Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_26392864-1afc-4b3f-a78c-6fd0d708c645_min5_1758556002506","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-22T15:46:42.526Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_26392864-1afc-4b3f-a78c-6fd0d708c645_min5_1758556002506","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":8,"new_balance":7,"change":-1}
{"timestamp":"2025-09-22T15:46:42.526Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_26392864-1afc-4b3f-a78c-6fd0d708c645_min5_1758556002506","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":7,"minute":5}
{"timestamp":"2025-09-22T15:46:42.528Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_26392864-1afc-4b3f-a78c-6fd0d708c645_min5_1758556002506","transaction_id":"a4aa33ea-8b45-4206-9518-45712300c58c","transaction_type":"DEBIT","balance_after":7}
{"timestamp":"2025-09-22T15:46:42.528Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_26392864-1afc-4b3f-a78c-6fd0d708c645_min5_1758556002506","attempt_id":"caa77987-088e-4282-9c71-df05fb0d6a63","new_minutes_billed":5,"new_duration_seconds":300}
{"timestamp":"2025-09-22T15:46:42.531Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_26392864-1afc-4b3f-a78c-6fd0d708c645_min5_1758556002506","attempt_id":"caa77987-088e-4282-9c71-df05fb0d6a63","minutes_billed":5}
{"timestamp":"2025-09-22T15:46:42.532Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_26392864-1afc-4b3f-a78c-6fd0d708c645_min5_1758556002506","transaction_duration_ms":13,"new_balance":7,"minute_billed":5,"total_minutes_billed_this_attempt":5,"total_successful":5,"total_minutes_billed_all_time":5,"avg_transaction_time":"15.20"}
{"timestamp":"2025-09-22T15:46:42.532Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_26392864-1afc-4b3f-a78c-6fd0d708c645_min5_1758556002506","total_duration_ms":26,"transaction_duration_ms":13,"response":{"status":"continue","creditsRemaining":7,"minuteBilled":5,"totalMinutesBilled":5,"attemptId":"caa77987-088e-4282-9c71-df05fb0d6a63","shouldTerminate":false}}
{"timestamp":"2025-09-22T15:47:47.537707","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_a1a65a7d-95d7-4d9e-b62d-f6b62a643a52_min1_1758556067542","correlation_token":"transcript-1758556066693-fcf4ryxot","conversation_id":"a1a65a7d-95d7-4d9e-b62d-f6b62a643a52","minute":1,"metrics_total_requests":23}
{"timestamp":"2025-09-22T15:47:47.543Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_a1a65a7d-95d7-4d9e-b62d-f6b62a643a52_min1_1758556067542","correlation_token":"transcript-1758556066693-fcf4ryxot"}
{"timestamp":"2025-09-22T15:47:47.552Z","level":"ERROR","service":"BillingService","message":"Invalid correlation token - no attempt found","requestId":"bill_a1a65a7d-95d7-4d9e-b62d-f6b62a643a52_min1_1758556067542","correlation_token":"transcript-1758556066693-fcf4ryxot","conversation_id":"a1a65a7d-95d7-4d9e-b62d-f6b62a643a52"}
{"timestamp":"2025-09-22T16:39:54.148807","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_7ff4a48f-ba4a-441b-a627-df15e4a975b1_min1_1758559194157","correlation_token":"transcript-1758559190797-yawukq1p7","conversation_id":"7ff4a48f-ba4a-441b-a627-df15e4a975b1","minute":1,"metrics_total_requests":24}
{"timestamp":"2025-09-22T16:39:54.157Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_7ff4a48f-ba4a-441b-a627-df15e4a975b1_min1_1758559194157","correlation_token":"transcript-1758559190797-yawukq1p7"}
{"timestamp":"2025-09-22T16:39:54.174Z","level":"ERROR","service":"BillingService","message":"Invalid correlation token - no attempt found","requestId":"bill_7ff4a48f-ba4a-441b-a627-df15e4a975b1_min1_1758559194157","correlation_token":"transcript-1758559190797-yawukq1p7","conversation_id":"7ff4a48f-ba4a-441b-a627-df15e4a975b1"}
{"timestamp":"2025-09-22T16:43:40.837618","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_262a1320-35ca-4cba-a891-85bafa2b8016_min1_1758559420844","correlation_token":"transcript-1758559420490-mqqnw3i5l","conversation_id":"262a1320-35ca-4cba-a891-85bafa2b8016","minute":1,"metrics_total_requests":25}
{"timestamp":"2025-09-22T16:43:40.845Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_262a1320-35ca-4cba-a891-85bafa2b8016_min1_1758559420844","correlation_token":"transcript-1758559420490-mqqnw3i5l"}
{"timestamp":"2025-09-22T16:43:40.850Z","level":"ERROR","service":"BillingService","message":"Invalid correlation token - no attempt found","requestId":"bill_262a1320-35ca-4cba-a891-85bafa2b8016_min1_1758559420844","correlation_token":"transcript-1758559420490-mqqnw3i5l","conversation_id":"262a1320-35ca-4cba-a891-85bafa2b8016"}
{"timestamp":"2025-09-22T16:45:24.736957","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_03285d81-12bc-4fe7-9683-8f672f33d609_min1_1758559524740","correlation_token":"transcript-1758559524502-whwmh0g8h","conversation_id":"03285d81-12bc-4fe7-9683-8f672f33d609","minute":1,"metrics_total_requests":26}
{"timestamp":"2025-09-22T16:45:24.741Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_03285d81-12bc-4fe7-9683-8f672f33d609_min1_1758559524740","correlation_token":"transcript-1758559524502-whwmh0g8h"}
{"timestamp":"2025-09-22T16:45:24.756Z","level":"ERROR","service":"BillingService","message":"Invalid correlation token - no attempt found","requestId":"bill_03285d81-12bc-4fe7-9683-8f672f33d609_min1_1758559524740","correlation_token":"transcript-1758559524502-whwmh0g8h","conversation_id":"03285d81-12bc-4fe7-9683-8f672f33d609"}
{"timestamp":"2025-09-22T16:45:46.600577","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_8405af04-11d4-4b15-a3f6-44036f391a94_min1_1758559546602","correlation_token":"transcript-1758559546403-1ssvi96ic","conversation_id":"8405af04-11d4-4b15-a3f6-44036f391a94","minute":1,"metrics_total_requests":27}
{"timestamp":"2025-09-22T16:45:46.602Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_8405af04-11d4-4b15-a3f6-44036f391a94_min1_1758559546602","correlation_token":"transcript-1758559546403-1ssvi96ic"}
{"timestamp":"2025-09-22T16:45:46.607Z","level":"ERROR","service":"BillingService","message":"Invalid correlation token - no attempt found","requestId":"bill_8405af04-11d4-4b15-a3f6-44036f391a94_min1_1758559546602","correlation_token":"transcript-1758559546403-1ssvi96ic","conversation_id":"8405af04-11d4-4b15-a3f6-44036f391a94"}
{"timestamp":"2025-09-22T16:46:01.178566","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_e1454cc6-994d-4679-bba0-4d5c7f0ba128_min1_1758559561180","correlation_token":"transcript-1758559561000-0qga8v55d","conversation_id":"e1454cc6-994d-4679-bba0-4d5c7f0ba128","minute":1,"metrics_total_requests":28}
{"timestamp":"2025-09-22T16:46:01.180Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_e1454cc6-994d-4679-bba0-4d5c7f0ba128_min1_1758559561180","correlation_token":"transcript-1758559561000-0qga8v55d"}
{"timestamp":"2025-09-22T16:46:01.186Z","level":"ERROR","service":"BillingService","message":"Invalid correlation token - no attempt found","requestId":"bill_e1454cc6-994d-4679-bba0-4d5c7f0ba128_min1_1758559561180","correlation_token":"transcript-1758559561000-0qga8v55d","conversation_id":"e1454cc6-994d-4679-bba0-4d5c7f0ba128"}
{"timestamp":"2025-09-22T16:48:58.640567","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_da910d49-e48e-4d21-a668-b9fbfb625267_min1_1758559738643","correlation_token":"transcript-1758559738419-yr2zx555t","conversation_id":"da910d49-e48e-4d21-a668-b9fbfb625267","minute":1,"metrics_total_requests":29}
{"timestamp":"2025-09-22T16:48:58.643Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_da910d49-e48e-4d21-a668-b9fbfb625267_min1_1758559738643","correlation_token":"transcript-1758559738419-yr2zx555t"}
{"timestamp":"2025-09-22T16:48:58.650Z","level":"ERROR","service":"BillingService","message":"Invalid correlation token - no attempt found","requestId":"bill_da910d49-e48e-4d21-a668-b9fbfb625267_min1_1758559738643","correlation_token":"transcript-1758559738419-yr2zx555t","conversation_id":"da910d49-e48e-4d21-a668-b9fbfb625267"}
{"timestamp":"2025-09-22T16:49:29.733004","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_852a170f-7406-4b0a-b5ff-277aeec570f1_min1_1758559769736","correlation_token":"transcript-1758559769514-dpp2v1n78","conversation_id":"852a170f-7406-4b0a-b5ff-277aeec570f1","minute":1,"metrics_total_requests":30}
{"timestamp":"2025-09-22T16:49:29.736Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_852a170f-7406-4b0a-b5ff-277aeec570f1_min1_1758559769736","correlation_token":"transcript-1758559769514-dpp2v1n78"}
{"timestamp":"2025-09-22T16:49:29.754Z","level":"ERROR","service":"BillingService","message":"Invalid correlation token - no attempt found","requestId":"bill_852a170f-7406-4b0a-b5ff-277aeec570f1_min1_1758559769736","correlation_token":"transcript-1758559769514-dpp2v1n78","conversation_id":"852a170f-7406-4b0a-b5ff-277aeec570f1"}
{"timestamp":"2025-09-22T16:50:29.596483","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_d1eba75b-0e2f-4707-a736-1a51949e5453_min1_1758559829598","correlation_token":"transcript-1758559829374-81dqizyzq","conversation_id":"d1eba75b-0e2f-4707-a736-1a51949e5453","minute":1,"metrics_total_requests":31}
{"timestamp":"2025-09-22T16:50:29.598Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_d1eba75b-0e2f-4707-a736-1a51949e5453_min1_1758559829598","correlation_token":"transcript-1758559829374-81dqizyzq"}
{"timestamp":"2025-09-22T16:50:29.604Z","level":"ERROR","service":"BillingService","message":"Invalid correlation token - no attempt found","requestId":"bill_d1eba75b-0e2f-4707-a736-1a51949e5453_min1_1758559829598","correlation_token":"transcript-1758559829374-81dqizyzq","conversation_id":"d1eba75b-0e2f-4707-a736-1a51949e5453"}
{"timestamp":"2025-09-22T16:51:38.399501","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_bba3c0c8-877f-43c1-aaf0-dcf4312d373b_min1_1758559898402","correlation_token":"transcript-1758559898161-qyf693bdo","conversation_id":"bba3c0c8-877f-43c1-aaf0-dcf4312d373b","minute":1,"metrics_total_requests":32}
{"timestamp":"2025-09-22T16:51:38.402Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_bba3c0c8-877f-43c1-aaf0-dcf4312d373b_min1_1758559898402","correlation_token":"transcript-1758559898161-qyf693bdo"}
{"timestamp":"2025-09-22T16:51:38.406Z","level":"ERROR","service":"BillingService","message":"Invalid correlation token - no attempt found","requestId":"bill_bba3c0c8-877f-43c1-aaf0-dcf4312d373b_min1_1758559898402","correlation_token":"transcript-1758559898161-qyf693bdo","conversation_id":"bba3c0c8-877f-43c1-aaf0-dcf4312d373b"}
{"timestamp":"2025-09-22T16:54:30.129824","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_505b72c2-ef95-439d-be35-0f516c39e03a_min1_1758560070133","correlation_token":"sim_b1b7cd503bede4b4cf8a0eb67d745245_1758560024216","conversation_id":"505b72c2-ef95-439d-be35-0f516c39e03a","minute":1,"metrics_total_requests":33}
{"timestamp":"2025-09-22T16:54:30.133Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_505b72c2-ef95-439d-be35-0f516c39e03a_min1_1758560070133","correlation_token":"sim_b1b7cd503bede4b4cf8a0eb67d745245_1758560024216"}
{"timestamp":"2025-09-22T16:54:30.146Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_505b72c2-ef95-439d-be35-0f516c39e03a_min1_1758560070133","minute_requested":1,"minutes_already_billed":0,"attempt_id":"fd8ee700-37f9-48fb-95d0-9be5b340d8d2"}
{"timestamp":"2025-09-22T16:54:30.146Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_505b72c2-ef95-439d-be35-0f516c39e03a_min1_1758560070133","attempt_id":"fd8ee700-37f9-48fb-95d0-9be5b340d8d2","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":7,"minutes_already_billed":0,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-22T16:54:30.146Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_505b72c2-ef95-439d-be35-0f516c39e03a_min1_1758560070133","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":7,"expected_balance_after":6,"minute_to_bill":1}
{"timestamp":"2025-09-22T16:54:30.156Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_505b72c2-ef95-439d-be35-0f516c39e03a_min1_1758560070133","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-22T16:54:30.159Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_505b72c2-ef95-439d-be35-0f516c39e03a_min1_1758560070133","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":7,"new_balance":6,"change":-1}
{"timestamp":"2025-09-22T16:54:30.159Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_505b72c2-ef95-439d-be35-0f516c39e03a_min1_1758560070133","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":6,"minute":1}
{"timestamp":"2025-09-22T16:54:30.161Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_505b72c2-ef95-439d-be35-0f516c39e03a_min1_1758560070133","transaction_id":"6d28f09c-1cbc-4874-a1b5-879aaba33bc2","transaction_type":"DEBIT","balance_after":6}
{"timestamp":"2025-09-22T16:54:30.161Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_505b72c2-ef95-439d-be35-0f516c39e03a_min1_1758560070133","attempt_id":"fd8ee700-37f9-48fb-95d0-9be5b340d8d2","new_minutes_billed":1,"new_duration_seconds":60}
{"timestamp":"2025-09-22T16:54:30.163Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_505b72c2-ef95-439d-be35-0f516c39e03a_min1_1758560070133","attempt_id":"fd8ee700-37f9-48fb-95d0-9be5b340d8d2","minutes_billed":1}
{"timestamp":"2025-09-22T16:54:30.165Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_505b72c2-ef95-439d-be35-0f516c39e03a_min1_1758560070133","transaction_duration_ms":19,"new_balance":6,"minute_billed":1,"total_minutes_billed_this_attempt":1,"total_successful":6,"total_minutes_billed_all_time":6,"avg_transaction_time":"15.83"}
{"timestamp":"2025-09-22T16:54:30.165Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_505b72c2-ef95-439d-be35-0f516c39e03a_min1_1758560070133","total_duration_ms":32,"transaction_duration_ms":19,"response":{"status":"continue","creditsRemaining":6,"minuteBilled":1,"totalMinutesBilled":1,"attemptId":"fd8ee700-37f9-48fb-95d0-9be5b340d8d2","shouldTerminate":false}}
{"timestamp":"2025-09-22T18:25:34.181286","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_a979cd73-0147-493a-86fe-bb7df57d8307_min1_1758565534188","correlation_token":"sim_592e45032c058401c032476e1f3d3156_1758565517082","conversation_id":"a979cd73-0147-493a-86fe-bb7df57d8307","minute":1,"metrics_total_requests":34}
{"timestamp":"2025-09-22T18:25:34.189Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_a979cd73-0147-493a-86fe-bb7df57d8307_min1_1758565534188","correlation_token":"sim_592e45032c058401c032476e1f3d3156_1758565517082"}
{"timestamp":"2025-09-22T18:25:34.213Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_a979cd73-0147-493a-86fe-bb7df57d8307_min1_1758565534188","minute_requested":1,"minutes_already_billed":0,"attempt_id":"fa0d3ee8-34f2-433b-903c-c3b62b8d6639"}
{"timestamp":"2025-09-22T18:25:34.213Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_a979cd73-0147-493a-86fe-bb7df57d8307_min1_1758565534188","attempt_id":"fa0d3ee8-34f2-433b-903c-c3b62b8d6639","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":6,"minutes_already_billed":0,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-22T18:25:34.213Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_a979cd73-0147-493a-86fe-bb7df57d8307_min1_1758565534188","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":6,"expected_balance_after":5,"minute_to_bill":1}
{"timestamp":"2025-09-22T18:25:34.217Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_a979cd73-0147-493a-86fe-bb7df57d8307_min1_1758565534188","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-22T18:25:34.221Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_a979cd73-0147-493a-86fe-bb7df57d8307_min1_1758565534188","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":6,"new_balance":5,"change":-1}
{"timestamp":"2025-09-22T18:25:34.221Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_a979cd73-0147-493a-86fe-bb7df57d8307_min1_1758565534188","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":5,"minute":1}
{"timestamp":"2025-09-22T18:25:34.225Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_a979cd73-0147-493a-86fe-bb7df57d8307_min1_1758565534188","transaction_id":"62bc8c3c-b1f0-4e99-9663-e6f6e08b739e","transaction_type":"DEBIT","balance_after":5}
{"timestamp":"2025-09-22T18:25:34.225Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_a979cd73-0147-493a-86fe-bb7df57d8307_min1_1758565534188","attempt_id":"fa0d3ee8-34f2-433b-903c-c3b62b8d6639","new_minutes_billed":1,"new_duration_seconds":60}
{"timestamp":"2025-09-22T18:25:34.227Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_a979cd73-0147-493a-86fe-bb7df57d8307_min1_1758565534188","attempt_id":"fa0d3ee8-34f2-433b-903c-c3b62b8d6639","minutes_billed":1}
{"timestamp":"2025-09-22T18:25:34.229Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_a979cd73-0147-493a-86fe-bb7df57d8307_min1_1758565534188","transaction_duration_ms":16,"new_balance":5,"minute_billed":1,"total_minutes_billed_this_attempt":1,"total_successful":7,"total_minutes_billed_all_time":7,"avg_transaction_time":"15.86"}
{"timestamp":"2025-09-22T18:25:34.229Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_a979cd73-0147-493a-86fe-bb7df57d8307_min1_1758565534188","total_duration_ms":41,"transaction_duration_ms":16,"response":{"status":"continue","creditsRemaining":5,"minuteBilled":1,"totalMinutesBilled":1,"attemptId":"fa0d3ee8-34f2-433b-903c-c3b62b8d6639","shouldTerminate":false}}
{"timestamp":"2025-09-22T18:32:52.157923","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_4a7c8a54-bba8-4335-ae44-2f9345f06892_min1_1758565972159","correlation_token":"sim_1fc6d0ab22f5a50673b931ebd4d64610_1758565955659","conversation_id":"4a7c8a54-bba8-4335-ae44-2f9345f06892","minute":1,"metrics_total_requests":35}
{"timestamp":"2025-09-22T18:32:52.159Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_4a7c8a54-bba8-4335-ae44-2f9345f06892_min1_1758565972159","correlation_token":"sim_1fc6d0ab22f5a50673b931ebd4d64610_1758565955659"}
{"timestamp":"2025-09-22T18:32:52.170Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_4a7c8a54-bba8-4335-ae44-2f9345f06892_min1_1758565972159","minute_requested":1,"minutes_already_billed":0,"attempt_id":"87b1558a-cdeb-475b-a13c-7d5643b233fd"}
{"timestamp":"2025-09-22T18:32:52.170Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_4a7c8a54-bba8-4335-ae44-2f9345f06892_min1_1758565972159","attempt_id":"87b1558a-cdeb-475b-a13c-7d5643b233fd","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":5,"minutes_already_billed":0,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-22T18:32:52.170Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_4a7c8a54-bba8-4335-ae44-2f9345f06892_min1_1758565972159","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":5,"expected_balance_after":4,"minute_to_bill":1}
{"timestamp":"2025-09-22T18:32:52.173Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_4a7c8a54-bba8-4335-ae44-2f9345f06892_min1_1758565972159","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-22T18:32:52.176Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_4a7c8a54-bba8-4335-ae44-2f9345f06892_min1_1758565972159","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":5,"new_balance":4,"change":-1}
{"timestamp":"2025-09-22T18:32:52.176Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_4a7c8a54-bba8-4335-ae44-2f9345f06892_min1_1758565972159","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":4,"minute":1}
{"timestamp":"2025-09-22T18:32:52.178Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_4a7c8a54-bba8-4335-ae44-2f9345f06892_min1_1758565972159","transaction_id":"e9fc4e73-4183-42ee-b0ba-a2d856da66c5","transaction_type":"DEBIT","balance_after":4}
{"timestamp":"2025-09-22T18:32:52.178Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_4a7c8a54-bba8-4335-ae44-2f9345f06892_min1_1758565972159","attempt_id":"87b1558a-cdeb-475b-a13c-7d5643b233fd","new_minutes_billed":1,"new_duration_seconds":60}
{"timestamp":"2025-09-22T18:32:52.180Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_4a7c8a54-bba8-4335-ae44-2f9345f06892_min1_1758565972159","attempt_id":"87b1558a-cdeb-475b-a13c-7d5643b233fd","minutes_billed":1}
{"timestamp":"2025-09-22T18:32:52.181Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_4a7c8a54-bba8-4335-ae44-2f9345f06892_min1_1758565972159","transaction_duration_ms":11,"new_balance":4,"minute_billed":1,"total_minutes_billed_this_attempt":1,"total_successful":8,"total_minutes_billed_all_time":8,"avg_transaction_time":"15.25"}
{"timestamp":"2025-09-22T18:32:52.181Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_4a7c8a54-bba8-4335-ae44-2f9345f06892_min1_1758565972159","total_duration_ms":22,"transaction_duration_ms":11,"response":{"status":"continue","creditsRemaining":4,"minuteBilled":1,"totalMinutesBilled":1,"attemptId":"87b1558a-cdeb-475b-a13c-7d5643b233fd","shouldTerminate":false}}
{"timestamp":"2025-09-22T18:33:06.734904","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_f1b3b025-1c0c-4596-ab33-0ff3acf390f0_min1_1758565986736","correlation_token":"sim_1fc6d0ab22f5a50673b931ebd4d64610_1758565955659","conversation_id":"f1b3b025-1c0c-4596-ab33-0ff3acf390f0","minute":1,"metrics_total_requests":36}
{"timestamp":"2025-09-22T18:33:06.736Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_f1b3b025-1c0c-4596-ab33-0ff3acf390f0_min1_1758565986736","correlation_token":"sim_1fc6d0ab22f5a50673b931ebd4d64610_1758565955659"}
{"timestamp":"2025-09-22T18:33:06.744Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_f1b3b025-1c0c-4596-ab33-0ff3acf390f0_min1_1758565986736","minute_requested":1,"minutes_already_billed":1,"attempt_id":"87b1558a-cdeb-475b-a13c-7d5643b233fd"}
{"timestamp":"2025-09-22T18:33:06.744Z","level":"WARN","service":"BillingService","message":"Minute already billed - returning idempotent response","requestId":"bill_f1b3b025-1c0c-4596-ab33-0ff3acf390f0_min1_1758565986736","minute_requested":1,"minutes_already_billed":1,"attempt_id":"87b1558a-cdeb-475b-a13c-7d5643b233fd","total_duplicates":10}
{"timestamp":"2025-09-22T18:33:06.744Z","level":"INFO","service":"BillingService","message":"Returning idempotent response","requestId":"bill_f1b3b025-1c0c-4596-ab33-0ff3acf390f0_min1_1758565986736","response":{"status":"continue","creditsRemaining":4,"minuteBilled":1,"totalMinutesBilled":1,"attemptId":"87b1558a-cdeb-475b-a13c-7d5643b233fd","shouldTerminate":false,"message":"Already billed (idempotent response)"},"duration_ms":8}
{"timestamp":"2025-09-22T20:30:00.425186","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_58593b48-ecdc-4ba7-96d2-bae6f12a9f4e_min1_1758573000428","correlation_token":"sim_7fd8ebe961ece5f1678be546eab00ac7_1758572985979","conversation_id":"58593b48-ecdc-4ba7-96d2-bae6f12a9f4e","minute":1,"metrics_total_requests":37}
{"timestamp":"2025-09-22T20:30:00.428Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_58593b48-ecdc-4ba7-96d2-bae6f12a9f4e_min1_1758573000428","correlation_token":"sim_7fd8ebe961ece5f1678be546eab00ac7_1758572985979"}
{"timestamp":"2025-09-22T20:30:00.439Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_58593b48-ecdc-4ba7-96d2-bae6f12a9f4e_min1_1758573000428","minute_requested":1,"minutes_already_billed":0,"attempt_id":"a32bdd77-0cdf-477e-8aa2-ba8e3f18fb70"}
{"timestamp":"2025-09-22T20:30:00.439Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_58593b48-ecdc-4ba7-96d2-bae6f12a9f4e_min1_1758573000428","attempt_id":"a32bdd77-0cdf-477e-8aa2-ba8e3f18fb70","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":4,"minutes_already_billed":0,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-22T20:30:00.439Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_58593b48-ecdc-4ba7-96d2-bae6f12a9f4e_min1_1758573000428","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":4,"expected_balance_after":3,"minute_to_bill":1}
{"timestamp":"2025-09-22T20:30:00.445Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_58593b48-ecdc-4ba7-96d2-bae6f12a9f4e_min1_1758573000428","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-22T20:30:00.448Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_58593b48-ecdc-4ba7-96d2-bae6f12a9f4e_min1_1758573000428","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":4,"new_balance":3,"change":-1}
{"timestamp":"2025-09-22T20:30:00.448Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_58593b48-ecdc-4ba7-96d2-bae6f12a9f4e_min1_1758573000428","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":3,"minute":1}
{"timestamp":"2025-09-22T20:30:00.452Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_58593b48-ecdc-4ba7-96d2-bae6f12a9f4e_min1_1758573000428","transaction_id":"c0b27f2c-d078-490d-8a40-ab7af0f9942c","transaction_type":"DEBIT","balance_after":3}
{"timestamp":"2025-09-22T20:30:00.452Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_58593b48-ecdc-4ba7-96d2-bae6f12a9f4e_min1_1758573000428","attempt_id":"a32bdd77-0cdf-477e-8aa2-ba8e3f18fb70","new_minutes_billed":1,"new_duration_seconds":60}
{"timestamp":"2025-09-22T20:30:00.454Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_58593b48-ecdc-4ba7-96d2-bae6f12a9f4e_min1_1758573000428","attempt_id":"a32bdd77-0cdf-477e-8aa2-ba8e3f18fb70","minutes_billed":1}
{"timestamp":"2025-09-22T20:30:00.456Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_58593b48-ecdc-4ba7-96d2-bae6f12a9f4e_min1_1758573000428","transaction_duration_ms":17,"new_balance":3,"minute_billed":1,"total_minutes_billed_this_attempt":1,"total_successful":9,"total_minutes_billed_all_time":9,"avg_transaction_time":"15.44"}
{"timestamp":"2025-09-22T20:30:00.456Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_58593b48-ecdc-4ba7-96d2-bae6f12a9f4e_min1_1758573000428","total_duration_ms":28,"transaction_duration_ms":17,"response":{"status":"continue","creditsRemaining":3,"minuteBilled":1,"totalMinutesBilled":1,"attemptId":"a32bdd77-0cdf-477e-8aa2-ba8e3f18fb70","shouldTerminate":false}}
{"timestamp":"2025-09-22T20:30:14.097187","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_ebbd348c-c264-4477-8ad0-fe621e376f06_min1_1758573014098","correlation_token":"sim_7fd8ebe961ece5f1678be546eab00ac7_1758572985979","conversation_id":"ebbd348c-c264-4477-8ad0-fe621e376f06","minute":1,"metrics_total_requests":38}
{"timestamp":"2025-09-22T20:30:14.098Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_ebbd348c-c264-4477-8ad0-fe621e376f06_min1_1758573014098","correlation_token":"sim_7fd8ebe961ece5f1678be546eab00ac7_1758572985979"}
{"timestamp":"2025-09-22T20:30:14.105Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_ebbd348c-c264-4477-8ad0-fe621e376f06_min1_1758573014098","minute_requested":1,"minutes_already_billed":1,"attempt_id":"a32bdd77-0cdf-477e-8aa2-ba8e3f18fb70"}
{"timestamp":"2025-09-22T20:30:14.105Z","level":"WARN","service":"BillingService","message":"Minute already billed - returning idempotent response","requestId":"bill_ebbd348c-c264-4477-8ad0-fe621e376f06_min1_1758573014098","minute_requested":1,"minutes_already_billed":1,"attempt_id":"a32bdd77-0cdf-477e-8aa2-ba8e3f18fb70","total_duplicates":11}
{"timestamp":"2025-09-22T20:30:14.105Z","level":"INFO","service":"BillingService","message":"Returning idempotent response","requestId":"bill_ebbd348c-c264-4477-8ad0-fe621e376f06_min1_1758573014098","response":{"status":"continue","creditsRemaining":3,"minuteBilled":1,"totalMinutesBilled":1,"attemptId":"a32bdd77-0cdf-477e-8aa2-ba8e3f18fb70","shouldTerminate":false,"message":"Already billed (idempotent response)"},"duration_ms":7}
{"timestamp":"2025-09-22T20:31:00.459906","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_58593b48-ecdc-4ba7-96d2-bae6f12a9f4e_min2_1758573060461","correlation_token":"sim_7fd8ebe961ece5f1678be546eab00ac7_1758572985979","conversation_id":"58593b48-ecdc-4ba7-96d2-bae6f12a9f4e","minute":2,"metrics_total_requests":39}
{"timestamp":"2025-09-22T20:31:00.461Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_58593b48-ecdc-4ba7-96d2-bae6f12a9f4e_min2_1758573060461","correlation_token":"sim_7fd8ebe961ece5f1678be546eab00ac7_1758572985979"}
{"timestamp":"2025-09-22T20:31:00.469Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_58593b48-ecdc-4ba7-96d2-bae6f12a9f4e_min2_1758573060461","minute_requested":2,"minutes_already_billed":1,"attempt_id":"a32bdd77-0cdf-477e-8aa2-ba8e3f18fb70"}
{"timestamp":"2025-09-22T20:31:00.470Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_58593b48-ecdc-4ba7-96d2-bae6f12a9f4e_min2_1758573060461","attempt_id":"a32bdd77-0cdf-477e-8aa2-ba8e3f18fb70","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":3,"minutes_already_billed":1,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-22T20:31:00.470Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_58593b48-ecdc-4ba7-96d2-bae6f12a9f4e_min2_1758573060461","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":3,"expected_balance_after":2,"minute_to_bill":2}
{"timestamp":"2025-09-22T20:31:00.473Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_58593b48-ecdc-4ba7-96d2-bae6f12a9f4e_min2_1758573060461","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-22T20:31:00.475Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_58593b48-ecdc-4ba7-96d2-bae6f12a9f4e_min2_1758573060461","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":3,"new_balance":2,"change":-1}
{"timestamp":"2025-09-22T20:31:00.476Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_58593b48-ecdc-4ba7-96d2-bae6f12a9f4e_min2_1758573060461","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":2,"minute":2}
{"timestamp":"2025-09-22T20:31:00.477Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_58593b48-ecdc-4ba7-96d2-bae6f12a9f4e_min2_1758573060461","transaction_id":"102e879b-8a88-455e-ad8d-2802e378e348","transaction_type":"DEBIT","balance_after":2}
{"timestamp":"2025-09-22T20:31:00.478Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_58593b48-ecdc-4ba7-96d2-bae6f12a9f4e_min2_1758573060461","attempt_id":"a32bdd77-0cdf-477e-8aa2-ba8e3f18fb70","new_minutes_billed":2,"new_duration_seconds":120}
{"timestamp":"2025-09-22T20:31:00.480Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_58593b48-ecdc-4ba7-96d2-bae6f12a9f4e_min2_1758573060461","attempt_id":"a32bdd77-0cdf-477e-8aa2-ba8e3f18fb70","minutes_billed":2}
{"timestamp":"2025-09-22T20:31:00.482Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_58593b48-ecdc-4ba7-96d2-bae6f12a9f4e_min2_1758573060461","transaction_duration_ms":12,"new_balance":2,"minute_billed":2,"total_minutes_billed_this_attempt":2,"total_successful":10,"total_minutes_billed_all_time":10,"avg_transaction_time":"15.10"}
{"timestamp":"2025-09-22T20:31:00.482Z","level":"WARN","service":"BillingService","message":"Low credits warning threshold reached","requestId":"bill_58593b48-ecdc-4ba7-96d2-bae6f12a9f4e_min2_1758573060461","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","credits_remaining":2,"minute_billed":2,"warning_threshold":2}
{"timestamp":"2025-09-22T20:31:00.482Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_58593b48-ecdc-4ba7-96d2-bae6f12a9f4e_min2_1758573060461","total_duration_ms":21,"transaction_duration_ms":12,"response":{"status":"warning","creditsRemaining":2,"minuteBilled":2,"totalMinutesBilled":2,"attemptId":"a32bdd77-0cdf-477e-8aa2-ba8e3f18fb70","shouldTerminate":false,"message":"Low credits warning: 2 minute(s) remaining"}}
{"timestamp":"2025-09-22T20:31:14.108924","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_ebbd348c-c264-4477-8ad0-fe621e376f06_min2_1758573074112","correlation_token":"sim_7fd8ebe961ece5f1678be546eab00ac7_1758572985979","conversation_id":"ebbd348c-c264-4477-8ad0-fe621e376f06","minute":2,"metrics_total_requests":40}
{"timestamp":"2025-09-22T20:31:14.112Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_ebbd348c-c264-4477-8ad0-fe621e376f06_min2_1758573074112","correlation_token":"sim_7fd8ebe961ece5f1678be546eab00ac7_1758572985979"}
{"timestamp":"2025-09-22T20:31:14.121Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_ebbd348c-c264-4477-8ad0-fe621e376f06_min2_1758573074112","minute_requested":2,"minutes_already_billed":2,"attempt_id":"a32bdd77-0cdf-477e-8aa2-ba8e3f18fb70"}
{"timestamp":"2025-09-22T20:31:14.121Z","level":"WARN","service":"BillingService","message":"Minute already billed - returning idempotent response","requestId":"bill_ebbd348c-c264-4477-8ad0-fe621e376f06_min2_1758573074112","minute_requested":2,"minutes_already_billed":2,"attempt_id":"a32bdd77-0cdf-477e-8aa2-ba8e3f18fb70","total_duplicates":12}
{"timestamp":"2025-09-22T20:31:14.121Z","level":"INFO","service":"BillingService","message":"Returning idempotent response","requestId":"bill_ebbd348c-c264-4477-8ad0-fe621e376f06_min2_1758573074112","response":{"status":"continue","creditsRemaining":2,"minuteBilled":2,"totalMinutesBilled":2,"attemptId":"a32bdd77-0cdf-477e-8aa2-ba8e3f18fb70","shouldTerminate":false,"message":"Already billed (idempotent response)"},"duration_ms":9}
{"timestamp":"2025-09-22T20:32:25.008394","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_c6b4040f-4d1f-4764-8f50-9de8313aa494_min1_1758573145012","correlation_token":"sim_7fd8ebe961ece5f1678be546eab00ac7_1758572985979","conversation_id":"c6b4040f-4d1f-4764-8f50-9de8313aa494","minute":1,"metrics_total_requests":41}
{"timestamp":"2025-09-22T20:32:25.012Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_c6b4040f-4d1f-4764-8f50-9de8313aa494_min1_1758573145012","correlation_token":"sim_7fd8ebe961ece5f1678be546eab00ac7_1758572985979"}
{"timestamp":"2025-09-22T20:32:25.044Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_c6b4040f-4d1f-4764-8f50-9de8313aa494_min1_1758573145012","minute_requested":1,"minutes_already_billed":2,"attempt_id":"a32bdd77-0cdf-477e-8aa2-ba8e3f18fb70"}
{"timestamp":"2025-09-22T20:32:25.044Z","level":"WARN","service":"BillingService","message":"Minute already billed - returning idempotent response","requestId":"bill_c6b4040f-4d1f-4764-8f50-9de8313aa494_min1_1758573145012","minute_requested":1,"minutes_already_billed":2,"attempt_id":"a32bdd77-0cdf-477e-8aa2-ba8e3f18fb70","total_duplicates":13}
{"timestamp":"2025-09-22T20:32:25.044Z","level":"INFO","service":"BillingService","message":"Returning idempotent response","requestId":"bill_c6b4040f-4d1f-4764-8f50-9de8313aa494_min1_1758573145012","response":{"status":"continue","creditsRemaining":2,"minuteBilled":1,"totalMinutesBilled":2,"attemptId":"a32bdd77-0cdf-477e-8aa2-ba8e3f18fb70","shouldTerminate":false,"message":"Already billed (idempotent response)"},"duration_ms":32}
{"timestamp":"2025-09-22T20:33:24.912899","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_c8e5b3d4-2396-4e52-859e-d968c96bb4e5_min1_1758573204914","correlation_token":"sim_7fd8ebe961ece5f1678be546eab00ac7_1758572985979","conversation_id":"c8e5b3d4-2396-4e52-859e-d968c96bb4e5","minute":1,"metrics_total_requests":42}
{"timestamp":"2025-09-22T20:33:24.914Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_c8e5b3d4-2396-4e52-859e-d968c96bb4e5_min1_1758573204914","correlation_token":"sim_7fd8ebe961ece5f1678be546eab00ac7_1758572985979"}
{"timestamp":"2025-09-22T20:33:24.922Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_c8e5b3d4-2396-4e52-859e-d968c96bb4e5_min1_1758573204914","minute_requested":1,"minutes_already_billed":2,"attempt_id":"a32bdd77-0cdf-477e-8aa2-ba8e3f18fb70"}
{"timestamp":"2025-09-22T20:33:24.923Z","level":"WARN","service":"BillingService","message":"Minute already billed - returning idempotent response","requestId":"bill_c8e5b3d4-2396-4e52-859e-d968c96bb4e5_min1_1758573204914","minute_requested":1,"minutes_already_billed":2,"attempt_id":"a32bdd77-0cdf-477e-8aa2-ba8e3f18fb70","total_duplicates":14}
{"timestamp":"2025-09-22T20:33:24.923Z","level":"INFO","service":"BillingService","message":"Returning idempotent response","requestId":"bill_c8e5b3d4-2396-4e52-859e-d968c96bb4e5_min1_1758573204914","response":{"status":"continue","creditsRemaining":2,"minuteBilled":1,"totalMinutesBilled":2,"attemptId":"a32bdd77-0cdf-477e-8aa2-ba8e3f18fb70","shouldTerminate":false,"message":"Already billed (idempotent response)"},"duration_ms":9}
{"timestamp":"2025-09-22T20:33:34.513081","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_a09497eb-5bcb-4cc3-8b57-212962ad9f26_min1_1758573214514","correlation_token":"sim_7fd8ebe961ece5f1678be546eab00ac7_1758572985979","conversation_id":"a09497eb-5bcb-4cc3-8b57-212962ad9f26","minute":1,"metrics_total_requests":43}
{"timestamp":"2025-09-22T20:33:34.514Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_a09497eb-5bcb-4cc3-8b57-212962ad9f26_min1_1758573214514","correlation_token":"sim_7fd8ebe961ece5f1678be546eab00ac7_1758572985979"}
{"timestamp":"2025-09-22T20:33:34.529Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_a09497eb-5bcb-4cc3-8b57-212962ad9f26_min1_1758573214514","minute_requested":1,"minutes_already_billed":2,"attempt_id":"a32bdd77-0cdf-477e-8aa2-ba8e3f18fb70"}
{"timestamp":"2025-09-22T20:33:34.529Z","level":"WARN","service":"BillingService","message":"Minute already billed - returning idempotent response","requestId":"bill_a09497eb-5bcb-4cc3-8b57-212962ad9f26_min1_1758573214514","minute_requested":1,"minutes_already_billed":2,"attempt_id":"a32bdd77-0cdf-477e-8aa2-ba8e3f18fb70","total_duplicates":15}
{"timestamp":"2025-09-22T20:33:34.529Z","level":"INFO","service":"BillingService","message":"Returning idempotent response","requestId":"bill_a09497eb-5bcb-4cc3-8b57-212962ad9f26_min1_1758573214514","response":{"status":"continue","creditsRemaining":2,"minuteBilled":1,"totalMinutesBilled":2,"attemptId":"a32bdd77-0cdf-477e-8aa2-ba8e3f18fb70","shouldTerminate":false,"message":"Already billed (idempotent response)"},"duration_ms":15}
{"timestamp":"2025-09-22T20:34:24.926717","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_c8e5b3d4-2396-4e52-859e-d968c96bb4e5_min2_1758573264938","correlation_token":"sim_7fd8ebe961ece5f1678be546eab00ac7_1758572985979","conversation_id":"c8e5b3d4-2396-4e52-859e-d968c96bb4e5","minute":2,"metrics_total_requests":44}
{"timestamp":"2025-09-22T20:34:24.939Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_c8e5b3d4-2396-4e52-859e-d968c96bb4e5_min2_1758573264938","correlation_token":"sim_7fd8ebe961ece5f1678be546eab00ac7_1758572985979"}
{"timestamp":"2025-09-22T20:34:24.964Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_c8e5b3d4-2396-4e52-859e-d968c96bb4e5_min2_1758573264938","minute_requested":2,"minutes_already_billed":2,"attempt_id":"a32bdd77-0cdf-477e-8aa2-ba8e3f18fb70"}
{"timestamp":"2025-09-22T20:34:24.964Z","level":"WARN","service":"BillingService","message":"Minute already billed - returning idempotent response","requestId":"bill_c8e5b3d4-2396-4e52-859e-d968c96bb4e5_min2_1758573264938","minute_requested":2,"minutes_already_billed":2,"attempt_id":"a32bdd77-0cdf-477e-8aa2-ba8e3f18fb70","total_duplicates":16}
{"timestamp":"2025-09-22T20:34:24.964Z","level":"INFO","service":"BillingService","message":"Returning idempotent response","requestId":"bill_c8e5b3d4-2396-4e52-859e-d968c96bb4e5_min2_1758573264938","response":{"status":"continue","creditsRemaining":2,"minuteBilled":2,"totalMinutesBilled":2,"attemptId":"a32bdd77-0cdf-477e-8aa2-ba8e3f18fb70","shouldTerminate":false,"message":"Already billed (idempotent response)"},"duration_ms":26}
{"timestamp":"2025-09-22T20:34:34.533081","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_a09497eb-5bcb-4cc3-8b57-212962ad9f26_min2_1758573274537","correlation_token":"sim_7fd8ebe961ece5f1678be546eab00ac7_1758572985979","conversation_id":"a09497eb-5bcb-4cc3-8b57-212962ad9f26","minute":2,"metrics_total_requests":45}
{"timestamp":"2025-09-22T20:34:34.538Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_a09497eb-5bcb-4cc3-8b57-212962ad9f26_min2_1758573274537","correlation_token":"sim_7fd8ebe961ece5f1678be546eab00ac7_1758572985979"}
{"timestamp":"2025-09-22T20:34:34.555Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_a09497eb-5bcb-4cc3-8b57-212962ad9f26_min2_1758573274537","minute_requested":2,"minutes_already_billed":2,"attempt_id":"a32bdd77-0cdf-477e-8aa2-ba8e3f18fb70"}
{"timestamp":"2025-09-22T20:34:34.555Z","level":"WARN","service":"BillingService","message":"Minute already billed - returning idempotent response","requestId":"bill_a09497eb-5bcb-4cc3-8b57-212962ad9f26_min2_1758573274537","minute_requested":2,"minutes_already_billed":2,"attempt_id":"a32bdd77-0cdf-477e-8aa2-ba8e3f18fb70","total_duplicates":17}
{"timestamp":"2025-09-22T20:34:34.555Z","level":"INFO","service":"BillingService","message":"Returning idempotent response","requestId":"bill_a09497eb-5bcb-4cc3-8b57-212962ad9f26_min2_1758573274537","response":{"status":"continue","creditsRemaining":2,"minuteBilled":2,"totalMinutesBilled":2,"attemptId":"a32bdd77-0cdf-477e-8aa2-ba8e3f18fb70","shouldTerminate":false,"message":"Already billed (idempotent response)"},"duration_ms":18}
{"timestamp":"2025-09-22T21:12:35.425Z","level":"INFO","service":"BillingService","message":"BillingService initialized","environment":"development","database_url":"configured"}
{"timestamp":"2025-09-22T21:12:56.734Z","level":"INFO","service":"BillingService","message":"BillingService initialized","environment":"development","database_url":"configured"}
{"timestamp":"2025-09-22T21:13:43.633Z","level":"INFO","service":"BillingService","message":"BillingService initialized","environment":"development","database_url":"configured"}
{"timestamp":"2025-09-22T21:14:41.317Z","level":"INFO","service":"BillingService","message":"BillingService initialized","environment":"development","database_url":"configured"}
{"timestamp":"2025-09-22T21:22:12.144Z","level":"INFO","service":"BillingService","message":"BillingService initialized","environment":"development","database_url":"configured"}
{"timestamp":"2025-09-22T21:24:06.957Z","level":"INFO","service":"BillingService","message":"BillingService initialized","environment":"development","database_url":"configured"}
{"timestamp":"2025-09-22T21:25:35.257Z","level":"INFO","service":"BillingService","message":"BillingService initialized","environment":"development","database_url":"configured"}
{"timestamp":"2025-09-22T21:26:00.831Z","level":"INFO","service":"BillingService","message":"BillingService initialized","environment":"development","database_url":"configured"}
{"timestamp":"2025-09-22T21:26:06.394Z","level":"INFO","service":"BillingService","message":"BillingService initialized","environment":"development","database_url":"configured"}
{"timestamp":"2025-09-22T21:27:02.429Z","level":"INFO","service":"BillingService","message":"BillingService initialized","environment":"development","database_url":"configured"}
{"timestamp":"2025-09-22T21:27:22.498Z","level":"INFO","service":"BillingService","message":"BillingService initialized","environment":"development","database_url":"configured"}
{"timestamp":"2025-09-22T21:28:03.704Z","level":"INFO","service":"BillingService","message":"BillingService initialized","environment":"development","database_url":"configured"}
{"timestamp":"2025-09-22T21:30:58.459759","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_64d6ed8c-f653-4c34-aaf2-1d4eba326a8e_min1_1758576658465","correlation_token":"sim_656d7b1ef80252e437620edebc452135_1758576593079","conversation_id":"64d6ed8c-f653-4c34-aaf2-1d4eba326a8e","minute":1,"metrics_total_requests":1}
{"timestamp":"2025-09-22T21:30:58.465Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_64d6ed8c-f653-4c34-aaf2-1d4eba326a8e_min1_1758576658465","correlation_token":"sim_656d7b1ef80252e437620edebc452135_1758576593079"}
{"timestamp":"2025-09-22T21:30:58.481Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_64d6ed8c-f653-4c34-aaf2-1d4eba326a8e_min1_1758576658465","minute_requested":1,"minutes_already_billed":0,"attempt_id":"8fba106b-fe8a-4699-bc1e-a32006430d2c"}
{"timestamp":"2025-09-22T21:30:58.481Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_64d6ed8c-f653-4c34-aaf2-1d4eba326a8e_min1_1758576658465","attempt_id":"8fba106b-fe8a-4699-bc1e-a32006430d2c","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":2,"minutes_already_billed":0,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-22T21:30:58.481Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_64d6ed8c-f653-4c34-aaf2-1d4eba326a8e_min1_1758576658465","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":2,"expected_balance_after":1,"minute_to_bill":1}
{"timestamp":"2025-09-22T21:30:58.486Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_64d6ed8c-f653-4c34-aaf2-1d4eba326a8e_min1_1758576658465","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-22T21:30:58.489Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_64d6ed8c-f653-4c34-aaf2-1d4eba326a8e_min1_1758576658465","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":2,"new_balance":1,"change":-1}
{"timestamp":"2025-09-22T21:30:58.489Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_64d6ed8c-f653-4c34-aaf2-1d4eba326a8e_min1_1758576658465","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":1,"minute":1}
{"timestamp":"2025-09-22T21:30:58.494Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_64d6ed8c-f653-4c34-aaf2-1d4eba326a8e_min1_1758576658465","transaction_id":"bf993434-51e5-42aa-b363-d84abf92c3ff","transaction_type":"DEBIT","balance_after":1}
{"timestamp":"2025-09-22T21:30:58.494Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_64d6ed8c-f653-4c34-aaf2-1d4eba326a8e_min1_1758576658465","attempt_id":"8fba106b-fe8a-4699-bc1e-a32006430d2c","new_minutes_billed":1,"new_duration_seconds":60}
{"timestamp":"2025-09-22T21:30:58.499Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_64d6ed8c-f653-4c34-aaf2-1d4eba326a8e_min1_1758576658465","attempt_id":"8fba106b-fe8a-4699-bc1e-a32006430d2c","minutes_billed":1}
{"timestamp":"2025-09-22T21:30:58.503Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_64d6ed8c-f653-4c34-aaf2-1d4eba326a8e_min1_1758576658465","transaction_duration_ms":22,"new_balance":1,"minute_billed":1,"total_minutes_billed_this_attempt":1,"total_successful":1,"total_minutes_billed_all_time":1,"avg_transaction_time":"22.00"}
{"timestamp":"2025-09-22T21:30:58.503Z","level":"WARN","service":"BillingService","message":"Low credits warning threshold reached","requestId":"bill_64d6ed8c-f653-4c34-aaf2-1d4eba326a8e_min1_1758576658465","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","credits_remaining":1,"minute_billed":1,"warning_threshold":2}
{"timestamp":"2025-09-22T21:30:58.503Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_64d6ed8c-f653-4c34-aaf2-1d4eba326a8e_min1_1758576658465","total_duration_ms":38,"transaction_duration_ms":22,"response":{"status":"warning","creditsRemaining":1,"minuteBilled":1,"totalMinutesBilled":1,"attemptId":"8fba106b-fe8a-4699-bc1e-a32006430d2c","shouldTerminate":false,"message":"Low credits warning: 1 minute(s) remaining"}}
{"timestamp":"2025-09-22T21:31:58.509319","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_64d6ed8c-f653-4c34-aaf2-1d4eba326a8e_min2_1758576718514","correlation_token":"sim_656d7b1ef80252e437620edebc452135_1758576593079","conversation_id":"64d6ed8c-f653-4c34-aaf2-1d4eba326a8e","minute":2,"metrics_total_requests":2}
{"timestamp":"2025-09-22T21:31:58.515Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_64d6ed8c-f653-4c34-aaf2-1d4eba326a8e_min2_1758576718514","correlation_token":"sim_656d7b1ef80252e437620edebc452135_1758576593079"}
{"timestamp":"2025-09-22T21:31:58.531Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_64d6ed8c-f653-4c34-aaf2-1d4eba326a8e_min2_1758576718514","minute_requested":2,"minutes_already_billed":1,"attempt_id":"8fba106b-fe8a-4699-bc1e-a32006430d2c"}
{"timestamp":"2025-09-22T21:31:58.531Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_64d6ed8c-f653-4c34-aaf2-1d4eba326a8e_min2_1758576718514","attempt_id":"8fba106b-fe8a-4699-bc1e-a32006430d2c","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":1,"minutes_already_billed":1,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-22T21:31:58.531Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_64d6ed8c-f653-4c34-aaf2-1d4eba326a8e_min2_1758576718514","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":1,"expected_balance_after":0,"minute_to_bill":2}
{"timestamp":"2025-09-22T21:31:58.537Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_64d6ed8c-f653-4c34-aaf2-1d4eba326a8e_min2_1758576718514","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-22T21:31:58.542Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_64d6ed8c-f653-4c34-aaf2-1d4eba326a8e_min2_1758576718514","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":1,"new_balance":0,"change":-1}
{"timestamp":"2025-09-22T21:31:58.542Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_64d6ed8c-f653-4c34-aaf2-1d4eba326a8e_min2_1758576718514","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":0,"minute":2}
{"timestamp":"2025-09-22T21:31:58.545Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_64d6ed8c-f653-4c34-aaf2-1d4eba326a8e_min2_1758576718514","transaction_id":"5ae41747-1283-45d8-b570-49879b9ded30","transaction_type":"DEBIT","balance_after":0}
{"timestamp":"2025-09-22T21:31:58.545Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_64d6ed8c-f653-4c34-aaf2-1d4eba326a8e_min2_1758576718514","attempt_id":"8fba106b-fe8a-4699-bc1e-a32006430d2c","new_minutes_billed":2,"new_duration_seconds":120}
{"timestamp":"2025-09-22T21:31:58.547Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_64d6ed8c-f653-4c34-aaf2-1d4eba326a8e_min2_1758576718514","attempt_id":"8fba106b-fe8a-4699-bc1e-a32006430d2c","minutes_billed":2}
{"timestamp":"2025-09-22T21:31:58.549Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_64d6ed8c-f653-4c34-aaf2-1d4eba326a8e_min2_1758576718514","transaction_duration_ms":18,"new_balance":0,"minute_billed":2,"total_minutes_billed_this_attempt":2,"total_successful":2,"total_minutes_billed_all_time":2,"avg_transaction_time":"20.00"}
{"timestamp":"2025-09-22T21:31:58.549Z","level":"WARN","service":"BillingService","message":"Last credit used - will terminate conversation","requestId":"bill_64d6ed8c-f653-4c34-aaf2-1d4eba326a8e_min2_1758576718514","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","minute_billed":2,"total_minutes_this_session":2}
{"timestamp":"2025-09-22T21:31:58.549Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_64d6ed8c-f653-4c34-aaf2-1d4eba326a8e_min2_1758576718514","total_duration_ms":35,"transaction_duration_ms":18,"response":{"status":"terminate","creditsRemaining":0,"minuteBilled":2,"totalMinutesBilled":2,"attemptId":"8fba106b-fe8a-4699-bc1e-a32006430d2c","shouldTerminate":true,"message":"Last credit used - conversation will end","gracePeriodSeconds":60}}
{"timestamp":"2025-09-22T21:53:16.985Z","level":"INFO","service":"BillingService","message":"BillingService initialized","environment":"development","database_url":"configured"}
{"timestamp":"2025-09-22T21:54:38.639Z","level":"INFO","service":"BillingService","message":"BillingService initialized","environment":"development","database_url":"configured"}
{"timestamp":"2025-09-22T21:54:41.072Z","level":"INFO","service":"BillingService","message":"BillingService initialized","environment":"development","database_url":"configured"}
{"timestamp":"2025-09-22T21:56:06.732Z","level":"INFO","service":"BillingService","message":"BillingService initialized","environment":"development","database_url":"configured"}
{"timestamp":"2025-09-22T21:57:51.817Z","level":"INFO","service":"BillingService","message":"BillingService initialized","environment":"development","database_url":"configured"}
{"timestamp":"2025-09-22T21:57:56.677Z","level":"INFO","service":"BillingService","message":"BillingService initialized","environment":"development","database_url":"configured"}
{"timestamp":"2025-09-22T21:58:00.500Z","level":"INFO","service":"BillingService","message":"BillingService initialized","environment":"development","database_url":"configured"}
{"timestamp":"2025-09-22T21:59:00.061Z","level":"INFO","service":"BillingService","message":"BillingService initialized","environment":"development","database_url":"configured"}
{"timestamp":"2025-09-22T21:59:06.620Z","level":"INFO","service":"BillingService","message":"BillingService initialized","environment":"development","database_url":"configured"}
{"timestamp":"2025-09-22T21:59:33.357Z","level":"INFO","service":"BillingService","message":"BillingService initialized","environment":"development","database_url":"configured"}
{"timestamp":"2025-10-05T15:07:54.399Z","level":"INFO","service":"BillingService","message":"BillingService initialized","environment":"development","database_url":"configured"}
{"timestamp":"2025-10-05T19:03:03.637Z","level":"INFO","service":"BillingService","message":"BillingService initialized","environment":"development","database_url":"configured"}
{"timestamp":"2025-10-05T19:17:42.901Z","level":"INFO","service":"BillingService","message":"BillingService initialized","environment":"development","database_url":"configured"}
{"timestamp":"2025-10-05T21:46:46.143Z","level":"INFO","service":"BillingService","message":"BillingService initialized","environment":"development","database_url":"configured"}
{"timestamp":"2025-10-05T21:50:52.735Z","level":"INFO","service":"BillingService","message":"BillingService initialized","environment":"development","database_url":"configured"}
{"timestamp":"2025-10-08T14:01:37.730Z","level":"INFO","service":"BillingService","message":"BillingService initialized","environment":"development","database_url":"configured"}
{"timestamp":"2025-10-08T14:03:56.580797","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min1_1759932236584","correlation_token":"sim_dc097e8b8e1b12acb6055250d006914a_1759932236215","conversation_id":"dc206f5b-82a6-43c0-a8bb-de0a56a0025e","minute":1,"metrics_total_requests":1}
{"timestamp":"2025-10-08T14:03:56.584Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min1_1759932236584","correlation_token":"sim_dc097e8b8e1b12acb6055250d006914a_1759932236215"}
{"timestamp":"2025-10-08T14:03:56.591Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min1_1759932236584","minute_requested":1,"minutes_already_billed":0,"attempt_id":"f3e650f8-3538-483e-a048-4c0357c6b086"}
{"timestamp":"2025-10-08T14:03:56.591Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min1_1759932236584","attempt_id":"f3e650f8-3538-483e-a048-4c0357c6b086","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":38,"minutes_already_billed":0,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-10-08T14:03:56.591Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min1_1759932236584","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":38,"expected_balance_after":37,"minute_to_bill":1}
{"timestamp":"2025-10-08T14:03:56.594Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min1_1759932236584","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-10-08T14:03:56.599Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min1_1759932236584","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":38,"new_balance":37,"change":-1}
{"timestamp":"2025-10-08T14:03:56.599Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min1_1759932236584","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":37,"minute":1}
{"timestamp":"2025-10-08T14:03:56.603Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min1_1759932236584","transaction_id":"5f10540d-ea11-4c9d-b8e0-6e739ba4810c","transaction_type":"DEBIT","balance_after":37}
{"timestamp":"2025-10-08T14:03:56.603Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min1_1759932236584","attempt_id":"f3e650f8-3538-483e-a048-4c0357c6b086","new_minutes_billed":1,"new_duration_seconds":60}
{"timestamp":"2025-10-08T14:03:56.605Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min1_1759932236584","attempt_id":"f3e650f8-3538-483e-a048-4c0357c6b086","minutes_billed":1}
{"timestamp":"2025-10-08T14:03:56.607Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min1_1759932236584","transaction_duration_ms":16,"new_balance":37,"minute_billed":1,"total_minutes_billed_this_attempt":1,"total_successful":1,"total_minutes_billed_all_time":1,"avg_transaction_time":"16.00"}
{"timestamp":"2025-10-08T14:03:56.607Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min1_1759932236584","total_duration_ms":23,"transaction_duration_ms":16,"response":{"status":"continue","creditsRemaining":37,"minuteBilled":1,"totalMinutesBilled":1,"attemptId":"f3e650f8-3538-483e-a048-4c0357c6b086","shouldTerminate":false}}
{"timestamp":"2025-10-08T14:04:56.611870","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min2_1759932296617","correlation_token":"sim_dc097e8b8e1b12acb6055250d006914a_1759932236215","conversation_id":"dc206f5b-82a6-43c0-a8bb-de0a56a0025e","minute":2,"metrics_total_requests":2}
{"timestamp":"2025-10-08T14:04:56.617Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min2_1759932296617","correlation_token":"sim_dc097e8b8e1b12acb6055250d006914a_1759932236215"}
{"timestamp":"2025-10-08T14:04:56.634Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min2_1759932296617","minute_requested":2,"minutes_already_billed":1,"attempt_id":"f3e650f8-3538-483e-a048-4c0357c6b086"}
{"timestamp":"2025-10-08T14:04:56.634Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min2_1759932296617","attempt_id":"f3e650f8-3538-483e-a048-4c0357c6b086","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":37,"minutes_already_billed":1,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-10-08T14:04:56.635Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min2_1759932296617","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":37,"expected_balance_after":36,"minute_to_bill":2}
{"timestamp":"2025-10-08T14:04:56.639Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min2_1759932296617","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-10-08T14:04:56.644Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min2_1759932296617","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":37,"new_balance":36,"change":-1}
{"timestamp":"2025-10-08T14:04:56.644Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min2_1759932296617","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":36,"minute":2}
{"timestamp":"2025-10-08T14:04:56.648Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min2_1759932296617","transaction_id":"21498637-d7e4-432b-ab38-452852c5f191","transaction_type":"DEBIT","balance_after":36}
{"timestamp":"2025-10-08T14:04:56.648Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min2_1759932296617","attempt_id":"f3e650f8-3538-483e-a048-4c0357c6b086","new_minutes_billed":2,"new_duration_seconds":120}
{"timestamp":"2025-10-08T14:04:56.651Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min2_1759932296617","attempt_id":"f3e650f8-3538-483e-a048-4c0357c6b086","minutes_billed":2}
{"timestamp":"2025-10-08T14:04:56.654Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min2_1759932296617","transaction_duration_ms":19,"new_balance":36,"minute_billed":2,"total_minutes_billed_this_attempt":2,"total_successful":2,"total_minutes_billed_all_time":2,"avg_transaction_time":"17.50"}
{"timestamp":"2025-10-08T14:04:56.654Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min2_1759932296617","total_duration_ms":37,"transaction_duration_ms":19,"response":{"status":"continue","creditsRemaining":36,"minuteBilled":2,"totalMinutesBilled":2,"attemptId":"f3e650f8-3538-483e-a048-4c0357c6b086","shouldTerminate":false}}
{"timestamp":"2025-10-08T14:05:56.659691","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min3_1759932356669","correlation_token":"sim_dc097e8b8e1b12acb6055250d006914a_1759932236215","conversation_id":"dc206f5b-82a6-43c0-a8bb-de0a56a0025e","minute":3,"metrics_total_requests":3}
{"timestamp":"2025-10-08T14:05:56.669Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min3_1759932356669","correlation_token":"sim_dc097e8b8e1b12acb6055250d006914a_1759932236215"}
{"timestamp":"2025-10-08T14:05:56.692Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min3_1759932356669","minute_requested":3,"minutes_already_billed":2,"attempt_id":"f3e650f8-3538-483e-a048-4c0357c6b086"}
{"timestamp":"2025-10-08T14:05:56.693Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min3_1759932356669","attempt_id":"f3e650f8-3538-483e-a048-4c0357c6b086","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":36,"minutes_already_billed":2,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-10-08T14:05:56.693Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min3_1759932356669","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":36,"expected_balance_after":35,"minute_to_bill":3}
{"timestamp":"2025-10-08T14:05:56.698Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min3_1759932356669","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-10-08T14:05:56.704Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min3_1759932356669","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":36,"new_balance":35,"change":-1}
{"timestamp":"2025-10-08T14:05:56.704Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min3_1759932356669","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":35,"minute":3}
{"timestamp":"2025-10-08T14:05:56.708Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min3_1759932356669","transaction_id":"da90133e-b73e-4043-b1f0-92015d8ed8f1","transaction_type":"DEBIT","balance_after":35}
{"timestamp":"2025-10-08T14:05:56.708Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min3_1759932356669","attempt_id":"f3e650f8-3538-483e-a048-4c0357c6b086","new_minutes_billed":3,"new_duration_seconds":180}
{"timestamp":"2025-10-08T14:05:56.711Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min3_1759932356669","attempt_id":"f3e650f8-3538-483e-a048-4c0357c6b086","minutes_billed":3}
{"timestamp":"2025-10-08T14:05:56.713Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min3_1759932356669","transaction_duration_ms":20,"new_balance":35,"minute_billed":3,"total_minutes_billed_this_attempt":3,"total_successful":3,"total_minutes_billed_all_time":3,"avg_transaction_time":"18.33"}
{"timestamp":"2025-10-08T14:05:56.713Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min3_1759932356669","total_duration_ms":44,"transaction_duration_ms":20,"response":{"status":"continue","creditsRemaining":35,"minuteBilled":3,"totalMinutesBilled":3,"attemptId":"f3e650f8-3538-483e-a048-4c0357c6b086","shouldTerminate":false}}
{"timestamp":"2025-10-08T14:06:56.718842","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min4_1759932416727","correlation_token":"sim_dc097e8b8e1b12acb6055250d006914a_1759932236215","conversation_id":"dc206f5b-82a6-43c0-a8bb-de0a56a0025e","minute":4,"metrics_total_requests":4}
{"timestamp":"2025-10-08T14:06:56.727Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min4_1759932416727","correlation_token":"sim_dc097e8b8e1b12acb6055250d006914a_1759932236215"}
{"timestamp":"2025-10-08T14:06:56.752Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min4_1759932416727","minute_requested":4,"minutes_already_billed":3,"attempt_id":"f3e650f8-3538-483e-a048-4c0357c6b086"}
{"timestamp":"2025-10-08T14:06:56.752Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min4_1759932416727","attempt_id":"f3e650f8-3538-483e-a048-4c0357c6b086","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":35,"minutes_already_billed":3,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-10-08T14:06:56.752Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min4_1759932416727","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":35,"expected_balance_after":34,"minute_to_bill":4}
{"timestamp":"2025-10-08T14:06:56.758Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min4_1759932416727","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-10-08T14:06:56.762Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min4_1759932416727","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":35,"new_balance":34,"change":-1}
{"timestamp":"2025-10-08T14:06:56.762Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min4_1759932416727","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":34,"minute":4}
{"timestamp":"2025-10-08T14:06:56.766Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min4_1759932416727","transaction_id":"cfd71f1b-31f7-46aa-84b6-1217d7ebbdd6","transaction_type":"DEBIT","balance_after":34}
{"timestamp":"2025-10-08T14:06:56.766Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min4_1759932416727","attempt_id":"f3e650f8-3538-483e-a048-4c0357c6b086","new_minutes_billed":4,"new_duration_seconds":240}
{"timestamp":"2025-10-08T14:06:56.769Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min4_1759932416727","attempt_id":"f3e650f8-3538-483e-a048-4c0357c6b086","minutes_billed":4}
{"timestamp":"2025-10-08T14:06:56.770Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min4_1759932416727","transaction_duration_ms":18,"new_balance":34,"minute_billed":4,"total_minutes_billed_this_attempt":4,"total_successful":4,"total_minutes_billed_all_time":4,"avg_transaction_time":"18.25"}
{"timestamp":"2025-10-08T14:06:56.770Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min4_1759932416727","total_duration_ms":43,"transaction_duration_ms":18,"response":{"status":"continue","creditsRemaining":34,"minuteBilled":4,"totalMinutesBilled":4,"attemptId":"f3e650f8-3538-483e-a048-4c0357c6b086","shouldTerminate":false}}
{"timestamp":"2025-10-08T14:07:56.776476","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min5_1759932476783","correlation_token":"sim_dc097e8b8e1b12acb6055250d006914a_1759932236215","conversation_id":"dc206f5b-82a6-43c0-a8bb-de0a56a0025e","minute":5,"metrics_total_requests":5}
{"timestamp":"2025-10-08T14:07:56.783Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min5_1759932476783","correlation_token":"sim_dc097e8b8e1b12acb6055250d006914a_1759932236215"}
{"timestamp":"2025-10-08T14:07:56.807Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min5_1759932476783","minute_requested":5,"minutes_already_billed":4,"attempt_id":"f3e650f8-3538-483e-a048-4c0357c6b086"}
{"timestamp":"2025-10-08T14:07:56.807Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min5_1759932476783","attempt_id":"f3e650f8-3538-483e-a048-4c0357c6b086","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":34,"minutes_already_billed":4,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-10-08T14:07:56.807Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min5_1759932476783","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":34,"expected_balance_after":33,"minute_to_bill":5}
{"timestamp":"2025-10-08T14:07:56.812Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min5_1759932476783","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-10-08T14:07:56.816Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min5_1759932476783","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":34,"new_balance":33,"change":-1}
{"timestamp":"2025-10-08T14:07:56.816Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min5_1759932476783","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":33,"minute":5}
{"timestamp":"2025-10-08T14:07:56.820Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min5_1759932476783","transaction_id":"31789dfc-f30d-4e5f-9890-6f18f73cda61","transaction_type":"DEBIT","balance_after":33}
{"timestamp":"2025-10-08T14:07:56.820Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min5_1759932476783","attempt_id":"f3e650f8-3538-483e-a048-4c0357c6b086","new_minutes_billed":5,"new_duration_seconds":300}
{"timestamp":"2025-10-08T14:07:56.824Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min5_1759932476783","attempt_id":"f3e650f8-3538-483e-a048-4c0357c6b086","minutes_billed":5}
{"timestamp":"2025-10-08T14:07:56.826Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min5_1759932476783","transaction_duration_ms":19,"new_balance":33,"minute_billed":5,"total_minutes_billed_this_attempt":5,"total_successful":5,"total_minutes_billed_all_time":5,"avg_transaction_time":"18.40"}
{"timestamp":"2025-10-08T14:07:56.826Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min5_1759932476783","total_duration_ms":43,"transaction_duration_ms":19,"response":{"status":"continue","creditsRemaining":33,"minuteBilled":5,"totalMinutesBilled":5,"attemptId":"f3e650f8-3538-483e-a048-4c0357c6b086","shouldTerminate":false}}
{"timestamp":"2025-10-08T14:08:56.831183","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min6_1759932536837","correlation_token":"sim_dc097e8b8e1b12acb6055250d006914a_1759932236215","conversation_id":"dc206f5b-82a6-43c0-a8bb-de0a56a0025e","minute":6,"metrics_total_requests":6}
{"timestamp":"2025-10-08T14:08:56.837Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min6_1759932536837","correlation_token":"sim_dc097e8b8e1b12acb6055250d006914a_1759932236215"}
{"timestamp":"2025-10-08T14:08:56.863Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min6_1759932536837","minute_requested":6,"minutes_already_billed":5,"attempt_id":"f3e650f8-3538-483e-a048-4c0357c6b086"}
{"timestamp":"2025-10-08T14:08:56.863Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min6_1759932536837","attempt_id":"f3e650f8-3538-483e-a048-4c0357c6b086","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":33,"minutes_already_billed":5,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-10-08T14:08:56.863Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min6_1759932536837","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":33,"expected_balance_after":32,"minute_to_bill":6}
{"timestamp":"2025-10-08T14:08:56.868Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min6_1759932536837","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-10-08T14:08:56.873Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min6_1759932536837","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":33,"new_balance":32,"change":-1}
{"timestamp":"2025-10-08T14:08:56.873Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min6_1759932536837","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":32,"minute":6}
{"timestamp":"2025-10-08T14:08:56.876Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min6_1759932536837","transaction_id":"8dcb296b-99c6-49b9-ab02-079112123622","transaction_type":"DEBIT","balance_after":32}
{"timestamp":"2025-10-08T14:08:56.876Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min6_1759932536837","attempt_id":"f3e650f8-3538-483e-a048-4c0357c6b086","new_minutes_billed":6,"new_duration_seconds":360}
{"timestamp":"2025-10-08T14:08:56.879Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min6_1759932536837","attempt_id":"f3e650f8-3538-483e-a048-4c0357c6b086","minutes_billed":6}
{"timestamp":"2025-10-08T14:08:56.882Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min6_1759932536837","transaction_duration_ms":18,"new_balance":32,"minute_billed":6,"total_minutes_billed_this_attempt":6,"total_successful":6,"total_minutes_billed_all_time":6,"avg_transaction_time":"18.33"}
{"timestamp":"2025-10-08T14:08:56.882Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min6_1759932536837","total_duration_ms":45,"transaction_duration_ms":18,"response":{"status":"continue","creditsRemaining":32,"minuteBilled":6,"totalMinutesBilled":6,"attemptId":"f3e650f8-3538-483e-a048-4c0357c6b086","shouldTerminate":false}}
{"timestamp":"2025-10-08T14:09:56.886060","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min7_1759932596894","correlation_token":"sim_dc097e8b8e1b12acb6055250d006914a_1759932236215","conversation_id":"dc206f5b-82a6-43c0-a8bb-de0a56a0025e","minute":7,"metrics_total_requests":7}
{"timestamp":"2025-10-08T14:09:56.894Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min7_1759932596894","correlation_token":"sim_dc097e8b8e1b12acb6055250d006914a_1759932236215"}
{"timestamp":"2025-10-08T14:09:56.916Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min7_1759932596894","minute_requested":7,"minutes_already_billed":6,"attempt_id":"f3e650f8-3538-483e-a048-4c0357c6b086"}
{"timestamp":"2025-10-08T14:09:56.916Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min7_1759932596894","attempt_id":"f3e650f8-3538-483e-a048-4c0357c6b086","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":32,"minutes_already_billed":6,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-10-08T14:09:56.916Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min7_1759932596894","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":32,"expected_balance_after":31,"minute_to_bill":7}
{"timestamp":"2025-10-08T14:09:56.923Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min7_1759932596894","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-10-08T14:09:56.928Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min7_1759932596894","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":32,"new_balance":31,"change":-1}
{"timestamp":"2025-10-08T14:09:56.928Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min7_1759932596894","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":31,"minute":7}
{"timestamp":"2025-10-08T14:09:56.931Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min7_1759932596894","transaction_id":"03499f85-b0f3-4afe-ab8f-aeb545166fcc","transaction_type":"DEBIT","balance_after":31}
{"timestamp":"2025-10-08T14:09:56.931Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min7_1759932596894","attempt_id":"f3e650f8-3538-483e-a048-4c0357c6b086","new_minutes_billed":7,"new_duration_seconds":420}
{"timestamp":"2025-10-08T14:09:56.935Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min7_1759932596894","attempt_id":"f3e650f8-3538-483e-a048-4c0357c6b086","minutes_billed":7}
{"timestamp":"2025-10-08T14:09:56.937Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min7_1759932596894","transaction_duration_ms":21,"new_balance":31,"minute_billed":7,"total_minutes_billed_this_attempt":7,"total_successful":7,"total_minutes_billed_all_time":7,"avg_transaction_time":"18.71"}
{"timestamp":"2025-10-08T14:09:56.937Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min7_1759932596894","total_duration_ms":43,"transaction_duration_ms":21,"response":{"status":"continue","creditsRemaining":31,"minuteBilled":7,"totalMinutesBilled":7,"attemptId":"f3e650f8-3538-483e-a048-4c0357c6b086","shouldTerminate":false}}
{"timestamp":"2025-10-08T14:10:56.941519","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min8_1759932656949","correlation_token":"sim_dc097e8b8e1b12acb6055250d006914a_1759932236215","conversation_id":"dc206f5b-82a6-43c0-a8bb-de0a56a0025e","minute":8,"metrics_total_requests":8}
{"timestamp":"2025-10-08T14:10:56.949Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min8_1759932656949","correlation_token":"sim_dc097e8b8e1b12acb6055250d006914a_1759932236215"}
{"timestamp":"2025-10-08T14:10:56.976Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min8_1759932656949","minute_requested":8,"minutes_already_billed":7,"attempt_id":"f3e650f8-3538-483e-a048-4c0357c6b086"}
{"timestamp":"2025-10-08T14:10:56.976Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min8_1759932656949","attempt_id":"f3e650f8-3538-483e-a048-4c0357c6b086","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":31,"minutes_already_billed":7,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-10-08T14:10:56.976Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min8_1759932656949","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":31,"expected_balance_after":30,"minute_to_bill":8}
{"timestamp":"2025-10-08T14:10:56.982Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min8_1759932656949","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-10-08T14:10:56.986Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min8_1759932656949","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":31,"new_balance":30,"change":-1}
{"timestamp":"2025-10-08T14:10:56.986Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min8_1759932656949","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":30,"minute":8}
{"timestamp":"2025-10-08T14:10:56.990Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min8_1759932656949","transaction_id":"c61802cd-5d4c-429d-b39b-6ff44a2881ec","transaction_type":"DEBIT","balance_after":30}
{"timestamp":"2025-10-08T14:10:56.990Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min8_1759932656949","attempt_id":"f3e650f8-3538-483e-a048-4c0357c6b086","new_minutes_billed":8,"new_duration_seconds":480}
{"timestamp":"2025-10-08T14:10:56.994Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min8_1759932656949","attempt_id":"f3e650f8-3538-483e-a048-4c0357c6b086","minutes_billed":8}
{"timestamp":"2025-10-08T14:10:56.996Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min8_1759932656949","transaction_duration_ms":20,"new_balance":30,"minute_billed":8,"total_minutes_billed_this_attempt":8,"total_successful":8,"total_minutes_billed_all_time":8,"avg_transaction_time":"18.88"}
{"timestamp":"2025-10-08T14:10:56.996Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min8_1759932656949","total_duration_ms":47,"transaction_duration_ms":20,"response":{"status":"continue","creditsRemaining":30,"minuteBilled":8,"totalMinutesBilled":8,"attemptId":"f3e650f8-3538-483e-a048-4c0357c6b086","shouldTerminate":false}}
{"timestamp":"2025-10-08T14:11:57.002831","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min9_1759932717010","correlation_token":"sim_dc097e8b8e1b12acb6055250d006914a_1759932236215","conversation_id":"dc206f5b-82a6-43c0-a8bb-de0a56a0025e","minute":9,"metrics_total_requests":9}
{"timestamp":"2025-10-08T14:11:57.011Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min9_1759932717010","correlation_token":"sim_dc097e8b8e1b12acb6055250d006914a_1759932236215"}
{"timestamp":"2025-10-08T14:11:57.033Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min9_1759932717010","minute_requested":9,"minutes_already_billed":8,"attempt_id":"f3e650f8-3538-483e-a048-4c0357c6b086"}
{"timestamp":"2025-10-08T14:11:57.033Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min9_1759932717010","attempt_id":"f3e650f8-3538-483e-a048-4c0357c6b086","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":30,"minutes_already_billed":8,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-10-08T14:11:57.033Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min9_1759932717010","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":30,"expected_balance_after":29,"minute_to_bill":9}
{"timestamp":"2025-10-08T14:11:57.038Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min9_1759932717010","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-10-08T14:11:57.042Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min9_1759932717010","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":30,"new_balance":29,"change":-1}
{"timestamp":"2025-10-08T14:11:57.042Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min9_1759932717010","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":29,"minute":9}
{"timestamp":"2025-10-08T14:11:57.045Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min9_1759932717010","transaction_id":"adfda425-bdf2-421e-baba-e0dc56407bc6","transaction_type":"DEBIT","balance_after":29}
{"timestamp":"2025-10-08T14:11:57.045Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min9_1759932717010","attempt_id":"f3e650f8-3538-483e-a048-4c0357c6b086","new_minutes_billed":9,"new_duration_seconds":540}
{"timestamp":"2025-10-08T14:11:57.048Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min9_1759932717010","attempt_id":"f3e650f8-3538-483e-a048-4c0357c6b086","minutes_billed":9}
{"timestamp":"2025-10-08T14:11:57.050Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min9_1759932717010","transaction_duration_ms":17,"new_balance":29,"minute_billed":9,"total_minutes_billed_this_attempt":9,"total_successful":9,"total_minutes_billed_all_time":9,"avg_transaction_time":"18.67"}
{"timestamp":"2025-10-08T14:11:57.050Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min9_1759932717010","total_duration_ms":40,"transaction_duration_ms":17,"response":{"status":"continue","creditsRemaining":29,"minuteBilled":9,"totalMinutesBilled":9,"attemptId":"f3e650f8-3538-483e-a048-4c0357c6b086","shouldTerminate":false}}
{"timestamp":"2025-10-08T14:12:57.056875","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min10_1759932777065","correlation_token":"sim_dc097e8b8e1b12acb6055250d006914a_1759932236215","conversation_id":"dc206f5b-82a6-43c0-a8bb-de0a56a0025e","minute":10,"metrics_total_requests":10}
{"timestamp":"2025-10-08T14:12:57.065Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min10_1759932777065","correlation_token":"sim_dc097e8b8e1b12acb6055250d006914a_1759932236215"}
{"timestamp":"2025-10-08T14:12:57.088Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min10_1759932777065","minute_requested":10,"minutes_already_billed":9,"attempt_id":"f3e650f8-3538-483e-a048-4c0357c6b086"}
{"timestamp":"2025-10-08T14:12:57.088Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min10_1759932777065","attempt_id":"f3e650f8-3538-483e-a048-4c0357c6b086","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":29,"minutes_already_billed":9,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-10-08T14:12:57.088Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min10_1759932777065","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":29,"expected_balance_after":28,"minute_to_bill":10}
{"timestamp":"2025-10-08T14:12:57.093Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min10_1759932777065","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-10-08T14:12:57.096Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min10_1759932777065","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":29,"new_balance":28,"change":-1}
{"timestamp":"2025-10-08T14:12:57.096Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min10_1759932777065","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":28,"minute":10}
{"timestamp":"2025-10-08T14:12:57.099Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min10_1759932777065","transaction_id":"8bc7dcad-6a43-4d02-bb87-faf04d7e605a","transaction_type":"DEBIT","balance_after":28}
{"timestamp":"2025-10-08T14:12:57.099Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min10_1759932777065","attempt_id":"f3e650f8-3538-483e-a048-4c0357c6b086","new_minutes_billed":10,"new_duration_seconds":600}
{"timestamp":"2025-10-08T14:12:57.102Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min10_1759932777065","attempt_id":"f3e650f8-3538-483e-a048-4c0357c6b086","minutes_billed":10}
{"timestamp":"2025-10-08T14:12:57.103Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min10_1759932777065","transaction_duration_ms":15,"new_balance":28,"minute_billed":10,"total_minutes_billed_this_attempt":10,"total_successful":10,"total_minutes_billed_all_time":10,"avg_transaction_time":"18.30"}
{"timestamp":"2025-10-08T14:12:57.104Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min10_1759932777065","total_duration_ms":39,"transaction_duration_ms":15,"response":{"status":"continue","creditsRemaining":28,"minuteBilled":10,"totalMinutesBilled":10,"attemptId":"f3e650f8-3538-483e-a048-4c0357c6b086","shouldTerminate":false}}
{"timestamp":"2025-10-08T14:13:57.109145","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min11_1759932837115","correlation_token":"sim_dc097e8b8e1b12acb6055250d006914a_1759932236215","conversation_id":"dc206f5b-82a6-43c0-a8bb-de0a56a0025e","minute":11,"metrics_total_requests":11}
{"timestamp":"2025-10-08T14:13:57.115Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min11_1759932837115","correlation_token":"sim_dc097e8b8e1b12acb6055250d006914a_1759932236215"}
{"timestamp":"2025-10-08T14:13:57.137Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min11_1759932837115","minute_requested":11,"minutes_already_billed":10,"attempt_id":"f3e650f8-3538-483e-a048-4c0357c6b086"}
{"timestamp":"2025-10-08T14:13:57.137Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min11_1759932837115","attempt_id":"f3e650f8-3538-483e-a048-4c0357c6b086","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":28,"minutes_already_billed":10,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-10-08T14:13:57.137Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min11_1759932837115","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":28,"expected_balance_after":27,"minute_to_bill":11}
{"timestamp":"2025-10-08T14:13:57.142Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min11_1759932837115","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-10-08T14:13:57.145Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min11_1759932837115","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":28,"new_balance":27,"change":-1}
{"timestamp":"2025-10-08T14:13:57.145Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min11_1759932837115","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":27,"minute":11}
{"timestamp":"2025-10-08T14:13:57.148Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min11_1759932837115","transaction_id":"ad931ff6-7c2c-402d-8964-080a81e22ecf","transaction_type":"DEBIT","balance_after":27}
{"timestamp":"2025-10-08T14:13:57.148Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min11_1759932837115","attempt_id":"f3e650f8-3538-483e-a048-4c0357c6b086","new_minutes_billed":11,"new_duration_seconds":660}
{"timestamp":"2025-10-08T14:13:57.151Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min11_1759932837115","attempt_id":"f3e650f8-3538-483e-a048-4c0357c6b086","minutes_billed":11}
{"timestamp":"2025-10-08T14:13:57.152Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min11_1759932837115","transaction_duration_ms":15,"new_balance":27,"minute_billed":11,"total_minutes_billed_this_attempt":11,"total_successful":11,"total_minutes_billed_all_time":11,"avg_transaction_time":"18.00"}
{"timestamp":"2025-10-08T14:13:57.152Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min11_1759932837115","total_duration_ms":37,"transaction_duration_ms":15,"response":{"status":"continue","creditsRemaining":27,"minuteBilled":11,"totalMinutesBilled":11,"attemptId":"f3e650f8-3538-483e-a048-4c0357c6b086","shouldTerminate":false}}
{"timestamp":"2025-10-08T14:14:57.158706","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min12_1759932897168","correlation_token":"sim_dc097e8b8e1b12acb6055250d006914a_1759932236215","conversation_id":"dc206f5b-82a6-43c0-a8bb-de0a56a0025e","minute":12,"metrics_total_requests":12}
{"timestamp":"2025-10-08T14:14:57.168Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min12_1759932897168","correlation_token":"sim_dc097e8b8e1b12acb6055250d006914a_1759932236215"}
{"timestamp":"2025-10-08T14:14:57.192Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min12_1759932897168","minute_requested":12,"minutes_already_billed":11,"attempt_id":"f3e650f8-3538-483e-a048-4c0357c6b086"}
{"timestamp":"2025-10-08T14:14:57.192Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min12_1759932897168","attempt_id":"f3e650f8-3538-483e-a048-4c0357c6b086","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":27,"minutes_already_billed":11,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-10-08T14:14:57.193Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min12_1759932897168","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":27,"expected_balance_after":26,"minute_to_bill":12}
{"timestamp":"2025-10-08T14:14:57.199Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min12_1759932897168","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-10-08T14:14:57.203Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min12_1759932897168","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":27,"new_balance":26,"change":-1}
{"timestamp":"2025-10-08T14:14:57.203Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min12_1759932897168","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":26,"minute":12}
{"timestamp":"2025-10-08T14:14:57.206Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min12_1759932897168","transaction_id":"a0bf1ea8-e7f0-46f5-ac6f-7ec29395472c","transaction_type":"DEBIT","balance_after":26}
{"timestamp":"2025-10-08T14:14:57.206Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min12_1759932897168","attempt_id":"f3e650f8-3538-483e-a048-4c0357c6b086","new_minutes_billed":12,"new_duration_seconds":720}
{"timestamp":"2025-10-08T14:14:57.209Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min12_1759932897168","attempt_id":"f3e650f8-3538-483e-a048-4c0357c6b086","minutes_billed":12}
{"timestamp":"2025-10-08T14:14:57.211Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min12_1759932897168","transaction_duration_ms":18,"new_balance":26,"minute_billed":12,"total_minutes_billed_this_attempt":12,"total_successful":12,"total_minutes_billed_all_time":12,"avg_transaction_time":"18.00"}
{"timestamp":"2025-10-08T14:14:57.211Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min12_1759932897168","total_duration_ms":43,"transaction_duration_ms":18,"response":{"status":"continue","creditsRemaining":26,"minuteBilled":12,"totalMinutesBilled":12,"attemptId":"f3e650f8-3538-483e-a048-4c0357c6b086","shouldTerminate":false}}
{"timestamp":"2025-10-08T14:15:57.216948","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min13_1759932957224","correlation_token":"sim_dc097e8b8e1b12acb6055250d006914a_1759932236215","conversation_id":"dc206f5b-82a6-43c0-a8bb-de0a56a0025e","minute":13,"metrics_total_requests":13}
{"timestamp":"2025-10-08T14:15:57.224Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min13_1759932957224","correlation_token":"sim_dc097e8b8e1b12acb6055250d006914a_1759932236215"}
{"timestamp":"2025-10-08T14:15:57.249Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min13_1759932957224","minute_requested":13,"minutes_already_billed":12,"attempt_id":"f3e650f8-3538-483e-a048-4c0357c6b086"}
{"timestamp":"2025-10-08T14:15:57.249Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min13_1759932957224","attempt_id":"f3e650f8-3538-483e-a048-4c0357c6b086","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":26,"minutes_already_billed":12,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-10-08T14:15:57.249Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min13_1759932957224","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":26,"expected_balance_after":25,"minute_to_bill":13}
{"timestamp":"2025-10-08T14:15:57.254Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min13_1759932957224","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-10-08T14:15:57.258Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min13_1759932957224","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":26,"new_balance":25,"change":-1}
{"timestamp":"2025-10-08T14:15:57.258Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min13_1759932957224","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":25,"minute":13}
{"timestamp":"2025-10-08T14:15:57.261Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min13_1759932957224","transaction_id":"524950b0-6621-4b82-bb36-621878bfe315","transaction_type":"DEBIT","balance_after":25}
{"timestamp":"2025-10-08T14:15:57.261Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min13_1759932957224","attempt_id":"f3e650f8-3538-483e-a048-4c0357c6b086","new_minutes_billed":13,"new_duration_seconds":780}
{"timestamp":"2025-10-08T14:15:57.264Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min13_1759932957224","attempt_id":"f3e650f8-3538-483e-a048-4c0357c6b086","minutes_billed":13}
{"timestamp":"2025-10-08T14:15:57.266Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min13_1759932957224","transaction_duration_ms":17,"new_balance":25,"minute_billed":13,"total_minutes_billed_this_attempt":13,"total_successful":13,"total_minutes_billed_all_time":13,"avg_transaction_time":"17.92"}
{"timestamp":"2025-10-08T14:15:57.266Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min13_1759932957224","total_duration_ms":42,"transaction_duration_ms":17,"response":{"status":"continue","creditsRemaining":25,"minuteBilled":13,"totalMinutesBilled":13,"attemptId":"f3e650f8-3538-483e-a048-4c0357c6b086","shouldTerminate":false}}
{"timestamp":"2025-10-08T14:16:57.272131","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min14_1759933017279","correlation_token":"sim_dc097e8b8e1b12acb6055250d006914a_1759932236215","conversation_id":"dc206f5b-82a6-43c0-a8bb-de0a56a0025e","minute":14,"metrics_total_requests":14}
{"timestamp":"2025-10-08T14:16:57.279Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min14_1759933017279","correlation_token":"sim_dc097e8b8e1b12acb6055250d006914a_1759932236215"}
{"timestamp":"2025-10-08T14:16:57.302Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min14_1759933017279","minute_requested":14,"minutes_already_billed":13,"attempt_id":"f3e650f8-3538-483e-a048-4c0357c6b086"}
{"timestamp":"2025-10-08T14:16:57.302Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min14_1759933017279","attempt_id":"f3e650f8-3538-483e-a048-4c0357c6b086","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":25,"minutes_already_billed":13,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-10-08T14:16:57.302Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min14_1759933017279","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":25,"expected_balance_after":24,"minute_to_bill":14}
{"timestamp":"2025-10-08T14:16:57.308Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min14_1759933017279","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-10-08T14:16:57.311Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min14_1759933017279","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":25,"new_balance":24,"change":-1}
{"timestamp":"2025-10-08T14:16:57.311Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min14_1759933017279","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":24,"minute":14}
{"timestamp":"2025-10-08T14:16:57.314Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min14_1759933017279","transaction_id":"767180c3-e0e3-486a-b1b0-4baefe0b2e75","transaction_type":"DEBIT","balance_after":24}
{"timestamp":"2025-10-08T14:16:57.314Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min14_1759933017279","attempt_id":"f3e650f8-3538-483e-a048-4c0357c6b086","new_minutes_billed":14,"new_duration_seconds":840}
{"timestamp":"2025-10-08T14:16:57.317Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min14_1759933017279","attempt_id":"f3e650f8-3538-483e-a048-4c0357c6b086","minutes_billed":14}
{"timestamp":"2025-10-08T14:16:57.319Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min14_1759933017279","transaction_duration_ms":17,"new_balance":24,"minute_billed":14,"total_minutes_billed_this_attempt":14,"total_successful":14,"total_minutes_billed_all_time":14,"avg_transaction_time":"17.86"}
{"timestamp":"2025-10-08T14:16:57.319Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min14_1759933017279","total_duration_ms":40,"transaction_duration_ms":17,"response":{"status":"continue","creditsRemaining":24,"minuteBilled":14,"totalMinutesBilled":14,"attemptId":"f3e650f8-3538-483e-a048-4c0357c6b086","shouldTerminate":false}}
{"timestamp":"2025-10-08T14:17:57.324920","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min15_1759933077330","correlation_token":"sim_dc097e8b8e1b12acb6055250d006914a_1759932236215","conversation_id":"dc206f5b-82a6-43c0-a8bb-de0a56a0025e","minute":15,"metrics_total_requests":15}
{"timestamp":"2025-10-08T14:17:57.330Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min15_1759933077330","correlation_token":"sim_dc097e8b8e1b12acb6055250d006914a_1759932236215"}
{"timestamp":"2025-10-08T14:17:57.345Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min15_1759933077330","minute_requested":15,"minutes_already_billed":14,"attempt_id":"f3e650f8-3538-483e-a048-4c0357c6b086"}
{"timestamp":"2025-10-08T14:17:57.346Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min15_1759933077330","attempt_id":"f3e650f8-3538-483e-a048-4c0357c6b086","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":24,"minutes_already_billed":14,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-10-08T14:17:57.346Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min15_1759933077330","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":24,"expected_balance_after":23,"minute_to_bill":15}
{"timestamp":"2025-10-08T14:17:57.351Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min15_1759933077330","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-10-08T14:17:57.353Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min15_1759933077330","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":24,"new_balance":23,"change":-1}
{"timestamp":"2025-10-08T14:17:57.353Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min15_1759933077330","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":23,"minute":15}
{"timestamp":"2025-10-08T14:17:57.356Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min15_1759933077330","transaction_id":"5d9df53b-5c47-44e9-8a6b-f2ff59d5712c","transaction_type":"DEBIT","balance_after":23}
{"timestamp":"2025-10-08T14:17:57.356Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min15_1759933077330","attempt_id":"f3e650f8-3538-483e-a048-4c0357c6b086","new_minutes_billed":15,"new_duration_seconds":900}
{"timestamp":"2025-10-08T14:17:57.358Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min15_1759933077330","attempt_id":"f3e650f8-3538-483e-a048-4c0357c6b086","minutes_billed":15}
{"timestamp":"2025-10-08T14:17:57.360Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min15_1759933077330","transaction_duration_ms":14,"new_balance":23,"minute_billed":15,"total_minutes_billed_this_attempt":15,"total_successful":15,"total_minutes_billed_all_time":15,"avg_transaction_time":"17.60"}
{"timestamp":"2025-10-08T14:17:57.360Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min15_1759933077330","total_duration_ms":30,"transaction_duration_ms":14,"response":{"status":"continue","creditsRemaining":23,"minuteBilled":15,"totalMinutesBilled":15,"attemptId":"f3e650f8-3538-483e-a048-4c0357c6b086","shouldTerminate":false}}
{"timestamp":"2025-10-08T14:18:57.366681","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min16_1759933137373","correlation_token":"sim_dc097e8b8e1b12acb6055250d006914a_1759932236215","conversation_id":"dc206f5b-82a6-43c0-a8bb-de0a56a0025e","minute":16,"metrics_total_requests":16}
{"timestamp":"2025-10-08T14:18:57.373Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min16_1759933137373","correlation_token":"sim_dc097e8b8e1b12acb6055250d006914a_1759932236215"}
{"timestamp":"2025-10-08T14:18:57.397Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min16_1759933137373","minute_requested":16,"minutes_already_billed":15,"attempt_id":"f3e650f8-3538-483e-a048-4c0357c6b086"}
{"timestamp":"2025-10-08T14:18:57.397Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min16_1759933137373","attempt_id":"f3e650f8-3538-483e-a048-4c0357c6b086","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":23,"minutes_already_billed":15,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-10-08T14:18:57.397Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min16_1759933137373","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":23,"expected_balance_after":22,"minute_to_bill":16}
{"timestamp":"2025-10-08T14:18:57.402Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min16_1759933137373","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-10-08T14:18:57.405Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min16_1759933137373","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":23,"new_balance":22,"change":-1}
{"timestamp":"2025-10-08T14:18:57.406Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min16_1759933137373","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":22,"minute":16}
{"timestamp":"2025-10-08T14:18:57.410Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min16_1759933137373","transaction_id":"a369e84c-d409-4a9e-ba33-97d69793d19d","transaction_type":"DEBIT","balance_after":22}
{"timestamp":"2025-10-08T14:18:57.410Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min16_1759933137373","attempt_id":"f3e650f8-3538-483e-a048-4c0357c6b086","new_minutes_billed":16,"new_duration_seconds":960}
{"timestamp":"2025-10-08T14:18:57.413Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min16_1759933137373","attempt_id":"f3e650f8-3538-483e-a048-4c0357c6b086","minutes_billed":16}
{"timestamp":"2025-10-08T14:18:57.415Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min16_1759933137373","transaction_duration_ms":18,"new_balance":22,"minute_billed":16,"total_minutes_billed_this_attempt":16,"total_successful":16,"total_minutes_billed_all_time":16,"avg_transaction_time":"17.63"}
{"timestamp":"2025-10-08T14:18:57.415Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_dc206f5b-82a6-43c0-a8bb-de0a56a0025e_min16_1759933137373","total_duration_ms":42,"transaction_duration_ms":18,"response":{"status":"continue","creditsRemaining":22,"minuteBilled":16,"totalMinutesBilled":16,"attemptId":"f3e650f8-3538-483e-a048-4c0357c6b086","shouldTerminate":false}}
{"timestamp":"2025-10-08T14:33:20.646Z","level":"INFO","service":"BillingService","message":"BillingService initialized","environment":"development","database_url":"configured"}
{"timestamp":"2025-10-08T14:33:25.715Z","level":"INFO","service":"BillingService","message":"BillingService initialized","environment":"development","database_url":"configured"}
{"timestamp":"2025-10-08T14:33:56.593Z","level":"INFO","service":"BillingService","message":"BillingService initialized","environment":"development","database_url":"configured"}
{"timestamp":"2025-10-08T14:35:28.146Z","level":"INFO","service":"BillingService","message":"BillingService initialized","environment":"development","database_url":"configured"}
{"timestamp":"2025-10-08T14:36:14.558Z","level":"INFO","service":"BillingService","message":"BillingService initialized","environment":"development","database_url":"configured"}
{"timestamp":"2025-10-08T14:37:01.762Z","level":"INFO","service":"BillingService","message":"BillingService initialized","environment":"development","database_url":"configured"}
{"timestamp":"2025-10-08T14:37:04.523Z","level":"INFO","service":"BillingService","message":"BillingService initialized","environment":"development","database_url":"configured"}
{"timestamp":"2025-10-08T14:41:58.994Z","level":"INFO","service":"BillingService","message":"BillingService initialized","environment":"development","database_url":"configured"}
{"timestamp":"2025-10-08T14:43:28.432Z","level":"INFO","service":"BillingService","message":"BillingService initialized","environment":"development","database_url":"configured"}
{"timestamp":"2025-10-08T14:43:35.152Z","level":"INFO","service":"BillingService","message":"BillingService initialized","environment":"development","database_url":"configured"}
{"timestamp":"2025-10-08T14:46:54.655Z","level":"INFO","service":"BillingService","message":"BillingService initialized","environment":"development","database_url":"configured"}
{"timestamp":"2025-10-08T14:50:15.253Z","level":"INFO","service":"BillingService","message":"BillingService initialized","environment":"development","database_url":"configured"}
{"timestamp":"2025-10-08T14:56:56.208Z","level":"INFO","service":"BillingService","message":"BillingService initialized","environment":"development","database_url":"configured"}
{"timestamp":"2025-10-08T14:57:06.235Z","level":"INFO","service":"BillingService","message":"BillingService initialized","environment":"development","database_url":"configured"}
{"timestamp":"2025-10-08T14:57:32.680Z","level":"INFO","service":"BillingService","message":"BillingService initialized","environment":"development","database_url":"configured"}
{"timestamp":"2025-10-08T15:13:46.003Z","level":"INFO","service":"BillingService","message":"BillingService initialized","environment":"development","database_url":"configured"}
{"timestamp":"2025-10-08T15:17:12.802Z","level":"INFO","service":"BillingService","message":"BillingService initialized","environment":"development","database_url":"configured"}
{"timestamp":"2025-10-08T15:18:40.140Z","level":"INFO","service":"BillingService","message":"BillingService initialized","environment":"development","database_url":"configured"}
{"timestamp":"2025-10-08T15:22:05.363Z","level":"INFO","service":"BillingService","message":"BillingService initialized","environment":"development","database_url":"configured"}

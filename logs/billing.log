{"timestamp":"2025-09-20T11:35:12.438Z","level":"INFO","service":"BillingService","message":"BillingService initialized","environment":"development","database_url":"configured"}
{"timestamp":"2025-01-15T12:00:00Z","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_conv_test_20250115_min1_1758368137430","correlation_token":"sim_e1f090e566a9b318d0fc6419d125346e_1758367895922","conversation_id":"conv_test_20250115","minute":1,"metrics_total_requests":1}
{"timestamp":"2025-09-20T11:35:37.431Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_conv_test_20250115_min1_1758368137430","correlation_token":"sim_e1f090e566a9b318d0fc6419d125346e_1758367895922"}
{"timestamp":"2025-09-20T11:35:39.433Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_conv_test_20250115_min1_1758368137430","minute_requested":1,"minutes_already_billed":0,"attempt_id":"c426245e-d4cc-40df-85b0-34914453635e"}
{"timestamp":"2025-09-20T11:35:39.433Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_conv_test_20250115_min1_1758368137430","attempt_id":"c426245e-d4cc-40df-85b0-34914453635e","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":9,"minutes_already_billed":0,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-20T11:35:39.434Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_conv_test_20250115_min1_1758368137430","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":9,"expected_balance_after":8,"minute_to_bill":1}
{"timestamp":"2025-09-20T11:35:39.438Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_conv_test_20250115_min1_1758368137430","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-20T11:35:39.443Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_conv_test_20250115_min1_1758368137430","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":9,"new_balance":8,"change":-1}
{"timestamp":"2025-09-20T11:35:39.443Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_conv_test_20250115_min1_1758368137430","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":8,"minute":1}
{"timestamp":"2025-09-20T11:35:39.448Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_conv_test_20250115_min1_1758368137430","transaction_id":"962bd3fe-6dca-4240-bf17-0270d1f207ed","transaction_type":"DEBIT","balance_after":8}
{"timestamp":"2025-09-20T11:35:39.448Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_conv_test_20250115_min1_1758368137430","attempt_id":"c426245e-d4cc-40df-85b0-34914453635e","new_minutes_billed":1,"new_duration_seconds":60}
{"timestamp":"2025-09-20T11:35:39.452Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_conv_test_20250115_min1_1758368137430","attempt_id":"c426245e-d4cc-40df-85b0-34914453635e","minutes_billed":1}
{"timestamp":"2025-09-20T11:35:39.453Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_conv_test_20250115_min1_1758368137430","transaction_duration_ms":19,"new_balance":8,"minute_billed":1,"total_minutes_billed_this_attempt":1,"total_successful":1,"total_minutes_billed_all_time":1,"avg_transaction_time":"19.00"}
{"timestamp":"2025-09-20T11:35:39.454Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_conv_test_20250115_min1_1758368137430","total_duration_ms":2024,"transaction_duration_ms":19,"response":{"status":"continue","creditsRemaining":8,"minuteBilled":1,"totalMinutesBilled":1,"attemptId":"c426245e-d4cc-40df-85b0-34914453635e","shouldTerminate":false}}
{"timestamp":"2025-01-15T12:00:00Z","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_conv_test_20250115_min1_1758368155024","correlation_token":"sim_e1f090e566a9b318d0fc6419d125346e_1758367895922","conversation_id":"conv_test_20250115","minute":1,"metrics_total_requests":2}
{"timestamp":"2025-09-20T11:35:55.024Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_conv_test_20250115_min1_1758368155024","correlation_token":"sim_e1f090e566a9b318d0fc6419d125346e_1758367895922"}
{"timestamp":"2025-09-20T11:35:55.042Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_conv_test_20250115_min1_1758368155024","minute_requested":1,"minutes_already_billed":1,"attempt_id":"c426245e-d4cc-40df-85b0-34914453635e"}
{"timestamp":"2025-09-20T11:35:55.042Z","level":"WARN","service":"BillingService","message":"Minute already billed - returning idempotent response","requestId":"bill_conv_test_20250115_min1_1758368155024","minute_requested":1,"minutes_already_billed":1,"attempt_id":"c426245e-d4cc-40df-85b0-34914453635e","total_duplicates":1}
{"timestamp":"2025-09-20T11:35:55.042Z","level":"INFO","service":"BillingService","message":"Returning idempotent response","requestId":"bill_conv_test_20250115_min1_1758368155024","response":{"status":"continue","creditsRemaining":8,"minuteBilled":1,"totalMinutesBilled":1,"attemptId":"c426245e-d4cc-40df-85b0-34914453635e","shouldTerminate":false,"message":"Already billed (idempotent response)"},"duration_ms":18}
{"timestamp":"2025-01-15T12:01:00Z","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_conv_test_20250115_min2_1758368189675","correlation_token":"sim_e1f090e566a9b318d0fc6419d125346e_1758367895922","conversation_id":"conv_test_20250115","minute":2,"metrics_total_requests":3}
{"timestamp":"2025-09-20T11:36:29.676Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_conv_test_20250115_min2_1758368189675","correlation_token":"sim_e1f090e566a9b318d0fc6419d125346e_1758367895922"}
{"timestamp":"2025-09-20T11:36:29.690Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_conv_test_20250115_min2_1758368189675","minute_requested":2,"minutes_already_billed":1,"attempt_id":"c426245e-d4cc-40df-85b0-34914453635e"}
{"timestamp":"2025-09-20T11:36:29.690Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_conv_test_20250115_min2_1758368189675","attempt_id":"c426245e-d4cc-40df-85b0-34914453635e","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":8,"minutes_already_billed":1,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-20T11:36:29.690Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_conv_test_20250115_min2_1758368189675","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":8,"expected_balance_after":7,"minute_to_bill":2}
{"timestamp":"2025-09-20T11:36:29.695Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_conv_test_20250115_min2_1758368189675","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-20T11:36:29.697Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_conv_test_20250115_min2_1758368189675","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":8,"new_balance":7,"change":-1}
{"timestamp":"2025-09-20T11:36:29.698Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_conv_test_20250115_min2_1758368189675","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":7,"minute":2}
{"timestamp":"2025-09-20T11:36:29.700Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_conv_test_20250115_min2_1758368189675","transaction_id":"b193bf2d-4f20-416c-8eeb-a3b9511bab71","transaction_type":"DEBIT","balance_after":7}
{"timestamp":"2025-09-20T11:36:29.700Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_conv_test_20250115_min2_1758368189675","attempt_id":"c426245e-d4cc-40df-85b0-34914453635e","new_minutes_billed":2,"new_duration_seconds":120}
{"timestamp":"2025-09-20T11:36:29.703Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_conv_test_20250115_min2_1758368189675","attempt_id":"c426245e-d4cc-40df-85b0-34914453635e","minutes_billed":2}
{"timestamp":"2025-09-20T11:36:29.705Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_conv_test_20250115_min2_1758368189675","transaction_duration_ms":15,"new_balance":7,"minute_billed":2,"total_minutes_billed_this_attempt":2,"total_successful":2,"total_minutes_billed_all_time":2,"avg_transaction_time":"17.00"}
{"timestamp":"2025-09-20T11:36:29.705Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_conv_test_20250115_min2_1758368189675","total_duration_ms":30,"transaction_duration_ms":15,"response":{"status":"continue","creditsRemaining":7,"minuteBilled":2,"totalMinutesBilled":2,"attemptId":"c426245e-d4cc-40df-85b0-34914453635e","shouldTerminate":false}}
{"timestamp":"2025-01-15T12:01:00Z","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_conv_test_20250115_min2_1758368194433","correlation_token":"sim_e1f090e566a9b318d0fc6419d125346e_1758367895922","conversation_id":"conv_test_20250115","minute":2,"metrics_total_requests":4}
{"timestamp":"2025-09-20T11:36:34.433Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_conv_test_20250115_min2_1758368194433","correlation_token":"sim_e1f090e566a9b318d0fc6419d125346e_1758367895922"}
{"timestamp":"2025-09-20T11:36:34.442Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_conv_test_20250115_min2_1758368194433","minute_requested":2,"minutes_already_billed":2,"attempt_id":"c426245e-d4cc-40df-85b0-34914453635e"}
{"timestamp":"2025-09-20T11:36:34.442Z","level":"WARN","service":"BillingService","message":"Minute already billed - returning idempotent response","requestId":"bill_conv_test_20250115_min2_1758368194433","minute_requested":2,"minutes_already_billed":2,"attempt_id":"c426245e-d4cc-40df-85b0-34914453635e","total_duplicates":2}
{"timestamp":"2025-09-20T11:36:34.442Z","level":"INFO","service":"BillingService","message":"Returning idempotent response","requestId":"bill_conv_test_20250115_min2_1758368194433","response":{"status":"continue","creditsRemaining":7,"minuteBilled":2,"totalMinutesBilled":2,"attemptId":"c426245e-d4cc-40df-85b0-34914453635e","shouldTerminate":false,"message":"Already billed (idempotent response)"},"duration_ms":9}
{"timestamp":"2025-09-20T11:56:03.935Z","level":"INFO","service":"BillingService","message":"BillingService initialized","environment":"development","database_url":"configured"}
{"timestamp":"2025-09-20T11:56:04.599715","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_895797ed-33a5-407e-baf4-abc36bfd1236_min7_1758369364607","correlation_token":"transcript-1758368943088-kinj7cr70","conversation_id":"895797ed-33a5-407e-baf4-abc36bfd1236","minute":7,"metrics_total_requests":1}
{"timestamp":"2025-09-20T11:56:04.608Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_895797ed-33a5-407e-baf4-abc36bfd1236_min7_1758369364607","correlation_token":"transcript-1758368943088-kinj7cr70"}
{"timestamp":"2025-09-20T11:56:04.639Z","level":"ERROR","service":"BillingService","message":"Invalid correlation token - no attempt found","requestId":"bill_895797ed-33a5-407e-baf4-abc36bfd1236_min7_1758369364607","correlation_token":"transcript-1758368943088-kinj7cr70","conversation_id":"895797ed-33a5-407e-baf4-abc36bfd1236"}
{"timestamp":"2025-09-20T11:56:04.642630","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_895797ed-33a5-407e-baf4-abc36bfd1236_min8_1758369364644","correlation_token":"transcript-1758368943088-kinj7cr70","conversation_id":"895797ed-33a5-407e-baf4-abc36bfd1236","minute":8,"metrics_total_requests":2}
{"timestamp":"2025-09-20T11:56:04.644Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_895797ed-33a5-407e-baf4-abc36bfd1236_min8_1758369364644","correlation_token":"transcript-1758368943088-kinj7cr70"}
{"timestamp":"2025-09-20T11:56:04.651Z","level":"ERROR","service":"BillingService","message":"Invalid correlation token - no attempt found","requestId":"bill_895797ed-33a5-407e-baf4-abc36bfd1236_min8_1758369364644","correlation_token":"transcript-1758368943088-kinj7cr70","conversation_id":"895797ed-33a5-407e-baf4-abc36bfd1236"}
{"timestamp":"2025-09-20T11:57:31.765164","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_53a8d897-a171-4ebc-9821-89086d939d0a_min1_1758369451773","correlation_token":"transcript-1758369389402-ypypj5ahv","conversation_id":"53a8d897-a171-4ebc-9821-89086d939d0a","minute":1,"metrics_total_requests":3}
{"timestamp":"2025-09-20T11:57:31.773Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_53a8d897-a171-4ebc-9821-89086d939d0a_min1_1758369451773","correlation_token":"transcript-1758369389402-ypypj5ahv"}
{"timestamp":"2025-09-20T11:57:31.781Z","level":"ERROR","service":"BillingService","message":"Invalid correlation token - no attempt found","requestId":"bill_53a8d897-a171-4ebc-9821-89086d939d0a_min1_1758369451773","correlation_token":"transcript-1758369389402-ypypj5ahv","conversation_id":"53a8d897-a171-4ebc-9821-89086d939d0a"}
{"timestamp":"2025-09-20T11:57:31.782775","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_53a8d897-a171-4ebc-9821-89086d939d0a_min2_1758369451784","correlation_token":"transcript-1758369389402-ypypj5ahv","conversation_id":"53a8d897-a171-4ebc-9821-89086d939d0a","minute":2,"metrics_total_requests":4}
{"timestamp":"2025-09-20T11:57:31.784Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_53a8d897-a171-4ebc-9821-89086d939d0a_min2_1758369451784","correlation_token":"transcript-1758369389402-ypypj5ahv"}
{"timestamp":"2025-09-20T11:57:31.788Z","level":"ERROR","service":"BillingService","message":"Invalid correlation token - no attempt found","requestId":"bill_53a8d897-a171-4ebc-9821-89086d939d0a_min2_1758369451784","correlation_token":"transcript-1758369389402-ypypj5ahv","conversation_id":"53a8d897-a171-4ebc-9821-89086d939d0a"}
{"timestamp":"2025-09-20T11:58:18.613379","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_8b1e4e06-ee6a-49c3-9fab-f84203a51d0f_min1_1758369498615","correlation_token":"transcript-1758369437392-791iwmalz","conversation_id":"8b1e4e06-ee6a-49c3-9fab-f84203a51d0f","minute":1,"metrics_total_requests":5}
{"timestamp":"2025-09-20T11:58:18.615Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_8b1e4e06-ee6a-49c3-9fab-f84203a51d0f_min1_1758369498615","correlation_token":"transcript-1758369437392-791iwmalz"}
{"timestamp":"2025-09-20T11:58:18.624Z","level":"ERROR","service":"BillingService","message":"Invalid correlation token - no attempt found","requestId":"bill_8b1e4e06-ee6a-49c3-9fab-f84203a51d0f_min1_1758369498615","correlation_token":"transcript-1758369437392-791iwmalz","conversation_id":"8b1e4e06-ee6a-49c3-9fab-f84203a51d0f"}
{"timestamp":"2025-09-20T11:58:18.625739","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_8b1e4e06-ee6a-49c3-9fab-f84203a51d0f_min2_1758369498628","correlation_token":"transcript-1758369437392-791iwmalz","conversation_id":"8b1e4e06-ee6a-49c3-9fab-f84203a51d0f","minute":2,"metrics_total_requests":6}
{"timestamp":"2025-09-20T11:58:18.628Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_8b1e4e06-ee6a-49c3-9fab-f84203a51d0f_min2_1758369498628","correlation_token":"transcript-1758369437392-791iwmalz"}
{"timestamp":"2025-09-20T11:58:18.632Z","level":"ERROR","service":"BillingService","message":"Invalid correlation token - no attempt found","requestId":"bill_8b1e4e06-ee6a-49c3-9fab-f84203a51d0f_min2_1758369498628","correlation_token":"transcript-1758369437392-791iwmalz","conversation_id":"8b1e4e06-ee6a-49c3-9fab-f84203a51d0f"}
{"timestamp":"2025-09-20T12:01:30.625262","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_6c24bc16-f8ff-46b0-b0a8-d4f2a6740d79_min1_1758369690629","correlation_token":"transcript-1758369628826-y132dq1k9","conversation_id":"6c24bc16-f8ff-46b0-b0a8-d4f2a6740d79","minute":1,"metrics_total_requests":7}
{"timestamp":"2025-09-20T12:01:30.629Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_6c24bc16-f8ff-46b0-b0a8-d4f2a6740d79_min1_1758369690629","correlation_token":"transcript-1758369628826-y132dq1k9"}
{"timestamp":"2025-09-20T12:01:30.635Z","level":"ERROR","service":"BillingService","message":"Invalid correlation token - no attempt found","requestId":"bill_6c24bc16-f8ff-46b0-b0a8-d4f2a6740d79_min1_1758369690629","correlation_token":"transcript-1758369628826-y132dq1k9","conversation_id":"6c24bc16-f8ff-46b0-b0a8-d4f2a6740d79"}
{"timestamp":"2025-09-20T12:01:30.637177","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_6c24bc16-f8ff-46b0-b0a8-d4f2a6740d79_min2_1758369690638","correlation_token":"transcript-1758369628826-y132dq1k9","conversation_id":"6c24bc16-f8ff-46b0-b0a8-d4f2a6740d79","minute":2,"metrics_total_requests":8}
{"timestamp":"2025-09-20T12:01:30.638Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_6c24bc16-f8ff-46b0-b0a8-d4f2a6740d79_min2_1758369690638","correlation_token":"transcript-1758369628826-y132dq1k9"}
{"timestamp":"2025-09-20T12:01:30.642Z","level":"ERROR","service":"BillingService","message":"Invalid correlation token - no attempt found","requestId":"bill_6c24bc16-f8ff-46b0-b0a8-d4f2a6740d79_min2_1758369690638","correlation_token":"transcript-1758369628826-y132dq1k9","conversation_id":"6c24bc16-f8ff-46b0-b0a8-d4f2a6740d79"}
{"timestamp":"2025-09-20T12:01:47.481032","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_32a77db9-134e-43bf-bd17-dc15298b5e71_min1_1758369707492","correlation_token":"transcript-1758369644655-pij2v79bw","conversation_id":"32a77db9-134e-43bf-bd17-dc15298b5e71","minute":1,"metrics_total_requests":9}
{"timestamp":"2025-09-20T12:01:47.492Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_32a77db9-134e-43bf-bd17-dc15298b5e71_min1_1758369707492","correlation_token":"transcript-1758369644655-pij2v79bw"}
{"timestamp":"2025-09-20T12:01:47.512Z","level":"ERROR","service":"BillingService","message":"Invalid correlation token - no attempt found","requestId":"bill_32a77db9-134e-43bf-bd17-dc15298b5e71_min1_1758369707492","correlation_token":"transcript-1758369644655-pij2v79bw","conversation_id":"32a77db9-134e-43bf-bd17-dc15298b5e71"}
{"timestamp":"2025-09-20T12:01:47.514792","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_32a77db9-134e-43bf-bd17-dc15298b5e71_min2_1758369707516","correlation_token":"transcript-1758369644655-pij2v79bw","conversation_id":"32a77db9-134e-43bf-bd17-dc15298b5e71","minute":2,"metrics_total_requests":10}
{"timestamp":"2025-09-20T12:01:47.516Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_32a77db9-134e-43bf-bd17-dc15298b5e71_min2_1758369707516","correlation_token":"transcript-1758369644655-pij2v79bw"}
{"timestamp":"2025-09-20T12:01:47.521Z","level":"ERROR","service":"BillingService","message":"Invalid correlation token - no attempt found","requestId":"bill_32a77db9-134e-43bf-bd17-dc15298b5e71_min2_1758369707516","correlation_token":"transcript-1758369644655-pij2v79bw","conversation_id":"32a77db9-134e-43bf-bd17-dc15298b5e71"}
{"timestamp":"2025-09-20T12:05:12.359001","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min1_1758369912369","correlation_token":"sim_9f45b0f5d4509403eb6ac3ca0713584c_1758369613612","conversation_id":"75432d49-dd97-4171-a099-1fa5e0f6c1d2","minute":1,"metrics_total_requests":11}
{"timestamp":"2025-09-20T12:05:12.370Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min1_1758369912369","correlation_token":"sim_9f45b0f5d4509403eb6ac3ca0713584c_1758369613612"}
{"timestamp":"2025-09-20T12:05:12.398Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min1_1758369912369","minute_requested":1,"minutes_already_billed":0,"attempt_id":"6d431a57-6e41-45f1-8a0d-a65eddb78aea"}
{"timestamp":"2025-09-20T12:05:12.398Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min1_1758369912369","attempt_id":"6d431a57-6e41-45f1-8a0d-a65eddb78aea","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":7,"minutes_already_billed":0,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-20T12:05:12.399Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min1_1758369912369","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":7,"expected_balance_after":6,"minute_to_bill":1}
{"timestamp":"2025-09-20T12:05:12.407Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min1_1758369912369","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-20T12:05:12.411Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min1_1758369912369","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":7,"new_balance":6,"change":-1}
{"timestamp":"2025-09-20T12:05:12.411Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min1_1758369912369","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":6,"minute":1}
{"timestamp":"2025-09-20T12:05:12.415Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min1_1758369912369","transaction_id":"8203dc7e-2c7d-46c5-a386-ed7bf1765568","transaction_type":"DEBIT","balance_after":6}
{"timestamp":"2025-09-20T12:05:12.415Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min1_1758369912369","attempt_id":"6d431a57-6e41-45f1-8a0d-a65eddb78aea","new_minutes_billed":1,"new_duration_seconds":60}
{"timestamp":"2025-09-20T12:05:12.418Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min1_1758369912369","attempt_id":"6d431a57-6e41-45f1-8a0d-a65eddb78aea","minutes_billed":1}
{"timestamp":"2025-09-20T12:05:12.421Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min1_1758369912369","transaction_duration_ms":22,"new_balance":6,"minute_billed":1,"total_minutes_billed_this_attempt":1,"total_successful":1,"total_minutes_billed_all_time":1,"avg_transaction_time":"22.00"}
{"timestamp":"2025-09-20T12:05:12.421Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min1_1758369912369","total_duration_ms":52,"transaction_duration_ms":22,"response":{"status":"continue","creditsRemaining":6,"minuteBilled":1,"totalMinutesBilled":1,"attemptId":"6d431a57-6e41-45f1-8a0d-a65eddb78aea","shouldTerminate":false}}

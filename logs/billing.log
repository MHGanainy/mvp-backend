{"timestamp":"2025-09-20T11:35:12.438Z","level":"INFO","service":"BillingService","message":"BillingService initialized","environment":"development","database_url":"configured"}
{"timestamp":"2025-01-15T12:00:00Z","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_conv_test_20250115_min1_1758368137430","correlation_token":"sim_e1f090e566a9b318d0fc6419d125346e_1758367895922","conversation_id":"conv_test_20250115","minute":1,"metrics_total_requests":1}
{"timestamp":"2025-09-20T11:35:37.431Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_conv_test_20250115_min1_1758368137430","correlation_token":"sim_e1f090e566a9b318d0fc6419d125346e_1758367895922"}
{"timestamp":"2025-09-20T11:35:39.433Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_conv_test_20250115_min1_1758368137430","minute_requested":1,"minutes_already_billed":0,"attempt_id":"c426245e-d4cc-40df-85b0-34914453635e"}
{"timestamp":"2025-09-20T11:35:39.433Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_conv_test_20250115_min1_1758368137430","attempt_id":"c426245e-d4cc-40df-85b0-34914453635e","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":9,"minutes_already_billed":0,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-20T11:35:39.434Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_conv_test_20250115_min1_1758368137430","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":9,"expected_balance_after":8,"minute_to_bill":1}
{"timestamp":"2025-09-20T11:35:39.438Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_conv_test_20250115_min1_1758368137430","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-20T11:35:39.443Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_conv_test_20250115_min1_1758368137430","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":9,"new_balance":8,"change":-1}
{"timestamp":"2025-09-20T11:35:39.443Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_conv_test_20250115_min1_1758368137430","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":8,"minute":1}
{"timestamp":"2025-09-20T11:35:39.448Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_conv_test_20250115_min1_1758368137430","transaction_id":"962bd3fe-6dca-4240-bf17-0270d1f207ed","transaction_type":"DEBIT","balance_after":8}
{"timestamp":"2025-09-20T11:35:39.448Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_conv_test_20250115_min1_1758368137430","attempt_id":"c426245e-d4cc-40df-85b0-34914453635e","new_minutes_billed":1,"new_duration_seconds":60}
{"timestamp":"2025-09-20T11:35:39.452Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_conv_test_20250115_min1_1758368137430","attempt_id":"c426245e-d4cc-40df-85b0-34914453635e","minutes_billed":1}
{"timestamp":"2025-09-20T11:35:39.453Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_conv_test_20250115_min1_1758368137430","transaction_duration_ms":19,"new_balance":8,"minute_billed":1,"total_minutes_billed_this_attempt":1,"total_successful":1,"total_minutes_billed_all_time":1,"avg_transaction_time":"19.00"}
{"timestamp":"2025-09-20T11:35:39.454Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_conv_test_20250115_min1_1758368137430","total_duration_ms":2024,"transaction_duration_ms":19,"response":{"status":"continue","creditsRemaining":8,"minuteBilled":1,"totalMinutesBilled":1,"attemptId":"c426245e-d4cc-40df-85b0-34914453635e","shouldTerminate":false}}
{"timestamp":"2025-01-15T12:00:00Z","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_conv_test_20250115_min1_1758368155024","correlation_token":"sim_e1f090e566a9b318d0fc6419d125346e_1758367895922","conversation_id":"conv_test_20250115","minute":1,"metrics_total_requests":2}
{"timestamp":"2025-09-20T11:35:55.024Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_conv_test_20250115_min1_1758368155024","correlation_token":"sim_e1f090e566a9b318d0fc6419d125346e_1758367895922"}
{"timestamp":"2025-09-20T11:35:55.042Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_conv_test_20250115_min1_1758368155024","minute_requested":1,"minutes_already_billed":1,"attempt_id":"c426245e-d4cc-40df-85b0-34914453635e"}
{"timestamp":"2025-09-20T11:35:55.042Z","level":"WARN","service":"BillingService","message":"Minute already billed - returning idempotent response","requestId":"bill_conv_test_20250115_min1_1758368155024","minute_requested":1,"minutes_already_billed":1,"attempt_id":"c426245e-d4cc-40df-85b0-34914453635e","total_duplicates":1}
{"timestamp":"2025-09-20T11:35:55.042Z","level":"INFO","service":"BillingService","message":"Returning idempotent response","requestId":"bill_conv_test_20250115_min1_1758368155024","response":{"status":"continue","creditsRemaining":8,"minuteBilled":1,"totalMinutesBilled":1,"attemptId":"c426245e-d4cc-40df-85b0-34914453635e","shouldTerminate":false,"message":"Already billed (idempotent response)"},"duration_ms":18}
{"timestamp":"2025-01-15T12:01:00Z","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_conv_test_20250115_min2_1758368189675","correlation_token":"sim_e1f090e566a9b318d0fc6419d125346e_1758367895922","conversation_id":"conv_test_20250115","minute":2,"metrics_total_requests":3}
{"timestamp":"2025-09-20T11:36:29.676Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_conv_test_20250115_min2_1758368189675","correlation_token":"sim_e1f090e566a9b318d0fc6419d125346e_1758367895922"}
{"timestamp":"2025-09-20T11:36:29.690Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_conv_test_20250115_min2_1758368189675","minute_requested":2,"minutes_already_billed":1,"attempt_id":"c426245e-d4cc-40df-85b0-34914453635e"}
{"timestamp":"2025-09-20T11:36:29.690Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_conv_test_20250115_min2_1758368189675","attempt_id":"c426245e-d4cc-40df-85b0-34914453635e","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":8,"minutes_already_billed":1,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-20T11:36:29.690Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_conv_test_20250115_min2_1758368189675","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":8,"expected_balance_after":7,"minute_to_bill":2}
{"timestamp":"2025-09-20T11:36:29.695Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_conv_test_20250115_min2_1758368189675","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-20T11:36:29.697Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_conv_test_20250115_min2_1758368189675","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":8,"new_balance":7,"change":-1}
{"timestamp":"2025-09-20T11:36:29.698Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_conv_test_20250115_min2_1758368189675","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":7,"minute":2}
{"timestamp":"2025-09-20T11:36:29.700Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_conv_test_20250115_min2_1758368189675","transaction_id":"b193bf2d-4f20-416c-8eeb-a3b9511bab71","transaction_type":"DEBIT","balance_after":7}
{"timestamp":"2025-09-20T11:36:29.700Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_conv_test_20250115_min2_1758368189675","attempt_id":"c426245e-d4cc-40df-85b0-34914453635e","new_minutes_billed":2,"new_duration_seconds":120}
{"timestamp":"2025-09-20T11:36:29.703Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_conv_test_20250115_min2_1758368189675","attempt_id":"c426245e-d4cc-40df-85b0-34914453635e","minutes_billed":2}
{"timestamp":"2025-09-20T11:36:29.705Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_conv_test_20250115_min2_1758368189675","transaction_duration_ms":15,"new_balance":7,"minute_billed":2,"total_minutes_billed_this_attempt":2,"total_successful":2,"total_minutes_billed_all_time":2,"avg_transaction_time":"17.00"}
{"timestamp":"2025-09-20T11:36:29.705Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_conv_test_20250115_min2_1758368189675","total_duration_ms":30,"transaction_duration_ms":15,"response":{"status":"continue","creditsRemaining":7,"minuteBilled":2,"totalMinutesBilled":2,"attemptId":"c426245e-d4cc-40df-85b0-34914453635e","shouldTerminate":false}}
{"timestamp":"2025-01-15T12:01:00Z","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_conv_test_20250115_min2_1758368194433","correlation_token":"sim_e1f090e566a9b318d0fc6419d125346e_1758367895922","conversation_id":"conv_test_20250115","minute":2,"metrics_total_requests":4}
{"timestamp":"2025-09-20T11:36:34.433Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_conv_test_20250115_min2_1758368194433","correlation_token":"sim_e1f090e566a9b318d0fc6419d125346e_1758367895922"}
{"timestamp":"2025-09-20T11:36:34.442Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_conv_test_20250115_min2_1758368194433","minute_requested":2,"minutes_already_billed":2,"attempt_id":"c426245e-d4cc-40df-85b0-34914453635e"}
{"timestamp":"2025-09-20T11:36:34.442Z","level":"WARN","service":"BillingService","message":"Minute already billed - returning idempotent response","requestId":"bill_conv_test_20250115_min2_1758368194433","minute_requested":2,"minutes_already_billed":2,"attempt_id":"c426245e-d4cc-40df-85b0-34914453635e","total_duplicates":2}
{"timestamp":"2025-09-20T11:36:34.442Z","level":"INFO","service":"BillingService","message":"Returning idempotent response","requestId":"bill_conv_test_20250115_min2_1758368194433","response":{"status":"continue","creditsRemaining":7,"minuteBilled":2,"totalMinutesBilled":2,"attemptId":"c426245e-d4cc-40df-85b0-34914453635e","shouldTerminate":false,"message":"Already billed (idempotent response)"},"duration_ms":9}
{"timestamp":"2025-09-20T11:56:03.935Z","level":"INFO","service":"BillingService","message":"BillingService initialized","environment":"development","database_url":"configured"}
{"timestamp":"2025-09-20T11:56:04.599715","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_895797ed-33a5-407e-baf4-abc36bfd1236_min7_1758369364607","correlation_token":"transcript-1758368943088-kinj7cr70","conversation_id":"895797ed-33a5-407e-baf4-abc36bfd1236","minute":7,"metrics_total_requests":1}
{"timestamp":"2025-09-20T11:56:04.608Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_895797ed-33a5-407e-baf4-abc36bfd1236_min7_1758369364607","correlation_token":"transcript-1758368943088-kinj7cr70"}
{"timestamp":"2025-09-20T11:56:04.639Z","level":"ERROR","service":"BillingService","message":"Invalid correlation token - no attempt found","requestId":"bill_895797ed-33a5-407e-baf4-abc36bfd1236_min7_1758369364607","correlation_token":"transcript-1758368943088-kinj7cr70","conversation_id":"895797ed-33a5-407e-baf4-abc36bfd1236"}
{"timestamp":"2025-09-20T11:56:04.642630","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_895797ed-33a5-407e-baf4-abc36bfd1236_min8_1758369364644","correlation_token":"transcript-1758368943088-kinj7cr70","conversation_id":"895797ed-33a5-407e-baf4-abc36bfd1236","minute":8,"metrics_total_requests":2}
{"timestamp":"2025-09-20T11:56:04.644Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_895797ed-33a5-407e-baf4-abc36bfd1236_min8_1758369364644","correlation_token":"transcript-1758368943088-kinj7cr70"}
{"timestamp":"2025-09-20T11:56:04.651Z","level":"ERROR","service":"BillingService","message":"Invalid correlation token - no attempt found","requestId":"bill_895797ed-33a5-407e-baf4-abc36bfd1236_min8_1758369364644","correlation_token":"transcript-1758368943088-kinj7cr70","conversation_id":"895797ed-33a5-407e-baf4-abc36bfd1236"}
{"timestamp":"2025-09-20T11:57:31.765164","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_53a8d897-a171-4ebc-9821-89086d939d0a_min1_1758369451773","correlation_token":"transcript-1758369389402-ypypj5ahv","conversation_id":"53a8d897-a171-4ebc-9821-89086d939d0a","minute":1,"metrics_total_requests":3}
{"timestamp":"2025-09-20T11:57:31.773Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_53a8d897-a171-4ebc-9821-89086d939d0a_min1_1758369451773","correlation_token":"transcript-1758369389402-ypypj5ahv"}
{"timestamp":"2025-09-20T11:57:31.781Z","level":"ERROR","service":"BillingService","message":"Invalid correlation token - no attempt found","requestId":"bill_53a8d897-a171-4ebc-9821-89086d939d0a_min1_1758369451773","correlation_token":"transcript-1758369389402-ypypj5ahv","conversation_id":"53a8d897-a171-4ebc-9821-89086d939d0a"}
{"timestamp":"2025-09-20T11:57:31.782775","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_53a8d897-a171-4ebc-9821-89086d939d0a_min2_1758369451784","correlation_token":"transcript-1758369389402-ypypj5ahv","conversation_id":"53a8d897-a171-4ebc-9821-89086d939d0a","minute":2,"metrics_total_requests":4}
{"timestamp":"2025-09-20T11:57:31.784Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_53a8d897-a171-4ebc-9821-89086d939d0a_min2_1758369451784","correlation_token":"transcript-1758369389402-ypypj5ahv"}
{"timestamp":"2025-09-20T11:57:31.788Z","level":"ERROR","service":"BillingService","message":"Invalid correlation token - no attempt found","requestId":"bill_53a8d897-a171-4ebc-9821-89086d939d0a_min2_1758369451784","correlation_token":"transcript-1758369389402-ypypj5ahv","conversation_id":"53a8d897-a171-4ebc-9821-89086d939d0a"}
{"timestamp":"2025-09-20T11:58:18.613379","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_8b1e4e06-ee6a-49c3-9fab-f84203a51d0f_min1_1758369498615","correlation_token":"transcript-1758369437392-791iwmalz","conversation_id":"8b1e4e06-ee6a-49c3-9fab-f84203a51d0f","minute":1,"metrics_total_requests":5}
{"timestamp":"2025-09-20T11:58:18.615Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_8b1e4e06-ee6a-49c3-9fab-f84203a51d0f_min1_1758369498615","correlation_token":"transcript-1758369437392-791iwmalz"}
{"timestamp":"2025-09-20T11:58:18.624Z","level":"ERROR","service":"BillingService","message":"Invalid correlation token - no attempt found","requestId":"bill_8b1e4e06-ee6a-49c3-9fab-f84203a51d0f_min1_1758369498615","correlation_token":"transcript-1758369437392-791iwmalz","conversation_id":"8b1e4e06-ee6a-49c3-9fab-f84203a51d0f"}
{"timestamp":"2025-09-20T11:58:18.625739","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_8b1e4e06-ee6a-49c3-9fab-f84203a51d0f_min2_1758369498628","correlation_token":"transcript-1758369437392-791iwmalz","conversation_id":"8b1e4e06-ee6a-49c3-9fab-f84203a51d0f","minute":2,"metrics_total_requests":6}
{"timestamp":"2025-09-20T11:58:18.628Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_8b1e4e06-ee6a-49c3-9fab-f84203a51d0f_min2_1758369498628","correlation_token":"transcript-1758369437392-791iwmalz"}
{"timestamp":"2025-09-20T11:58:18.632Z","level":"ERROR","service":"BillingService","message":"Invalid correlation token - no attempt found","requestId":"bill_8b1e4e06-ee6a-49c3-9fab-f84203a51d0f_min2_1758369498628","correlation_token":"transcript-1758369437392-791iwmalz","conversation_id":"8b1e4e06-ee6a-49c3-9fab-f84203a51d0f"}
{"timestamp":"2025-09-20T12:01:30.625262","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_6c24bc16-f8ff-46b0-b0a8-d4f2a6740d79_min1_1758369690629","correlation_token":"transcript-1758369628826-y132dq1k9","conversation_id":"6c24bc16-f8ff-46b0-b0a8-d4f2a6740d79","minute":1,"metrics_total_requests":7}
{"timestamp":"2025-09-20T12:01:30.629Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_6c24bc16-f8ff-46b0-b0a8-d4f2a6740d79_min1_1758369690629","correlation_token":"transcript-1758369628826-y132dq1k9"}
{"timestamp":"2025-09-20T12:01:30.635Z","level":"ERROR","service":"BillingService","message":"Invalid correlation token - no attempt found","requestId":"bill_6c24bc16-f8ff-46b0-b0a8-d4f2a6740d79_min1_1758369690629","correlation_token":"transcript-1758369628826-y132dq1k9","conversation_id":"6c24bc16-f8ff-46b0-b0a8-d4f2a6740d79"}
{"timestamp":"2025-09-20T12:01:30.637177","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_6c24bc16-f8ff-46b0-b0a8-d4f2a6740d79_min2_1758369690638","correlation_token":"transcript-1758369628826-y132dq1k9","conversation_id":"6c24bc16-f8ff-46b0-b0a8-d4f2a6740d79","minute":2,"metrics_total_requests":8}
{"timestamp":"2025-09-20T12:01:30.638Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_6c24bc16-f8ff-46b0-b0a8-d4f2a6740d79_min2_1758369690638","correlation_token":"transcript-1758369628826-y132dq1k9"}
{"timestamp":"2025-09-20T12:01:30.642Z","level":"ERROR","service":"BillingService","message":"Invalid correlation token - no attempt found","requestId":"bill_6c24bc16-f8ff-46b0-b0a8-d4f2a6740d79_min2_1758369690638","correlation_token":"transcript-1758369628826-y132dq1k9","conversation_id":"6c24bc16-f8ff-46b0-b0a8-d4f2a6740d79"}
{"timestamp":"2025-09-20T12:01:47.481032","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_32a77db9-134e-43bf-bd17-dc15298b5e71_min1_1758369707492","correlation_token":"transcript-1758369644655-pij2v79bw","conversation_id":"32a77db9-134e-43bf-bd17-dc15298b5e71","minute":1,"metrics_total_requests":9}
{"timestamp":"2025-09-20T12:01:47.492Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_32a77db9-134e-43bf-bd17-dc15298b5e71_min1_1758369707492","correlation_token":"transcript-1758369644655-pij2v79bw"}
{"timestamp":"2025-09-20T12:01:47.512Z","level":"ERROR","service":"BillingService","message":"Invalid correlation token - no attempt found","requestId":"bill_32a77db9-134e-43bf-bd17-dc15298b5e71_min1_1758369707492","correlation_token":"transcript-1758369644655-pij2v79bw","conversation_id":"32a77db9-134e-43bf-bd17-dc15298b5e71"}
{"timestamp":"2025-09-20T12:01:47.514792","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_32a77db9-134e-43bf-bd17-dc15298b5e71_min2_1758369707516","correlation_token":"transcript-1758369644655-pij2v79bw","conversation_id":"32a77db9-134e-43bf-bd17-dc15298b5e71","minute":2,"metrics_total_requests":10}
{"timestamp":"2025-09-20T12:01:47.516Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_32a77db9-134e-43bf-bd17-dc15298b5e71_min2_1758369707516","correlation_token":"transcript-1758369644655-pij2v79bw"}
{"timestamp":"2025-09-20T12:01:47.521Z","level":"ERROR","service":"BillingService","message":"Invalid correlation token - no attempt found","requestId":"bill_32a77db9-134e-43bf-bd17-dc15298b5e71_min2_1758369707516","correlation_token":"transcript-1758369644655-pij2v79bw","conversation_id":"32a77db9-134e-43bf-bd17-dc15298b5e71"}
{"timestamp":"2025-09-20T12:05:12.359001","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min1_1758369912369","correlation_token":"sim_9f45b0f5d4509403eb6ac3ca0713584c_1758369613612","conversation_id":"75432d49-dd97-4171-a099-1fa5e0f6c1d2","minute":1,"metrics_total_requests":11}
{"timestamp":"2025-09-20T12:05:12.370Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min1_1758369912369","correlation_token":"sim_9f45b0f5d4509403eb6ac3ca0713584c_1758369613612"}
{"timestamp":"2025-09-20T12:05:12.398Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min1_1758369912369","minute_requested":1,"minutes_already_billed":0,"attempt_id":"6d431a57-6e41-45f1-8a0d-a65eddb78aea"}
{"timestamp":"2025-09-20T12:05:12.398Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min1_1758369912369","attempt_id":"6d431a57-6e41-45f1-8a0d-a65eddb78aea","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":7,"minutes_already_billed":0,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-20T12:05:12.399Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min1_1758369912369","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":7,"expected_balance_after":6,"minute_to_bill":1}
{"timestamp":"2025-09-20T12:05:12.407Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min1_1758369912369","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-20T12:05:12.411Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min1_1758369912369","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":7,"new_balance":6,"change":-1}
{"timestamp":"2025-09-20T12:05:12.411Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min1_1758369912369","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":6,"minute":1}
{"timestamp":"2025-09-20T12:05:12.415Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min1_1758369912369","transaction_id":"8203dc7e-2c7d-46c5-a386-ed7bf1765568","transaction_type":"DEBIT","balance_after":6}
{"timestamp":"2025-09-20T12:05:12.415Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min1_1758369912369","attempt_id":"6d431a57-6e41-45f1-8a0d-a65eddb78aea","new_minutes_billed":1,"new_duration_seconds":60}
{"timestamp":"2025-09-20T12:05:12.418Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min1_1758369912369","attempt_id":"6d431a57-6e41-45f1-8a0d-a65eddb78aea","minutes_billed":1}
{"timestamp":"2025-09-20T12:05:12.421Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min1_1758369912369","transaction_duration_ms":22,"new_balance":6,"minute_billed":1,"total_minutes_billed_this_attempt":1,"total_successful":1,"total_minutes_billed_all_time":1,"avg_transaction_time":"22.00"}
{"timestamp":"2025-09-20T12:05:12.421Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min1_1758369912369","total_duration_ms":52,"transaction_duration_ms":22,"response":{"status":"continue","creditsRemaining":6,"minuteBilled":1,"totalMinutesBilled":1,"attemptId":"6d431a57-6e41-45f1-8a0d-a65eddb78aea","shouldTerminate":false}}
{"timestamp":"2025-09-20T12:06:12.424825","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min2_1758369972432","correlation_token":"sim_9f45b0f5d4509403eb6ac3ca0713584c_1758369613612","conversation_id":"75432d49-dd97-4171-a099-1fa5e0f6c1d2","minute":2,"metrics_total_requests":12}
{"timestamp":"2025-09-20T12:06:12.433Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min2_1758369972432","correlation_token":"sim_9f45b0f5d4509403eb6ac3ca0713584c_1758369613612"}
{"timestamp":"2025-09-20T12:06:12.446Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min2_1758369972432","minute_requested":2,"minutes_already_billed":1,"attempt_id":"6d431a57-6e41-45f1-8a0d-a65eddb78aea"}
{"timestamp":"2025-09-20T12:06:12.446Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min2_1758369972432","attempt_id":"6d431a57-6e41-45f1-8a0d-a65eddb78aea","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":6,"minutes_already_billed":1,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-20T12:06:12.446Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min2_1758369972432","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":6,"expected_balance_after":5,"minute_to_bill":2}
{"timestamp":"2025-09-20T12:06:12.450Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min2_1758369972432","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-20T12:06:12.453Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min2_1758369972432","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":6,"new_balance":5,"change":-1}
{"timestamp":"2025-09-20T12:06:12.453Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min2_1758369972432","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":5,"minute":2}
{"timestamp":"2025-09-20T12:06:12.456Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min2_1758369972432","transaction_id":"118fc69d-f19c-4d10-a2d4-2073878e89bb","transaction_type":"DEBIT","balance_after":5}
{"timestamp":"2025-09-20T12:06:12.456Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min2_1758369972432","attempt_id":"6d431a57-6e41-45f1-8a0d-a65eddb78aea","new_minutes_billed":2,"new_duration_seconds":120}
{"timestamp":"2025-09-20T12:06:12.459Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min2_1758369972432","attempt_id":"6d431a57-6e41-45f1-8a0d-a65eddb78aea","minutes_billed":2}
{"timestamp":"2025-09-20T12:06:12.461Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min2_1758369972432","transaction_duration_ms":15,"new_balance":5,"minute_billed":2,"total_minutes_billed_this_attempt":2,"total_successful":2,"total_minutes_billed_all_time":2,"avg_transaction_time":"18.50"}
{"timestamp":"2025-09-20T12:06:12.461Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min2_1758369972432","total_duration_ms":29,"transaction_duration_ms":15,"response":{"status":"continue","creditsRemaining":5,"minuteBilled":2,"totalMinutesBilled":2,"attemptId":"6d431a57-6e41-45f1-8a0d-a65eddb78aea","shouldTerminate":false}}
{"timestamp":"2025-09-20T12:07:12.463217","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min3_1758370032466","correlation_token":"sim_9f45b0f5d4509403eb6ac3ca0713584c_1758369613612","conversation_id":"75432d49-dd97-4171-a099-1fa5e0f6c1d2","minute":3,"metrics_total_requests":13}
{"timestamp":"2025-09-20T12:07:12.466Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min3_1758370032466","correlation_token":"sim_9f45b0f5d4509403eb6ac3ca0713584c_1758369613612"}
{"timestamp":"2025-09-20T12:07:12.475Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min3_1758370032466","minute_requested":3,"minutes_already_billed":2,"attempt_id":"6d431a57-6e41-45f1-8a0d-a65eddb78aea"}
{"timestamp":"2025-09-20T12:07:12.475Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min3_1758370032466","attempt_id":"6d431a57-6e41-45f1-8a0d-a65eddb78aea","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":5,"minutes_already_billed":2,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-20T12:07:12.475Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min3_1758370032466","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":5,"expected_balance_after":4,"minute_to_bill":3}
{"timestamp":"2025-09-20T12:07:12.478Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min3_1758370032466","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-20T12:07:12.480Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min3_1758370032466","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":5,"new_balance":4,"change":-1}
{"timestamp":"2025-09-20T12:07:12.480Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min3_1758370032466","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":4,"minute":3}
{"timestamp":"2025-09-20T12:07:12.483Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min3_1758370032466","transaction_id":"52038916-4fe2-49a5-8570-e76ca206b819","transaction_type":"DEBIT","balance_after":4}
{"timestamp":"2025-09-20T12:07:12.483Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min3_1758370032466","attempt_id":"6d431a57-6e41-45f1-8a0d-a65eddb78aea","new_minutes_billed":3,"new_duration_seconds":180}
{"timestamp":"2025-09-20T12:07:12.485Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min3_1758370032466","attempt_id":"6d431a57-6e41-45f1-8a0d-a65eddb78aea","minutes_billed":3}
{"timestamp":"2025-09-20T12:07:12.486Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min3_1758370032466","transaction_duration_ms":11,"new_balance":4,"minute_billed":3,"total_minutes_billed_this_attempt":3,"total_successful":3,"total_minutes_billed_all_time":3,"avg_transaction_time":"16.00"}
{"timestamp":"2025-09-20T12:07:12.486Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min3_1758370032466","total_duration_ms":20,"transaction_duration_ms":11,"response":{"status":"continue","creditsRemaining":4,"minuteBilled":3,"totalMinutesBilled":3,"attemptId":"6d431a57-6e41-45f1-8a0d-a65eddb78aea","shouldTerminate":false}}
{"timestamp":"2025-09-20T12:19:00.412618","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min4_1758370740453","correlation_token":"sim_9f45b0f5d4509403eb6ac3ca0713584c_1758369613612","conversation_id":"75432d49-dd97-4171-a099-1fa5e0f6c1d2","minute":4,"metrics_total_requests":14}
{"timestamp":"2025-09-20T12:19:00.453Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min4_1758370740453","correlation_token":"sim_9f45b0f5d4509403eb6ac3ca0713584c_1758369613612"}
{"timestamp":"2025-09-20T12:19:00.471Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min4_1758370740453","minute_requested":4,"minutes_already_billed":3,"attempt_id":"6d431a57-6e41-45f1-8a0d-a65eddb78aea"}
{"timestamp":"2025-09-20T12:19:00.471Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min4_1758370740453","attempt_id":"6d431a57-6e41-45f1-8a0d-a65eddb78aea","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":4,"minutes_already_billed":3,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-20T12:19:00.471Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min4_1758370740453","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":4,"expected_balance_after":3,"minute_to_bill":4}
{"timestamp":"2025-09-20T12:19:00.476Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min4_1758370740453","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-20T12:19:00.480Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min4_1758370740453","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":4,"new_balance":3,"change":-1}
{"timestamp":"2025-09-20T12:19:00.480Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min4_1758370740453","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":3,"minute":4}
{"timestamp":"2025-09-20T12:19:00.483Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min4_1758370740453","transaction_id":"405e9eb2-a3b3-484a-8544-4285911b84a0","transaction_type":"DEBIT","balance_after":3}
{"timestamp":"2025-09-20T12:19:00.483Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min4_1758370740453","attempt_id":"6d431a57-6e41-45f1-8a0d-a65eddb78aea","new_minutes_billed":4,"new_duration_seconds":240}
{"timestamp":"2025-09-20T12:19:00.485Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min4_1758370740453","attempt_id":"6d431a57-6e41-45f1-8a0d-a65eddb78aea","minutes_billed":4}
{"timestamp":"2025-09-20T12:19:00.550Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min4_1758370740453","transaction_duration_ms":79,"new_balance":3,"minute_billed":4,"total_minutes_billed_this_attempt":4,"total_successful":4,"total_minutes_billed_all_time":4,"avg_transaction_time":"31.75"}
{"timestamp":"2025-09-20T12:19:00.550Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min4_1758370740453","total_duration_ms":97,"transaction_duration_ms":79,"response":{"status":"continue","creditsRemaining":3,"minuteBilled":4,"totalMinutesBilled":4,"attemptId":"6d431a57-6e41-45f1-8a0d-a65eddb78aea","shouldTerminate":false}}
{"timestamp":"2025-09-20T12:19:05.840826","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min15_1758370745843","correlation_token":"sim_9f45b0f5d4509403eb6ac3ca0713584c_1758369613612","conversation_id":"75432d49-dd97-4171-a099-1fa5e0f6c1d2","minute":15,"metrics_total_requests":15}
{"timestamp":"2025-09-20T12:19:05.843Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min15_1758370745843","correlation_token":"sim_9f45b0f5d4509403eb6ac3ca0713584c_1758369613612"}
{"timestamp":"2025-09-20T12:19:05.853Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min15_1758370745843","minute_requested":15,"minutes_already_billed":4,"attempt_id":"6d431a57-6e41-45f1-8a0d-a65eddb78aea"}
{"timestamp":"2025-09-20T12:19:05.853Z","level":"WARN","service":"BillingService","message":"Non-sequential minute billing detected","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min15_1758370745843","minute_requested":15,"expected_minute":5,"gap":10,"attempt_id":"6d431a57-6e41-45f1-8a0d-a65eddb78aea"}
{"timestamp":"2025-09-20T12:19:05.853Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min15_1758370745843","attempt_id":"6d431a57-6e41-45f1-8a0d-a65eddb78aea","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":3,"minutes_already_billed":4,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-20T12:19:05.853Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min15_1758370745843","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":3,"expected_balance_after":2,"minute_to_bill":15}
{"timestamp":"2025-09-20T12:19:05.856Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min15_1758370745843","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-20T12:19:05.858Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min15_1758370745843","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":3,"new_balance":2,"change":-1}
{"timestamp":"2025-09-20T12:19:05.858Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min15_1758370745843","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":2,"minute":15}
{"timestamp":"2025-09-20T12:19:05.862Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min15_1758370745843","transaction_id":"f0d3c6c9-ee40-41df-be1a-787360a84641","transaction_type":"DEBIT","balance_after":2}
{"timestamp":"2025-09-20T12:19:05.862Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min15_1758370745843","attempt_id":"6d431a57-6e41-45f1-8a0d-a65eddb78aea","new_minutes_billed":15,"new_duration_seconds":900}
{"timestamp":"2025-09-20T12:19:05.865Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min15_1758370745843","attempt_id":"6d431a57-6e41-45f1-8a0d-a65eddb78aea","minutes_billed":15}
{"timestamp":"2025-09-20T12:19:05.866Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min15_1758370745843","transaction_duration_ms":13,"new_balance":2,"minute_billed":15,"total_minutes_billed_this_attempt":15,"total_successful":5,"total_minutes_billed_all_time":5,"avg_transaction_time":"28.00"}
{"timestamp":"2025-09-20T12:19:05.867Z","level":"WARN","service":"BillingService","message":"Low credits warning threshold reached","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min15_1758370745843","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","credits_remaining":2,"minute_billed":15,"warning_threshold":2}
{"timestamp":"2025-09-20T12:19:05.867Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_75432d49-dd97-4171-a099-1fa5e0f6c1d2_min15_1758370745843","total_duration_ms":24,"transaction_duration_ms":13,"response":{"status":"warning","creditsRemaining":2,"minuteBilled":15,"totalMinutesBilled":15,"attemptId":"6d431a57-6e41-45f1-8a0d-a65eddb78aea","shouldTerminate":false,"message":"Low credits warning: 2 minute(s) remaining"}}
{"timestamp":"2025-09-20T12:30:18.427874","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_852e4f52-2171-47ac-ab99-8cc0726ef3c4_min1_1758371418431","correlation_token":"sim_8a52901bfb30afe73bdfd30b7bc6c7f4_1758371324268","conversation_id":"852e4f52-2171-47ac-ab99-8cc0726ef3c4","minute":1,"metrics_total_requests":16}
{"timestamp":"2025-09-20T12:30:18.431Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_852e4f52-2171-47ac-ab99-8cc0726ef3c4_min1_1758371418431","correlation_token":"sim_8a52901bfb30afe73bdfd30b7bc6c7f4_1758371324268"}
{"timestamp":"2025-09-20T12:30:18.439Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_852e4f52-2171-47ac-ab99-8cc0726ef3c4_min1_1758371418431","minute_requested":1,"minutes_already_billed":0,"attempt_id":"aef115f7-eceb-44a3-831f-37806fbbbcc7"}
{"timestamp":"2025-09-20T12:30:18.439Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_852e4f52-2171-47ac-ab99-8cc0726ef3c4_min1_1758371418431","attempt_id":"aef115f7-eceb-44a3-831f-37806fbbbcc7","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":2,"minutes_already_billed":0,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-20T12:30:18.439Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_852e4f52-2171-47ac-ab99-8cc0726ef3c4_min1_1758371418431","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":2,"expected_balance_after":1,"minute_to_bill":1}
{"timestamp":"2025-09-20T12:30:18.442Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_852e4f52-2171-47ac-ab99-8cc0726ef3c4_min1_1758371418431","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-20T12:30:18.444Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_852e4f52-2171-47ac-ab99-8cc0726ef3c4_min1_1758371418431","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":2,"new_balance":1,"change":-1}
{"timestamp":"2025-09-20T12:30:18.444Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_852e4f52-2171-47ac-ab99-8cc0726ef3c4_min1_1758371418431","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":1,"minute":1}
{"timestamp":"2025-09-20T12:30:18.446Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_852e4f52-2171-47ac-ab99-8cc0726ef3c4_min1_1758371418431","transaction_id":"3415a346-1d21-478c-875a-a8ae2a12a524","transaction_type":"DEBIT","balance_after":1}
{"timestamp":"2025-09-20T12:30:18.446Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_852e4f52-2171-47ac-ab99-8cc0726ef3c4_min1_1758371418431","attempt_id":"aef115f7-eceb-44a3-831f-37806fbbbcc7","new_minutes_billed":1,"new_duration_seconds":60}
{"timestamp":"2025-09-20T12:30:18.448Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_852e4f52-2171-47ac-ab99-8cc0726ef3c4_min1_1758371418431","attempt_id":"aef115f7-eceb-44a3-831f-37806fbbbcc7","minutes_billed":1}
{"timestamp":"2025-09-20T12:30:18.450Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_852e4f52-2171-47ac-ab99-8cc0726ef3c4_min1_1758371418431","transaction_duration_ms":11,"new_balance":1,"minute_billed":1,"total_minutes_billed_this_attempt":1,"total_successful":6,"total_minutes_billed_all_time":6,"avg_transaction_time":"25.17"}
{"timestamp":"2025-09-20T12:30:18.450Z","level":"WARN","service":"BillingService","message":"Low credits warning threshold reached","requestId":"bill_852e4f52-2171-47ac-ab99-8cc0726ef3c4_min1_1758371418431","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","credits_remaining":1,"minute_billed":1,"warning_threshold":2}
{"timestamp":"2025-09-20T12:30:18.450Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_852e4f52-2171-47ac-ab99-8cc0726ef3c4_min1_1758371418431","total_duration_ms":19,"transaction_duration_ms":11,"response":{"status":"warning","creditsRemaining":1,"minuteBilled":1,"totalMinutesBilled":1,"attemptId":"aef115f7-eceb-44a3-831f-37806fbbbcc7","shouldTerminate":false,"message":"Low credits warning: 1 minute(s) remaining"}}
{"timestamp":"2025-09-20T12:31:18.454147","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_852e4f52-2171-47ac-ab99-8cc0726ef3c4_min2_1758371478460","correlation_token":"sim_8a52901bfb30afe73bdfd30b7bc6c7f4_1758371324268","conversation_id":"852e4f52-2171-47ac-ab99-8cc0726ef3c4","minute":2,"metrics_total_requests":17}
{"timestamp":"2025-09-20T12:31:18.461Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_852e4f52-2171-47ac-ab99-8cc0726ef3c4_min2_1758371478460","correlation_token":"sim_8a52901bfb30afe73bdfd30b7bc6c7f4_1758371324268"}
{"timestamp":"2025-09-20T12:31:18.473Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_852e4f52-2171-47ac-ab99-8cc0726ef3c4_min2_1758371478460","minute_requested":2,"minutes_already_billed":1,"attempt_id":"aef115f7-eceb-44a3-831f-37806fbbbcc7"}
{"timestamp":"2025-09-20T12:31:18.473Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_852e4f52-2171-47ac-ab99-8cc0726ef3c4_min2_1758371478460","attempt_id":"aef115f7-eceb-44a3-831f-37806fbbbcc7","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":1,"minutes_already_billed":1,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-20T12:31:18.473Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_852e4f52-2171-47ac-ab99-8cc0726ef3c4_min2_1758371478460","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":1,"expected_balance_after":0,"minute_to_bill":2}
{"timestamp":"2025-09-20T12:31:18.479Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_852e4f52-2171-47ac-ab99-8cc0726ef3c4_min2_1758371478460","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-20T12:31:18.481Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_852e4f52-2171-47ac-ab99-8cc0726ef3c4_min2_1758371478460","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":1,"new_balance":0,"change":-1}
{"timestamp":"2025-09-20T12:31:18.481Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_852e4f52-2171-47ac-ab99-8cc0726ef3c4_min2_1758371478460","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":0,"minute":2}
{"timestamp":"2025-09-20T12:31:18.484Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_852e4f52-2171-47ac-ab99-8cc0726ef3c4_min2_1758371478460","transaction_id":"22c3122f-7147-4795-95ba-98ecc2729b60","transaction_type":"DEBIT","balance_after":0}
{"timestamp":"2025-09-20T12:31:18.484Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_852e4f52-2171-47ac-ab99-8cc0726ef3c4_min2_1758371478460","attempt_id":"aef115f7-eceb-44a3-831f-37806fbbbcc7","new_minutes_billed":2,"new_duration_seconds":120}
{"timestamp":"2025-09-20T12:31:18.486Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_852e4f52-2171-47ac-ab99-8cc0726ef3c4_min2_1758371478460","attempt_id":"aef115f7-eceb-44a3-831f-37806fbbbcc7","minutes_billed":2}
{"timestamp":"2025-09-20T12:31:18.488Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_852e4f52-2171-47ac-ab99-8cc0726ef3c4_min2_1758371478460","transaction_duration_ms":15,"new_balance":0,"minute_billed":2,"total_minutes_billed_this_attempt":2,"total_successful":7,"total_minutes_billed_all_time":7,"avg_transaction_time":"23.71"}
{"timestamp":"2025-09-20T12:31:18.488Z","level":"WARN","service":"BillingService","message":"Last credit used - will terminate conversation","requestId":"bill_852e4f52-2171-47ac-ab99-8cc0726ef3c4_min2_1758371478460","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","minute_billed":2,"total_minutes_this_session":2}
{"timestamp":"2025-09-20T12:31:18.488Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_852e4f52-2171-47ac-ab99-8cc0726ef3c4_min2_1758371478460","total_duration_ms":28,"transaction_duration_ms":15,"response":{"status":"terminate","creditsRemaining":0,"minuteBilled":2,"totalMinutesBilled":2,"attemptId":"aef115f7-eceb-44a3-831f-37806fbbbcc7","shouldTerminate":true,"message":"Last credit used - conversation will end","gracePeriodSeconds":60}}
{"timestamp":"2025-09-20T12:32:18.498793","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_852e4f52-2171-47ac-ab99-8cc0726ef3c4_min4_1758371538506","correlation_token":"sim_8a52901bfb30afe73bdfd30b7bc6c7f4_1758371324268","conversation_id":"852e4f52-2171-47ac-ab99-8cc0726ef3c4","minute":4,"metrics_total_requests":18}
{"timestamp":"2025-09-20T12:32:18.506Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_852e4f52-2171-47ac-ab99-8cc0726ef3c4_min4_1758371538506","correlation_token":"sim_8a52901bfb30afe73bdfd30b7bc6c7f4_1758371324268"}
{"timestamp":"2025-09-20T12:32:18.519Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_852e4f52-2171-47ac-ab99-8cc0726ef3c4_min4_1758371538506","minute_requested":4,"minutes_already_billed":2,"attempt_id":"aef115f7-eceb-44a3-831f-37806fbbbcc7"}
{"timestamp":"2025-09-20T12:32:18.519Z","level":"WARN","service":"BillingService","message":"Non-sequential minute billing detected","requestId":"bill_852e4f52-2171-47ac-ab99-8cc0726ef3c4_min4_1758371538506","minute_requested":4,"expected_minute":3,"gap":1,"attempt_id":"aef115f7-eceb-44a3-831f-37806fbbbcc7"}
{"timestamp":"2025-09-20T12:32:18.519Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_852e4f52-2171-47ac-ab99-8cc0726ef3c4_min4_1758371538506","attempt_id":"aef115f7-eceb-44a3-831f-37806fbbbcc7","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":0,"minutes_already_billed":2,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-20T12:32:18.519Z","level":"WARN","service":"BillingService","message":"Insufficient credits detected","requestId":"bill_852e4f52-2171-47ac-ab99-8cc0726ef3c4_min4_1758371538506","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_email":"john.doe@example.com","current_balance":0,"required":1,"minutes_billed":2,"total_insufficient_events":1}
{"timestamp":"2025-09-20T13:01:54.701329","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min1_1758373314707","correlation_token":"sim_909c4aa76664333dbd33add873591bca_1758373233161","conversation_id":"2f51cb14-306b-498d-be37-efe1deef93e7","minute":1,"metrics_total_requests":19}
{"timestamp":"2025-09-20T13:01:54.707Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min1_1758373314707","correlation_token":"sim_909c4aa76664333dbd33add873591bca_1758373233161"}
{"timestamp":"2025-09-20T13:01:54.723Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min1_1758373314707","minute_requested":1,"minutes_already_billed":0,"attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994"}
{"timestamp":"2025-09-20T13:01:54.723Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min1_1758373314707","attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":10,"minutes_already_billed":0,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-20T13:01:54.723Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min1_1758373314707","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":10,"expected_balance_after":9,"minute_to_bill":1}
{"timestamp":"2025-09-20T13:01:54.727Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min1_1758373314707","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-20T13:01:54.730Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min1_1758373314707","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":10,"new_balance":9,"change":-1}
{"timestamp":"2025-09-20T13:01:54.730Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min1_1758373314707","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":9,"minute":1}
{"timestamp":"2025-09-20T13:01:54.733Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min1_1758373314707","transaction_id":"fe404b7d-ef34-437d-bcc3-ce5f8cff3875","transaction_type":"DEBIT","balance_after":9}
{"timestamp":"2025-09-20T13:01:54.733Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min1_1758373314707","attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994","new_minutes_billed":1,"new_duration_seconds":60}
{"timestamp":"2025-09-20T13:01:54.735Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min1_1758373314707","attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994","minutes_billed":1}
{"timestamp":"2025-09-20T13:01:54.738Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min1_1758373314707","transaction_duration_ms":15,"new_balance":9,"minute_billed":1,"total_minutes_billed_this_attempt":1,"total_successful":8,"total_minutes_billed_all_time":8,"avg_transaction_time":"22.63"}
{"timestamp":"2025-09-20T13:01:54.738Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min1_1758373314707","total_duration_ms":31,"transaction_duration_ms":15,"response":{"status":"continue","creditsRemaining":9,"minuteBilled":1,"totalMinutesBilled":1,"attemptId":"1598f8e1-be6c-475c-a76d-9412a5ce9994","shouldTerminate":false}}
{"timestamp":"2025-09-20T13:02:54.747275","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min2_1758373374754","correlation_token":"sim_909c4aa76664333dbd33add873591bca_1758373233161","conversation_id":"2f51cb14-306b-498d-be37-efe1deef93e7","minute":2,"metrics_total_requests":20}
{"timestamp":"2025-09-20T13:02:54.754Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min2_1758373374754","correlation_token":"sim_909c4aa76664333dbd33add873591bca_1758373233161"}
{"timestamp":"2025-09-20T13:02:54.766Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min2_1758373374754","minute_requested":2,"minutes_already_billed":1,"attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994"}
{"timestamp":"2025-09-20T13:02:54.766Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min2_1758373374754","attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":9,"minutes_already_billed":1,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-20T13:02:54.766Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min2_1758373374754","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":9,"expected_balance_after":8,"minute_to_bill":2}
{"timestamp":"2025-09-20T13:02:54.772Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min2_1758373374754","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-20T13:02:54.775Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min2_1758373374754","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":9,"new_balance":8,"change":-1}
{"timestamp":"2025-09-20T13:02:54.775Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min2_1758373374754","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":8,"minute":2}
{"timestamp":"2025-09-20T13:02:54.778Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min2_1758373374754","transaction_id":"5d422cf6-ae98-4e9d-82ec-85bdb828f3ab","transaction_type":"DEBIT","balance_after":8}
{"timestamp":"2025-09-20T13:02:54.778Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min2_1758373374754","attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994","new_minutes_billed":2,"new_duration_seconds":120}
{"timestamp":"2025-09-20T13:02:54.780Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min2_1758373374754","attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994","minutes_billed":2}
{"timestamp":"2025-09-20T13:02:54.781Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min2_1758373374754","transaction_duration_ms":15,"new_balance":8,"minute_billed":2,"total_minutes_billed_this_attempt":2,"total_successful":9,"total_minutes_billed_all_time":9,"avg_transaction_time":"21.78"}
{"timestamp":"2025-09-20T13:02:54.781Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min2_1758373374754","total_duration_ms":27,"transaction_duration_ms":15,"response":{"status":"continue","creditsRemaining":8,"minuteBilled":2,"totalMinutesBilled":2,"attemptId":"1598f8e1-be6c-475c-a76d-9412a5ce9994","shouldTerminate":false}}
{"timestamp":"2025-09-20T13:03:54.794419","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min3_1758373434799","correlation_token":"sim_909c4aa76664333dbd33add873591bca_1758373233161","conversation_id":"2f51cb14-306b-498d-be37-efe1deef93e7","minute":3,"metrics_total_requests":21}
{"timestamp":"2025-09-20T13:03:54.799Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min3_1758373434799","correlation_token":"sim_909c4aa76664333dbd33add873591bca_1758373233161"}
{"timestamp":"2025-09-20T13:03:54.813Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min3_1758373434799","minute_requested":3,"minutes_already_billed":2,"attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994"}
{"timestamp":"2025-09-20T13:03:54.813Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min3_1758373434799","attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":8,"minutes_already_billed":2,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-20T13:03:54.813Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min3_1758373434799","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":8,"expected_balance_after":7,"minute_to_bill":3}
{"timestamp":"2025-09-20T13:03:54.818Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min3_1758373434799","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-20T13:03:54.820Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min3_1758373434799","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":8,"new_balance":7,"change":-1}
{"timestamp":"2025-09-20T13:03:54.820Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min3_1758373434799","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":7,"minute":3}
{"timestamp":"2025-09-20T13:03:54.823Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min3_1758373434799","transaction_id":"1d88d792-7414-4208-8daa-39c4e8987d46","transaction_type":"DEBIT","balance_after":7}
{"timestamp":"2025-09-20T13:03:54.823Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min3_1758373434799","attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994","new_minutes_billed":3,"new_duration_seconds":180}
{"timestamp":"2025-09-20T13:03:54.825Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min3_1758373434799","attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994","minutes_billed":3}
{"timestamp":"2025-09-20T13:03:54.827Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min3_1758373434799","transaction_duration_ms":14,"new_balance":7,"minute_billed":3,"total_minutes_billed_this_attempt":3,"total_successful":10,"total_minutes_billed_all_time":10,"avg_transaction_time":"21.00"}
{"timestamp":"2025-09-20T13:03:54.827Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min3_1758373434799","total_duration_ms":28,"transaction_duration_ms":14,"response":{"status":"continue","creditsRemaining":7,"minuteBilled":3,"totalMinutesBilled":3,"attemptId":"1598f8e1-be6c-475c-a76d-9412a5ce9994","shouldTerminate":false}}
{"timestamp":"2025-09-20T13:04:54.832422","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min4_1758373494838","correlation_token":"sim_909c4aa76664333dbd33add873591bca_1758373233161","conversation_id":"2f51cb14-306b-498d-be37-efe1deef93e7","minute":4,"metrics_total_requests":22}
{"timestamp":"2025-09-20T13:04:54.838Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min4_1758373494838","correlation_token":"sim_909c4aa76664333dbd33add873591bca_1758373233161"}
{"timestamp":"2025-09-20T13:04:54.856Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min4_1758373494838","minute_requested":4,"minutes_already_billed":3,"attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994"}
{"timestamp":"2025-09-20T13:04:54.856Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min4_1758373494838","attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":7,"minutes_already_billed":3,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-20T13:04:54.856Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min4_1758373494838","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":7,"expected_balance_after":6,"minute_to_bill":4}
{"timestamp":"2025-09-20T13:04:54.862Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min4_1758373494838","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-20T13:04:54.867Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min4_1758373494838","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":7,"new_balance":6,"change":-1}
{"timestamp":"2025-09-20T13:04:54.867Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min4_1758373494838","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":6,"minute":4}
{"timestamp":"2025-09-20T13:04:54.870Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min4_1758373494838","transaction_id":"40395fb0-b437-4b6d-9221-62b94f2bb47c","transaction_type":"DEBIT","balance_after":6}
{"timestamp":"2025-09-20T13:04:54.871Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min4_1758373494838","attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994","new_minutes_billed":4,"new_duration_seconds":240}
{"timestamp":"2025-09-20T13:04:54.873Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min4_1758373494838","attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994","minutes_billed":4}
{"timestamp":"2025-09-20T13:04:54.875Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min4_1758373494838","transaction_duration_ms":19,"new_balance":6,"minute_billed":4,"total_minutes_billed_this_attempt":4,"total_successful":11,"total_minutes_billed_all_time":11,"avg_transaction_time":"20.82"}
{"timestamp":"2025-09-20T13:04:54.875Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min4_1758373494838","total_duration_ms":37,"transaction_duration_ms":19,"response":{"status":"continue","creditsRemaining":6,"minuteBilled":4,"totalMinutesBilled":4,"attemptId":"1598f8e1-be6c-475c-a76d-9412a5ce9994","shouldTerminate":false}}
{"timestamp":"2025-09-20T13:05:54.878360","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min5_1758373554885","correlation_token":"sim_909c4aa76664333dbd33add873591bca_1758373233161","conversation_id":"2f51cb14-306b-498d-be37-efe1deef93e7","minute":5,"metrics_total_requests":23}
{"timestamp":"2025-09-20T13:05:54.885Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min5_1758373554885","correlation_token":"sim_909c4aa76664333dbd33add873591bca_1758373233161"}
{"timestamp":"2025-09-20T13:05:54.897Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min5_1758373554885","minute_requested":5,"minutes_already_billed":4,"attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994"}
{"timestamp":"2025-09-20T13:05:54.897Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min5_1758373554885","attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":6,"minutes_already_billed":4,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-20T13:05:54.897Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min5_1758373554885","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":6,"expected_balance_after":5,"minute_to_bill":5}
{"timestamp":"2025-09-20T13:05:54.902Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min5_1758373554885","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-20T13:05:54.905Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min5_1758373554885","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":6,"new_balance":5,"change":-1}
{"timestamp":"2025-09-20T13:05:54.905Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min5_1758373554885","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":5,"minute":5}
{"timestamp":"2025-09-20T13:05:54.908Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min5_1758373554885","transaction_id":"3e31e328-9ed4-4b3f-8dbf-5eb0e32d71b1","transaction_type":"DEBIT","balance_after":5}
{"timestamp":"2025-09-20T13:05:54.908Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min5_1758373554885","attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994","new_minutes_billed":5,"new_duration_seconds":300}
{"timestamp":"2025-09-20T13:05:54.910Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min5_1758373554885","attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994","minutes_billed":5}
{"timestamp":"2025-09-20T13:05:54.911Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min5_1758373554885","transaction_duration_ms":14,"new_balance":5,"minute_billed":5,"total_minutes_billed_this_attempt":5,"total_successful":12,"total_minutes_billed_all_time":12,"avg_transaction_time":"20.25"}
{"timestamp":"2025-09-20T13:05:54.911Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min5_1758373554885","total_duration_ms":26,"transaction_duration_ms":14,"response":{"status":"continue","creditsRemaining":5,"minuteBilled":5,"totalMinutesBilled":5,"attemptId":"1598f8e1-be6c-475c-a76d-9412a5ce9994","shouldTerminate":false}}
{"timestamp":"2025-09-20T13:06:54.914407","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min6_1758373614916","correlation_token":"sim_909c4aa76664333dbd33add873591bca_1758373233161","conversation_id":"2f51cb14-306b-498d-be37-efe1deef93e7","minute":6,"metrics_total_requests":24}
{"timestamp":"2025-09-20T13:06:54.916Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min6_1758373614916","correlation_token":"sim_909c4aa76664333dbd33add873591bca_1758373233161"}
{"timestamp":"2025-09-20T13:06:54.925Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min6_1758373614916","minute_requested":6,"minutes_already_billed":5,"attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994"}
{"timestamp":"2025-09-20T13:06:54.925Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min6_1758373614916","attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":5,"minutes_already_billed":5,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-20T13:06:54.925Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min6_1758373614916","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":5,"expected_balance_after":4,"minute_to_bill":6}
{"timestamp":"2025-09-20T13:06:54.928Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min6_1758373614916","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-20T13:06:54.931Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min6_1758373614916","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":5,"new_balance":4,"change":-1}
{"timestamp":"2025-09-20T13:06:54.931Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min6_1758373614916","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":4,"minute":6}
{"timestamp":"2025-09-20T13:06:54.933Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min6_1758373614916","transaction_id":"78cf6d35-8706-4ca9-a599-0df9814c9aa1","transaction_type":"DEBIT","balance_after":4}
{"timestamp":"2025-09-20T13:06:54.933Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min6_1758373614916","attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994","new_minutes_billed":6,"new_duration_seconds":360}
{"timestamp":"2025-09-20T13:06:54.935Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min6_1758373614916","attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994","minutes_billed":6}
{"timestamp":"2025-09-20T13:06:54.937Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min6_1758373614916","transaction_duration_ms":12,"new_balance":4,"minute_billed":6,"total_minutes_billed_this_attempt":6,"total_successful":13,"total_minutes_billed_all_time":13,"avg_transaction_time":"19.62"}
{"timestamp":"2025-09-20T13:06:54.937Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min6_1758373614916","total_duration_ms":21,"transaction_duration_ms":12,"response":{"status":"continue","creditsRemaining":4,"minuteBilled":6,"totalMinutesBilled":6,"attemptId":"1598f8e1-be6c-475c-a76d-9412a5ce9994","shouldTerminate":false}}
{"timestamp":"2025-09-20T13:07:54.942594","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min7_1758373674947","correlation_token":"sim_909c4aa76664333dbd33add873591bca_1758373233161","conversation_id":"2f51cb14-306b-498d-be37-efe1deef93e7","minute":7,"metrics_total_requests":25}
{"timestamp":"2025-09-20T13:07:54.947Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min7_1758373674947","correlation_token":"sim_909c4aa76664333dbd33add873591bca_1758373233161"}
{"timestamp":"2025-09-20T13:07:54.963Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min7_1758373674947","minute_requested":7,"minutes_already_billed":6,"attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994"}
{"timestamp":"2025-09-20T13:07:54.963Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min7_1758373674947","attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":4,"minutes_already_billed":6,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-20T13:07:54.963Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min7_1758373674947","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":4,"expected_balance_after":3,"minute_to_bill":7}
{"timestamp":"2025-09-20T13:07:54.968Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min7_1758373674947","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-20T13:07:54.971Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min7_1758373674947","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":4,"new_balance":3,"change":-1}
{"timestamp":"2025-09-20T13:07:54.971Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min7_1758373674947","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":3,"minute":7}
{"timestamp":"2025-09-20T13:07:54.974Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min7_1758373674947","transaction_id":"6354f141-10d4-4ff3-b9fe-d8a18c31825d","transaction_type":"DEBIT","balance_after":3}
{"timestamp":"2025-09-20T13:07:54.974Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min7_1758373674947","attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994","new_minutes_billed":7,"new_duration_seconds":420}
{"timestamp":"2025-09-20T13:07:54.977Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min7_1758373674947","attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994","minutes_billed":7}
{"timestamp":"2025-09-20T13:07:54.978Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min7_1758373674947","transaction_duration_ms":15,"new_balance":3,"minute_billed":7,"total_minutes_billed_this_attempt":7,"total_successful":14,"total_minutes_billed_all_time":14,"avg_transaction_time":"19.29"}
{"timestamp":"2025-09-20T13:07:54.978Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min7_1758373674947","total_duration_ms":31,"transaction_duration_ms":15,"response":{"status":"continue","creditsRemaining":3,"minuteBilled":7,"totalMinutesBilled":7,"attemptId":"1598f8e1-be6c-475c-a76d-9412a5ce9994","shouldTerminate":false}}
{"timestamp":"2025-09-20T13:08:54.984259","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min8_1758373734996","correlation_token":"sim_909c4aa76664333dbd33add873591bca_1758373233161","conversation_id":"2f51cb14-306b-498d-be37-efe1deef93e7","minute":8,"metrics_total_requests":26}
{"timestamp":"2025-09-20T13:08:54.996Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min8_1758373734996","correlation_token":"sim_909c4aa76664333dbd33add873591bca_1758373233161"}
{"timestamp":"2025-09-20T13:08:55.024Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min8_1758373734996","minute_requested":8,"minutes_already_billed":7,"attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994"}
{"timestamp":"2025-09-20T13:08:55.024Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min8_1758373734996","attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":3,"minutes_already_billed":7,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-20T13:08:55.024Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min8_1758373734996","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":3,"expected_balance_after":2,"minute_to_bill":8}
{"timestamp":"2025-09-20T13:08:55.034Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min8_1758373734996","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-20T13:08:55.037Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min8_1758373734996","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":3,"new_balance":2,"change":-1}
{"timestamp":"2025-09-20T13:08:55.037Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min8_1758373734996","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":2,"minute":8}
{"timestamp":"2025-09-20T13:08:55.039Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min8_1758373734996","transaction_id":"56b4b4c2-dc07-46ec-85d5-f643f63d4750","transaction_type":"DEBIT","balance_after":2}
{"timestamp":"2025-09-20T13:08:55.039Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min8_1758373734996","attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994","new_minutes_billed":8,"new_duration_seconds":480}
{"timestamp":"2025-09-20T13:08:55.042Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min8_1758373734996","attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994","minutes_billed":8}
{"timestamp":"2025-09-20T13:08:55.043Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min8_1758373734996","transaction_duration_ms":19,"new_balance":2,"minute_billed":8,"total_minutes_billed_this_attempt":8,"total_successful":15,"total_minutes_billed_all_time":15,"avg_transaction_time":"19.27"}
{"timestamp":"2025-09-20T13:08:55.043Z","level":"WARN","service":"BillingService","message":"Low credits warning threshold reached","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min8_1758373734996","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","credits_remaining":2,"minute_billed":8,"warning_threshold":2}
{"timestamp":"2025-09-20T13:08:55.043Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min8_1758373734996","total_duration_ms":47,"transaction_duration_ms":19,"response":{"status":"warning","creditsRemaining":2,"minuteBilled":8,"totalMinutesBilled":8,"attemptId":"1598f8e1-be6c-475c-a76d-9412a5ce9994","shouldTerminate":false,"message":"Low credits warning: 2 minute(s) remaining"}}
{"timestamp":"2025-09-20T13:09:55.048660","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min9_1758373795057","correlation_token":"sim_909c4aa76664333dbd33add873591bca_1758373233161","conversation_id":"2f51cb14-306b-498d-be37-efe1deef93e7","minute":9,"metrics_total_requests":27}
{"timestamp":"2025-09-20T13:09:55.057Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min9_1758373795057","correlation_token":"sim_909c4aa76664333dbd33add873591bca_1758373233161"}
{"timestamp":"2025-09-20T13:09:55.070Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min9_1758373795057","minute_requested":9,"minutes_already_billed":8,"attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994"}
{"timestamp":"2025-09-20T13:09:55.070Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min9_1758373795057","attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":2,"minutes_already_billed":8,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-20T13:09:55.070Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min9_1758373795057","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":2,"expected_balance_after":1,"minute_to_bill":9}
{"timestamp":"2025-09-20T13:09:55.074Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min9_1758373795057","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-20T13:09:55.078Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min9_1758373795057","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":2,"new_balance":1,"change":-1}
{"timestamp":"2025-09-20T13:09:55.078Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min9_1758373795057","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":1,"minute":9}
{"timestamp":"2025-09-20T13:09:55.080Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min9_1758373795057","transaction_id":"ef22549a-5dde-4d1c-976d-68deccb311d6","transaction_type":"DEBIT","balance_after":1}
{"timestamp":"2025-09-20T13:09:55.080Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min9_1758373795057","attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994","new_minutes_billed":9,"new_duration_seconds":540}
{"timestamp":"2025-09-20T13:09:55.082Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min9_1758373795057","attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994","minutes_billed":9}
{"timestamp":"2025-09-20T13:09:55.083Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min9_1758373795057","transaction_duration_ms":13,"new_balance":1,"minute_billed":9,"total_minutes_billed_this_attempt":9,"total_successful":16,"total_minutes_billed_all_time":16,"avg_transaction_time":"18.88"}
{"timestamp":"2025-09-20T13:09:55.083Z","level":"WARN","service":"BillingService","message":"Low credits warning threshold reached","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min9_1758373795057","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","credits_remaining":1,"minute_billed":9,"warning_threshold":2}
{"timestamp":"2025-09-20T13:09:55.083Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min9_1758373795057","total_duration_ms":26,"transaction_duration_ms":13,"response":{"status":"warning","creditsRemaining":1,"minuteBilled":9,"totalMinutesBilled":9,"attemptId":"1598f8e1-be6c-475c-a76d-9412a5ce9994","shouldTerminate":false,"message":"Low credits warning: 1 minute(s) remaining"}}
{"timestamp":"2025-09-20T13:10:18.478443","level":"INFO","service":"BillingService","message":"Processing billing request","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min10_1758373818479","correlation_token":"sim_909c4aa76664333dbd33add873591bca_1758373233161","conversation_id":"2f51cb14-306b-498d-be37-efe1deef93e7","minute":10,"metrics_total_requests":28}
{"timestamp":"2025-09-20T13:10:18.479Z","level":"DEBUG","service":"BillingService","message":"Fetching simulation attempt by correlation token","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min10_1758373818479","correlation_token":"sim_909c4aa76664333dbd33add873591bca_1758373233161"}
{"timestamp":"2025-09-20T13:10:18.491Z","level":"DEBUG","service":"BillingService","message":"Checking if minute already billed","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min10_1758373818479","minute_requested":10,"minutes_already_billed":9,"attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994"}
{"timestamp":"2025-09-20T13:10:18.492Z","level":"INFO","service":"BillingService","message":"Attempt found successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min10_1758373818479","attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","student_name":"John Doe","student_email":"john.doe@example.com","current_balance":1,"minutes_already_billed":9,"simulation_id":"3369e7a6-87d5-4f7a-8f35-0ebdf6a6d963","case_title":"Chest Pain Assessment"}
{"timestamp":"2025-09-20T13:10:18.492Z","level":"INFO","service":"BillingService","message":"Starting credit deduction transaction","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min10_1758373818479","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount_to_deduct":1,"current_balance":1,"expected_balance_after":0,"minute_to_bill":10}
{"timestamp":"2025-09-20T13:10:18.496Z","level":"DEBUG","service":"BillingService","message":"Decrementing student credit balance","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min10_1758373818479","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","operation":"DECREMENT","amount":1}
{"timestamp":"2025-09-20T13:10:18.498Z","level":"DEBUG","service":"BillingService","message":"Student balance updated successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min10_1758373818479","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","old_balance":1,"new_balance":0,"change":-1}
{"timestamp":"2025-09-20T13:10:18.498Z","level":"DEBUG","service":"BillingService","message":"Creating credit transaction record","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min10_1758373818479","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","amount":1,"balance_after":0,"minute":10}
{"timestamp":"2025-09-20T13:10:18.500Z","level":"DEBUG","service":"BillingService","message":"Credit transaction record created","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min10_1758373818479","transaction_id":"54768e84-39a3-4998-8d24-106b64c80205","transaction_type":"DEBIT","balance_after":0}
{"timestamp":"2025-09-20T13:10:18.500Z","level":"DEBUG","service":"BillingService","message":"Updating simulation attempt with minutes billed","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min10_1758373818479","attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994","new_minutes_billed":10,"new_duration_seconds":600}
{"timestamp":"2025-09-20T13:10:18.502Z","level":"DEBUG","service":"BillingService","message":"Attempt updated with minutes billed","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min10_1758373818479","attempt_id":"1598f8e1-be6c-475c-a76d-9412a5ce9994","minutes_billed":10}
{"timestamp":"2025-09-20T13:10:18.503Z","level":"INFO","service":"BillingService","message":"Transaction completed successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min10_1758373818479","transaction_duration_ms":11,"new_balance":0,"minute_billed":10,"total_minutes_billed_this_attempt":10,"total_successful":17,"total_minutes_billed_all_time":17,"avg_transaction_time":"18.41"}
{"timestamp":"2025-09-20T13:10:18.503Z","level":"WARN","service":"BillingService","message":"Last credit used - will terminate conversation","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min10_1758373818479","student_id":"4b3508a7-9d41-4158-81f3-b34817e07570","minute_billed":10,"total_minutes_this_session":10}
{"timestamp":"2025-09-20T13:10:18.503Z","level":"INFO","service":"BillingService","message":"Billing request completed successfully","requestId":"bill_2f51cb14-306b-498d-be37-efe1deef93e7_min10_1758373818479","total_duration_ms":24,"transaction_duration_ms":11,"response":{"status":"terminate","creditsRemaining":0,"minuteBilled":10,"totalMinutesBilled":10,"attemptId":"1598f8e1-be6c-475c-a76d-9412a5ce9994","shouldTerminate":true,"message":"Last credit used - conversation will end","gracePeriodSeconds":60}}
